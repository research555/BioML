Identification of shared and disease-specific host gene–microbiome associations across human diseases using multi-omic integration

While gut microbiome and host gene regulation independently contribute to gastrointestinal disorders, it is unclear how the two may interact to influence host pathophysiology. Here we developed a machine learning-based framework to jointly analyse paired host transcriptomic (n = 208) and gut microbiome (n = 208) profiles from colonic mucosal samples of patients with colorectal cancer, inflammatory bowel disease and irritable bowel syndrome. We identified associations between gut microbes and host genes that depict shared as well as disease-specific patterns. We found that a common set of host genes and pathways implicated in gastrointestinal inflammation, gut barrier protection and energy metabolism are associated with disease-specific gut microbes. Additionally, we also found that mucosal gut microbes that have been implicated in all three diseases, such as Streptococcus, are associated with different host pathways in each disease, suggesting that similar microbes can affect host pathophysiology in a disease-specific manner through regulation of different host genes. Our framework can be applied to other diseases for the identification of host gene–microbiome associations that may influence disease outcomes.

The human gut microbiome plays a critical role in modulating human health and disease. Variations in the composition of the human gut microbiome have been associated with a wide variety of chronic diseases, including colorectal cancer (CRC), inflammatory bowel disease (IBD) and irritable bowel syndrome (IBS). For example, previous studies have reported an increase in the abundance of Fusobacterium nucleatum and Parvimonas in CRC1,2, reduced abundance of Faecalibacterium prausnitzii and enrichment of enterotoxigenic Bacteroides fragilis in CRC and IBD3–5, and overrepresentation of Enterobacteriaceae and Streptococcus in IBD and IBS6–8. In addition to the gut microbiome, dysregulation of host gene expression and pathways have also been implicated in these diseases. Researchers have reported disruption of Notch and WNT signalling pathways in CRC9,10, activation of toll-like receptors (for example, TLR4) that induce NF-κB and TNF-α signalling pathways in IBD11,12, and dysregulation of immune response and intestinal antibacterial gene expression in IBS8,13. While host transcription and gut microbiome have separately been identified as contributing factors to these gastrointestinal (GI) diseases, it is unclear how the two may associate to influence host pathophysiology14.

Here we comprehensively characterized associations between mucosal gene expression and microbiome composition in patients with colorectal cancer, inflammatory bowel disease and irritable bowel syndrome—three GI disorders in which both host gene regulation and gut microbiome have been implicated as contributing factors1,6,8,10,13. We developed and applied a machine learning framework that overcomes typical challenges in multi-omic integrations, including high-dimensionality, sparsity and multicollinearity, to identify biologically meaningful associations between gut microbes and host genes and pathways in each disease. We leveraged our framework to characterize disease-specific and shared host gene–microbiome associations across the three diseases that may facilitate insights into the molecular mechanisms underlying pathophysiology of these gastrointestinal diseases.

To study host–microbiome relationship across diseases, we used host gene expression (RNA-seq) data and gut microbiome abundance (16S rRNA sequencing) data generated from colonic mucosal biopsies obtained from patients with CRC, IBD and IBS (Fig.
1a). For each individual in our study, we obtained a pair of samples—a microbiome sample and a host gene expression sample. In total, across the three disease cohorts, our study included 208 such pairs of microbiome and host gene expression samples (416 samples in total; Supplementary Table 1). All datasets, except the host gene expression (RNA-seq) data for CRC, have been previously published as individual studies3,8,22,25. Detailed information on disease cohorts, samples, sequencing, quality control and data processing is available in Methods.

To this end, we developed a machine learning-based multi-omic integration framework using sparse canonical correlation analysis (sparse CCA)26,27 and lasso penalized regression28. We applied this approach to data from CRC, IBD and IBS for a comprehensive characterization of potentially biologically meaningful associations between gut microbiota and host genes and pathways across the three diseases (Fig.
1, Methods and Extended Data Fig.
1).

We hypothesized that host genes and gut microbial taxa involved in common biological functions would act in a coordinated fashion, and hence would have correlated expression and abundance patterns. To investigate this, we used sparse CCA to characterize group-level association between host transcriptome and gut microbiome in each of the three diseases26,27. We fit the sparse CCA model for each dataset to identify subsets of significantly correlated host genes and gut microbes, known as components (Methods and Supplementary Tables 2–4). We then performed pathway enrichment analysis on the set of host genes in each significant component to determine host pathways that associate with gut microbes in a disease. We identified ‘shared’ pathways, namely host pathways for which gene expression correlates with gut microbes across disease cohorts, and ‘disease-specific’ pathways, namely host pathways for which gene expression correlates with gut microbes in only one of the three disease cohorts (Fig.
2a, Fisher’s exact test, Benjamini-Hochberg FDR < 0.1; Supplementary Table 5). For simplicity, we focused on the top five most significant shared and disease-specific pathways (Fig.
2a). We found three pathways shared across CRC, IBD and IBS that are known to regulate gastrointestinal tract inflammation, and gut barrier protection and repair. For example, oxidative phosphorylation, which is the process of energy metabolism in the mitochondria, is known to be dysregulated in IBD and CRC, and contributes to tumorigenesis and drug resistance in CRC29–32. We also found overlapping host pathways between disease pairs (see CRC & IBD, CRC & IBS, and IBD & IBS in Fig.
2a), including immunoregulatory pathways and cell-surface receptors such as integrin pathway, cell and focal adhesion, and proteasome.

To investigate disease-specific associations, we considered unique host pathways for which host gene expression correlates with gut microbes only in one of the three diseases (Fig.
2c). For example, the Syndecan-1 pathway, which we found to be associated with gut microbial taxa only in CRC, has been previously shown to regulate the tumorigenic activity of cancer cells44,45. Host gene expression in this pathway is associated with microbial taxa such as Parvimonas and Bacteroides fragilis that are known to promote intestinal carcinogenesis and are considered biomarkers of CRC1,46,47. The integrin-1 pathway, a disease-specific host pathway in IBD, is found to be associated with Peptostreptococcaceae, Intestinibacter and Phascolarctobacterium—microbial taxa that have been implicated in IBD by previous studies48–50. To assess similarities in host gene components across diseases, we identified a set of host genes that are common between components across the three diseases, and we found that these genes are enriched for immune response pathways in gut epithelium, including vascular endothelial growth factor (VEGF), complementation and coagulation cascades, and cytokine–cytokine receptor association (Fig.
2d, Fisher’s exact test, Benjamini-Hochberg FDR < 0.1). While this set of host genes is associated with disease-specific groups of microbes, we also found overlapping microbes between IBD and IBS, such as Peptostreptococcaceae and Intestinibacter—taxa that are found in high abundance in gastrointestinal inflammation48,50.

Previous studies have shown that specific microbial taxa can regulate expression of individual host genes15,19. Therefore, we explored associations between individual host genes and gut microbes in each disease. To do so, we used lasso penalized regression models to identify specific gut microbial taxa whose abundance is associated with the expression of a host gene28. We fit these models in a gene-wise manner, using the expression for each host gene as the response variable and the abundances of gut microbial taxa as predictors. We then applied stability selection to identify robust associations (Methods). Using this approach, we found 755, 1,295 and 441 significant and stability-selected host gene–taxa associations in CRC, IBD and IBS, respectively (Fig.
3, FDR < 0.1). These represent associations between 745 host genes and 120 gut microbes in CRC (Supplementary Table 6), between 1,246 host genes and 56 gut microbes in IBD (Supplementary Table 7), and between 436 host genes and 102 gut microbes in IBS (Supplementary Table 8 and Fig.
3a). Examples of specific host gene–microbe associations can be found in Extended Data Fig.
2. Overall, we observed disease-specific patterns in host gene–taxa associations.

We observed that Peptostreptococcaceae, which is prevalent in patients with IBD50, is associated with multiple host genes and pathways in IBD (Fig.
3d). For example, its abundance is positively correlated with the expression of host genes MAPK3 and VIPR1, involved in thrombin signalling through proteinase activated receptors (PARs) and glucagon-type ligand receptors pathways, respectively. MAPK3 is known to play a role in the progression and development of IBD, and VIPR1 is overexpressed in inflamed mucosa66,67. In IBS-specific associations, we found the levels of Prevotella, which is known to be overrepresented in individuals with loose stool, to be negatively associated with expression of SMC5, which is involved in the sumoylation pathway68,69 (Fig.
3e). We also found the expression of PLA2G4A, a host gene that plays an important role in arachidonic acid metabolism and modulates gut epithelial homoeostasis70, to be positively correlated with the abundance of Bacteroides massiliensis in IBS, B. massiliensis being known to be prevalent in patients with gut malignancies41 (Fig.
3e). Taken together, these findings demonstrate that associations between specific gut microbial taxa and specific host genes and pathways vary by disease state.

To understand how gut microbes may associate with specific host genes across diseases, we explored the overlaps between host gene–microbe associations in CRC, IBD and IBS (Fig.
4a, lasso regression, Benjamini-Hochberg FDR < 0.1; Supplementary Table 10). We identified ‘shared’ gut microbes, namely gut microbes that associate with host genes in at least two diseases, and visualized their networks of association with host genes across diseases. We found three gut microbes, Peptostreptococcaceae, Streptococcus and Staphylococcus, whose abundance is correlated with host gene expression in all three diseases in our study cohorts (Fig.
4a, Network 1). Previous studies have revealed that Peptostreptococcaceae and Streptococcus spp. are found at elevated levels in CRC, IBD and IBS8,37,50,71–74. While traditionally considered nasal- or skin-associated bacteria, Staphylococcus spp. also colonize the human gastrointestinal tract and include opportunistic pathogens that can cause acute intestinal infections in patients with CRC and IBD, and are associated with increased risk of IBS and CRC74–77. We found that the abundance of Peptostreptococcaceae is positively correlated with the expression of host genes PYGB and NCK2 in IBD, whereas it is negatively correlated with the expression of host gene HAS2 in IBS. PYGB and NCK2 are both upregulated in IBD, where PYGB is known to regulate the WNT/β-catenin pathway, and NCK2 is involved in integrin and epidermal growth factor receptor signalling78–80. In contrast, HAS2 is known to have a protective effect on the colonic epithelium through regulation of intestinal homoeostasis and inflammation81,82. In CRC, we found that the abundance of Peptostreptococcaceae is negatively associated with the expression of GAB1, a host gene for which overexpression stimulates tumour growth in colon cancer cells83. Streptococcus also shows a disease-specific pattern of association with host gene expression in our study cohort. In CRC, its abundance is correlated with the expression of RIPK4, which regulates WNT signalling and the NF-κB pathway, and is upregulated in several cancer types, including colon cancer84,85. Similarly, in IBS, Streptococcus abundance is correlated with the expression of DPEP2, which is known to modulate macrophage inflammatory response86 (Fig.
4a, Network 1).

In addition, we identified 135 host genes for which expression is associated with abundance of microbial taxa in at least two of the three diseases, and visualized the network of the most significant associations (Fig.
4b, Networks 2–4, lasso regression, FDR < 0.1; Supplementary Table 11). We found that the host genes whose expression is correlated with gut microbes in both CRC and IBD are enriched for pathways involved in immune response, including natural killer cell mediated toxicity, Leishmania infection and leucocyte transendothelial migration (Fig.
4b, Network 4, Fisher’s exact test, Benjamini-Hochberg FDR < 0.1). These host genes and the microbial taxa they associate with have been previously implicated in CRC and IBD. For example, expression of Annexin A1 or ANXA1—a host gene known to regulate intestinal mucosal injury and repair, and found to be dysregulated in CRC and IBD93,94—is positively correlated with Bacteroidales in CRC, while negatively correlated with Peptostreptococcaceae in IBD (Fig.
4b, Network 4). TLR4—a host gene known to modulate inflammatory response in intestinal epithelium through recognition of bacterial lipopolysaccharide95, and previously implicated in IBD and CRC96,97—is found to be associated with an oral microbe GN02 in CRC98, whereas in IBD it associates with Acidaminococcaceae—a gut microbe found to be increased in abundance in patients with Crohn’s disease99 (Fig.
4b, Network 4). Overall, our analysis shows that gut microbial taxa and host genes that are shared between associations across diseases depict disease-specific host–microbe crosstalk, thus suggesting that the mechanism of host gene–microbiome association might be specific to the disease.

While gut microbial communities and host gene expression have separately been implicated with human health and disease, the role of the association between gut microbes and host gene regulation in the pathogenesis of human gastrointestinal diseases remains largely unknown. Using a machine learning-based multi-omic integration framework, here we found both common and disease-specific interplay between gut microbes and host gene regulation that may contribute to the underlying pathophysiology of GI disorders, including CRC, IBD and IBS.

Overall, our work demonstrates the power of integrating gut microbiome and host gene expression data to provide insights into their combined role in GI diseases, including CRC, IBD and IBS. Taken together, our results indicate that GI disorders are characterized by a complex network of associations between microbes and host genes. Although these associations can be disease-specific, we find cases where the same microbial taxon is associated with different host genes in each disease, and vice-versa: cases where the same host pathway is associated with different microbes in each disease. Although much effort in microbiome research has been directed towards identifying specific microbial taxa that are responsible for the pathogenesis of disease, our findings indicate that it is critical to incorporate host genomics data, as it can provide invaluable information on the potential mechanisms through which microbes can affect health. Our results represent an important step towards characterizing the association between gut microbiome and host gene regulation, and understanding the contribution of the microbiome to disease aetiology.

Overall, our study included 208 paired microbiome (16S rRNA) and host gene expression (RNA-seq) samples, which include 88 pairs of samples in the CRC cohort (44 tumour and 44 patient-matched normal)3, 78 pairs of samples in the IBD cohort (56 patients and 22 controls)22,25 and 42 pairs of samples in the IBS cohort (29 patients and 13 controls)8 (Supplementary Tables 1 and 12–17). All datasets, except the host gene expression data for CRC, have been previously published as individual studies3,8,22,25. The original studies obtained written informed consent from study participants in each cohort. Details on randomization and blinding during data collection can be found in publications describing the original studies. No statistical methods were used to pre-determine sample sizes, but our sample sizes are similar to those reported in the previous publications3,8,22,25. Below, we describe in detail the sample collection, sequencing and quality control for the CRC cohort host RNA-seq data, and summarize sample collection and data processing and acquisition for other datasets.

We used 88 pairs of gut microbiome and host gene expression samples from 44 patients, with primary tumour and normal tissue samples taken from each individual. The individuals in this cohort included 23 females and 21 males, with an average age of 65 years (median: 67, range: 17–91). Patient samples were characterized and described by Burns et al.3. Briefly, these de-identified samples were obtained from the University of Minnesota Biological Materials Procurement Network (Bionet). Tissue pairs were resected concurrently, rinsed with sterile water, flash frozen in liquid nitrogen and characterized by staff pathologists. Detailed cohort characteristics for this dataset are included in Supplementary Table 1.

Total RNA was extracted using a previously established protocol3,105. Approximately 100 mg of flash-frozen tissue per sample were lysed by placing the tissue in 1 ml of Qiazol lysis reagent (Qiagen) and sonicating in a 65 °C water bath for 1–2 h. Nucleic acids were purified from the lysates using the Qiagen AllPrep DNA/RNA mini kit (Qiagen), quantified using a Nanodrop 2000 spectrophotometer (Thermo Fisher) and submitted for RNA sequencing to the University of Minnesota Genomics Center. Total eukaryotic RNA isolates were quantified using a fluorimetric RiboGreen assay, and once the samples passed the initial QC step (≥1 μg and RNA integrity number ≥ 8), they were converted to Illumina sequencing libraries using Illumina’s TruSeq stranded total RNA library prep (for details, see www.illumina.com). Truseq libraries were hybridized to a paired-end flow cell and individual fragments were clonally amplified by bridge amplification on the Illumina cBot. Once clustering was complete, the flow cell was loaded onto the HiSeq 2500 and sequenced using Illumina’s SBS chemistry. Base call (.bcl) files for each cycle of sequencing were generated by Illumina Real Time Analysis (RTA) software. Primary analysis and index de-multiplexing were performed using Illumina’s bcl2fastq v2.20.0.422, which outputs the demultiplexed FASTQ files.

A quality check of raw sequence FASTQ files was performed using FastQC software (version 0.11.5)106. Quality trimming was performed to remove sequence adaptors and low-quality bases using Trimmomatic with 3 bp sliding window trimming from the 3’ end requiring minimum Q16 (phred33)107. FastQC was run on the resulting trimmed files to ensure good quality of sequences. The paired-end reads were mapped to NCBI v38 H. sapiens reference genome using HISAT2108, resulting in an average alignment rate of 87.11% overall for 88 samples. We obtained a range of read counts between 14,365,657 and 31,530,487 aligned reads per sample, with an average of 22,475,688.2 and 22,697,605.5 aligned reads per sample. SAMtools was used for sorting and indexing the aligned bam files. After alignment, the ‘Subread’ package (version 1.4.6) within the ‘featureCounts’ programme was used to generate the transcript abundance file109 (Extended Data Fig.
4).

The microbiome dataset used in this study was generated and published previously3. Briefly, total DNA was isolated from the flash-frozen tissue samples and their associated microbiomes by adapting an established nucleic acid extraction protocol105. DNA isolated from colon samples was quantified by quantitative PCR (qPCR), and the V5–V6 regions of the 16S rRNA gene were PCR amplified and sequenced using the Illumina MiSeq (v3 Kit) with 2 × 250 bp paired-end protocol. The forward and reverse reads were merged and trimmed using USEARCH v7110. The merged and filtered reads were used to pick operational taxonomic units (OTUs) with QIIME v.1.7.0111. We used the unnormalized and unfiltered OTU table in tab-delimited format, representing mucosal microbiome data from 44 tumour and 44 patient-matched colon tissue samples. We describe the steps for preprocessing microbiome data for integration analysis below.

We used previously generated and published host gene expression (RNA-seq) and mucosal gut microbiome (16S rRNA) data for the IBD cohort generated as part of the HMP2 project22,25. These include data from colonic biopsy samples collected from 78 individuals, including 56 individuals with IBD and 22 individuals without IBD (‘non-IBD’ in HMP2). Out of 56 IBD patients, 34 patients had Crohn’s disease (CD) and 22 patients had ulcerative colitis (UC). The individuals in this cohort included 38 females and 40 males. Age at the time of sample collection is not reported in the metadata file available for this cohort (http://ibdmdb.org). The detailed protocol for sample collection and processing is described at http://ibdmdb.org/protocols. Briefly, biopsies were collected during the initial screening colonoscopy and stored in RNAlater for molecular data generation (host and microbial, stored at –20 °C). DNA and RNA were extracted from RNAlater-preserved biopsies using the AllPrep DNA/RNA universal kit from Qiagen. For microbiome profiling, bacterial genomic DNA was extracted from the total mass of the biopsied specimens using the MoBIO PowerLyzer tissue and cells DNA isolation kit. The 16S rDNA V4 region was PCR amplified and sequenced in the Illumina MiSeq platform using the 2 × 250 bp paired-end protocol. Read pairs were demultiplexed and merged using USEARCH v7.0.1090 and clustered into OTUs using the UPARSE algorithm110,112. For host gene expression data, mRNA was extracted from biopsy samples, followed by RNA-seq library preparation using a variant of Illumina TruSeq stranded mRNA sample preparation kit. Sequencing was performed according to the manufacturer’s protocols using either the HiSeq 2000 or HiSeq 2500 with 101 bp paired-end reads. Data were analysed using the Broad Picard Pipeline.

Detailed cohort characteristics for this dataset are included in Supplementary Table 1. We downloaded metadata, host RNA-seq data and microbiome data for these samples from http://ibdmdb.org in July 2018. We downloaded the unnormalized and unfiltered OTU table and host transcript read counts files in tab-delimited format. We describe the filtering and preprocessing steps for host gene expression and microbiome data below.

We used previously generated and published host gene expression (RNA-seq) and mucosal gut microbiome (16S rRNA) data for the IBS cohort8. These include data from colonic biopsy samples collected from 42 individuals, including 29 individuals with IBS and 13 healthy individuals (non-IBS). The individuals in this cohort included 31 females and 11 males, with an average age of 38 years (median: 35, range: 20–63). These samples were collected at Mayo Clinic Rochester and are described in detail by Mars et al.8. Briefly, for the microbiome data, DNA was extracted from biopsy sections using the QIAGEN PowerSoil kit (QIAGEN). The V4 region of the 16S rRNA gene was amplified, followed by paired-end 2 × 250 bp sequencing on an Illumina MiSeq. Trimming of adaptors, quality control and merging of reads were performed using Shi7113. Amplicon sequences were aligned to the 16S rRNA genes using BURST114. For host gene expression data, mRNA was extracted from biopsy samples, followed by RNA-Seq library preparation using the Illumina TruSeq RNA Library Prep Kit v2. Sequencing was performed on an Illumina HiSeq 2000 with 101 bp paired-end reads. Gene expression counts were obtained using the MAP-RSeq v.2.0.0 that consists of alignment with TopHat 2.0.12 against the human hg19 genome build, and gene counts with the Subread package 1.4.4115–117.

Detailed cohort characteristics for this dataset are included in Supplementary Table 1. We obtained the unnormalized and unfiltered OTU table and host transcript read count files in tab-delimited format via personal communication with authors of the paper8. For some individuals, samples were collected at two timepoints. For these cases, we averaged the gene expression levels and microbiome abundance measurements across the two timepoints. This is supported by a recent study showing that ‘omics’ methods are more accurate when using averages over multiple sampling timepoints118. We describe the filtering and preprocessing steps for host gene expression and microbiome data below.

For host gene expression data for each disease cohort, we used the ‘biomaRt’ R package (version 2.37.4) to only keep data for protein-coding genes119. We filtered out lowly expressed genes to retain genes that are expressed in at least half of the samples in each disease cohort. We performed variance stabilizing transformation using the R package ‘DESeq2’ (version 1.14.1) on the filtered gene expression read count data120. We filtered out genes with low variance, using 25% quantile of variance across samples in each disease cohort as cut-off. Performing these steps for RNA-seq data for each disease cohort separately resulted in a unique host gene expression matrix per disease for downstream analysis, including 12,513 genes in the CRC dataset, 11,985 genes in IBD dataset and 12,429 genes in IBS dataset.

We performed the following steps for microbiome data from each disease cohort separately. First, sequences that were classified as either having originated from Archaea, chloroplasts, known contaminants originating from laboratory reagents or kits, and soil- or water-associated environmental contaminants were removed from the OTU table as described earlier121. Next, we summarized the OTU table at the species (if present), genus, family, order, class and phylum taxonomic levels, and performed prevalence and abundance-based filtering to retain taxa found at 0.001 relative abundance in at least 10% of the samples.

As a result, we obtained a taxonomic abundance matrix for each disease cohort, which included 235 taxa in the CRC dataset, 121 taxa in the IBD dataset and 238 taxa in the IBS dataset. We observed that the number of unique taxonomic groups found in the IBD dataset was 40% of those found in the CRC and IBS datasets, thus implying that the IBD dataset has lower bacterial diversity than the other two disease datasets. This observation is consistent with previous studies that have shown reduced bacterial diversity in gut mucosal microbiome in patients with IBD compared with individuals without this disease123–125, including the HMP2 study that generated and described the IBD dataset used in our study22,25. In addition, previous studies that generated and characterized the CRC and IBS datasets used in our work have reported increased microbial diversity in these conditions3,8.

Our study includes three different disease cohorts with disparate protocols for sample collection, handling, preparation and sequencing. Previous studies have shown that differences in data generation protocols, including sample collection, storage, DNA/mRNA extraction, PCR amplification and sequencing can lead to potential batch effects regardless of the data processing pipeline used126–128. Studies have shown that even when using the same data curation pipeline, biases in the data generation pipeline and batch effects still influence the assignment of taxonomic composition and gene expression profiles127,129. Statistical approaches to correct for batch effects have been proposed for gene expression and microbiome datasets; however, most of these approaches are relevant to testing differences between cases and controls, and do not apply to integrative analyses126,128.

Another potential issue is the difference in sample size across disease cohorts and between the case and control groups within each cohort. These sample size differences can result in differences in statistical power when applying sparse CCA and lasso regression. This can impact the number of host gene–microbe associations and pathways identified in each disease cohort, and the number of overlapping associations and pathways identified across cohorts. We attempted to minimize this effect by applying a differential enrichment analysis that is more robust to different levels of statistical power due to sample size. Additionally, our analysis focused only on the taxonomic composition of the microbiome, hence we could not characterize associations involving microbial genes and pathways. We note that it might be challenging to generalize some of the results found here, as microbiome profiles may vary across individuals and diseases. Hence, investigating the functional repertoire of microbial changes and its association with host genomic data would be a promising future direction.

To assess overall correspondence between host gene regulation and gut microbiome composition in CRC, IBD and IBS, we performed Procrustes analysis in R using the ‘vegan’ package (version 2.4-5)134. For each disease cohort, we used Aitchison’s distance on host gene expression data and Bray-Curtis distance on gut microbiome data as input to the Procrustes analysis135. The significance of rotation agreement was obtained using the ‘protest()’ function with 9,999 permutations. We also applied a Mantel test to verify overall correlation between dissimilarity matrices of host gene expression (Aitchison’s distance) and gut microbiome abundance (Bray-Curtis distance) in each disease cohort using the vegan package (version 2.4-5) in R. We also used the Mantel test to verify the overall correspondence between paired data for each disease cohort, and found a similar pattern of significance of agreement as Procrustes analysis for CRC (P value = 0.0026), IBD (P value = 0.2597) and IBS (P value = 0.9525). Significance was tested using 9,999 permutations.

We developed a machine learning framework for integrating multi-omic high-dimensional datasets, such as host gene expression and gut microbiome abundance. Our integration approach has two parts: (1) sparse CCA26,27 for identifying groups of host genes that associate with groups of gut microbial taxa to characterize pathway-level associations and (2) lasso penalized regression28 for identifying specific associations between individual host genes and gut microbial taxa (Fig.
1a and Extended Data Fig.
1). We describe both methods in detail below. We applied our integration analysis to paired host gene expression data and gut microbiome data for each disease cohort separately to avoid any potential batch effects. For each disease cohort dataset, we conducted the integration analysis separately for the patient data (that is, CRC, IBD and IBS) and corresponding control data (non-CRC, non-IBD and non-IBS, respectively), and considered only associations that were found in patients but not in controls. We standardized and normalized the data in all host gene expression and microbiome datasets before the application of statistical methods to satisfy the distribution requirements of the statistical models.

We used sparse CCA to identify group-level correlations between paired host gene expression and gut microbiome data in each disease cohort. CCA identifies linear projection of two sets of observations into shared latent space that maximizes correlation between the two datasets136. Sparse CCA is adapted from CCA for high-dimensional settings to incorporate feature selection by utilizing L1 or lasso penalty in CCA26. The objective function of sparse CCA can be expressed as follows:

For each disease cohort, we separately applied sparse CCA using the R (version 3.3.3) package ‘PMA’ (version 1.1), with gut microbiome taxonomic composition and host gene expression as two sets of variables to be correlated137. Below, we describe details on hyperparameter tuning, fitting sparse CCA models, enrichment analysis and visualization of sparse CCA output.

We performed hyperparameter tuning to identify the sparsity penalty parameters for gut microbiome abundance (λ1) and host gene expression (λ2) data. Since the permutation search provided in the PMA package only performs a one-dimensional search in the tuning parameter space, we implemented a grid-search approach using leave-one-out cross-validation in R (version 3.3.3) for hyperparameter tuning. We selected penalty parameters that had the highest correlation under cross-validation. Using this approach, we identified λ1 as 0.15 and λ2 as 0.2 for CRC data, λ1 as 0.177 and λ2 as 0.333 for IBD data, and λ1 as 0.4 and λ2 as 0.1 for IBS data.

After identifying sparsity parameters, we fit the sparse CCA model to obtain subsets of correlated host genes and gut microbes, known as components. Each sparse CCA component includes non-zero weights (or canonical loadings) on gut microbes, and non-zero weights on a subset of host genes correlated with those gut microbes to capture joint variation in the two sets of observations. We computed the first 10 sparse CCA components for each disease cohort, performing a separate computation for case and control samples. Sparse CCA components were computed iteratively, informed by previously computed components, thus resulting in uncorrelated components138.

We computed the significance of each pair of canonical variables (or a component) using the leave-one-out cross-validation approach in R (version 3.3.3). For a given component, we first used the penalty parameters determined above to compute the sparse CCA output, with one sample held out. We then computed the scores for the held-out sample, that is, we computed
score
X
i
=
X
i
u
−i
and
score
Y
i
=
Y
i
v
−i
, where i is the held-out sample, Xi and Yi denote the values for the ith sample of the input data matrices X and Y, and u−i and v−i are the canonical loadings estimated from the sparse CCA computation without the ith sample. We repeated this n times, where n is the total number of samples in the data, to obtain the vector of held-out scores. To assess the true strength of association and its significance, we used ‘cor.test()’ on the scores computed for the held-out samples. We corrected the P values for multiple hypothesis testing using the Benjamini-Hochberg (FDR) method within each disease cohort, and determined significant components at FDR < 0.1. Note that here we are testing for significance at the component level, that is, for a group of host genes correlated with a group of gut microbes, rather than the significance of the individual features selected, which depends on the level of sparsity penalization.

Using this approach, we identified 7 significant components in CRC, with an average of 828 host genes and 8 gut microbes; 4 significant components in IBD, with an average of 2,095 host genes and 6 gut microbes; and 6 significant components in IBS, with an average of 577 host genes and 61 gut microbes (FDR < 0.1, Supplementary Tables 2–4).

To characterize host pathways enriched for the set of host genes associated with microbes in each component, we implemented an enrichment analysis in R (version 3.3.3). We implemented Fisher’s exact test to assess pathway enrichment, where we used the set of host genes input to the sparse CCA analysis as background genes, and the set of host genes in a component as the genes of interest. We used the Kyoto Encyclopedia of Genes and Genomes (KEGG) and Pathway Interaction Database (PID) gene sets from the MsigDB canonical pathways collection139,140. To avoid pathways that are too large to provide any specific biological insights or too small to provide adequate statistical power, we excluded any pathway with either (1) fewer than 25 genes, (2) more than 300 genes or (3) fewer than 5 genes that overlapped between the genes of interest and the pathway. We combined the set of enriched host pathways for all significant components for a given disease dataset, corrected for multiple hypothesis testing within each disease cohort using the Benjamini-Hochberg (FDR) approach and determined significant host pathways at FDR < 0.1. For a given pathway, we assigned the component that gave the highest significance for this pathway. This analysis was performed separately for case and control data for each disease. To identify case-specific host pathways, we used a two-part approach: (1) we identified pathways that were only significantly enriched in cases (FDR < 0.1) but not in controls and (2) we identified pathways that were significant in both the cases and controls at FDR < 0.1, and performed differential enrichment analysis for pathways in cases versus controls as described below. We retained pathways that were significantly enriched at FDR < 0.1 and differentially enriched in cases versus controls at FDR < 0.2. Finally, we combined the pathways from parts (1) and (2) to obtain case-specific pathways at FDR < 0.1.

We performed differential enrichment of pathways in cases versus controls by implementing a comparative log odds-ratio approach in R141,142. To do so, we first computed the z-score for the odds ratio for the ith pathway in cases:

The greater the value of
z
i,case−ctrl
, the greater the odds that a pathway is differentially enriched in case versus control than by chance. P values were inferred assuming normal approximations, and corrected for multiple hypothesis testing using the Benjamini-Hochberg (FDR) approach.

To determine ‘shared’ host pathways (that is, host pathways for which gene expression correlates with gut microbes across all three disease cohorts) and ‘disease-specific’ host pathways (that is, host pathways for which gene expression correlates with gut microbes in only one of the three disease cohorts), we computed overlaps between significant case-specific host pathways determined above across the three disease cohorts. Given the overlap across the curated gene sets from MsigDB, we controlled for redundancy across pathways for visualization purposes. To do this, we identified similar pathways on the basis of their relative overlap in terms of the set of genes using an overlap coefficient. The overlap coefficient between two pathways is defined as the number of common genes between the pathways divided by the number of genes in the pathway with fewer genes. Specifically, the overlap coefficient is represented as follows:

For visualizing components corresponding to selected host pathways or common host genes across diseases (Fig. 2b–d), we ordered host genes and taxa by their absolute coefficients in the component, and selected the top 10 host genes and taxa for representation. If multiple taxa originating from the same lineage occurred in a component, we selected the one with the highest coefficient to reduce redundancy, thus representing the taxa with the largest contribution from a given lineage. The size of host genes and gut microbial taxa were scaled by the absolute value of their corresponding coefficients in a given component. All sparse CCA components were visualized using Cytoscape (version 3.5.1)143.

We used lasso penalized regression to identify specific associations between individual host genes and gut microbial taxa within each disease cohort28. We implemented a gene-wise model using expression for each host gene as response and abundances of microbiome taxa as predictors, to identify microbial taxa that are correlated with a host gene. An ordinary least squares (OLS) regression is not suitable for this task since OLS results in unstable solutions under high-dimensional settings or when
p>>n
, that is, the number of predictors p is much higher than the number of samples n. Additionally, we expected the abundance of only a few microbial taxa to correlate with the expression of each host gene. To address this, we used lasso regression, which is similar to multivariate OLS, except that it uses shrinkage or regularization to perform variable selection, thus picking only a few taxa that associate with a host gene’s expression.

We then performed inference for the lasso model using a regularized projection approach known as desparsified lasso. The desparsified lasso uses the asymptotic normality of a bias-corrected version of the lasso estimator to obtain 95% confidence intervals and P values for the coefficient of each predictor (microbe) associated with a given host gene145. We used the R package ‘hdi’ (version 0.1-7) that implements the desparsified lasso approach for estimation of confidence intervals and hypothesis testing in high-dimensional and sparse settings145,146. We then corrected for multiple hypothesis testing using the Benjamini-Hochberg (FDR) method.

Since the lasso model is sensitive to small variations of the predictor variable, we used stability selection to pick out robust microbes associated with a host gene122. Stability selection is a resampling-based method that can be combined with different variable selection procedures in high-dimensional settings, including lasso. Briefly, stability selection with lasso proceeded as follows:

Finally, we performed an intersection between associations identified by stability selection here and associations identified at FDR < 0.1 by the lasso model described above. We filtered out any significant and stability-selected host gene–gender and host gene–disease subtype (applicable to IBD and IBS) associations from the output to retain significant and stability-selected host gene–microbe associations at FDR < 0.1.

We leveraged supercomputing nodes to implement a parallel processing framework to allow scalable computation for the high-dimensional datasets. We implemented a parallel framework for executing the gene-wise lasso analysis, where we parallelized execution of lasso models on host genes across multiple nodes and cores on a compute cluster from Minnesota Supercomputing Institute. Our framework scalably computes gene-wise models for over 12,000 host genes, where each model includes hundreds of microbial taxa as covariates. We used job arrays to parallelize our analysis on multiple nodes on the cluster. Additionally, we used the R packages ‘doParallel’ (version 1.0.15) and ‘foreach’ (version 1.4.7) to run parallel processes on multiple cores of each compute node. Our parallel processing framework using 5 compute nodes took an average of 5 h 30 min per disease cohort.

To characterize biological functions for the host genes that were found to be associated with specific gut microbes in a disease cohort by the lasso framework, we implemented an enrichment analysis in R (version 3.3.3) using Fisher’s exact test. We used the set of expressed genes input to the lasso analysis as the background genes, and the set of host genes associated with gut microbes in patient samples as genes of interest. We used the KEGG, PID and REACTOME gene sets from the MsigDB canonical pathways collection139,140. To avoid pathways that were too large to provide any specific biological insights or too small to provide adequate statistical power, we excluded from our analysis any pathways with more than 85 genes, fewer than 10 genes, or fewer than 5 genes that overlapped between the pathway and the genes of interest. Out of 1,881 host pathways, these criteria filtered out 297 pathways for being too large, 299 pathways for being too small and an average of 1,186 pathways for not having sufficient overlap with the genes of interest, resulting in an average of 99 pathways that were tested for enrichment in each disease cohort. We are aware that this approach may filter out some potential pathways of interest from our analysis. However, even if included, these pathways are unlikely to yield significant associations due to lack of statistical power. The P values obtained from Fisher’s exact test were adjusted for multiple testing using the Benjamini-Hochberg (FDR) approach.

Using lasso regression and stability selection, we identified associations for cases and controls with non-zero lasso regression coefficients for each disease cohort. To identify associations that were found only in cases but not in controls within a disease cohort, we checked for any potential overlap between case and control associations, without subsetting associations using any P value or FDR cut-off. We found no overlapping host gene–microbe associations between cases and controls in any disease cohort, which could be driven by underlying biological differences between case and control conditions within each cohort. In addition, downsampling the cases to match the controls also did not yield any overlapping associations. Thus, we conclude that the designation of host gene–microbe associations as specific to cases and controls is robust to the significance cut-off and sample size differences in our study cohort.

To identify any loss of function in disease (that is, associations that are found in controls but not in cases), we performed analysis at pathway level to determine functional trends in control associations compared to case associations. To do so, we first determined any host pathways that were found enriched only in controls but not in cases at FDR < 0.1. In IBD and IBS, no pathways were found to be enriched in controls at FDR < 0.1, so we could not identify any functional trends in control associations for these two disease cohorts. In CRC, top 10 control-specific pathways at FDR < 0.1 are related to transcriptional regulation, rRNA expression, DNA methylation and other such general cellular function categories that did not provide any useful insight on loss of function in disease. Additionally, as mentioned above, we did not find any pathways that were differentially enriched in controls vs cases in any disease cohort. Hence, given that we did not find any specific functional trends in the control associations in CRC, IBD and IBS cohorts, we only focused on case-specific associations and pathways across diseases in this study.

To visualize association patterns for gut microbes and host genes that are shared between associations across diseases, we examined common microbes/genes between association-pairs across disease cohorts. Given the difference between the number of host genes and gut microbial taxa identified across diseases, we first determined overlaps in host genes and microbial taxa in input datasets and gene–taxa associations identified across disease cohorts. To do this, we used a two-step process:

Similarly, for visualizing associations for host genes that are associated with gut microbes in multiple diseases (Fig.
4b), we identified shared host genes between all possible overlaps between diseases (Fig.
4b, Networks 1–4), and host gene–taxa associations per disease for these host genes shared across diseases. We sorted the associations by FDR-adjusted p-values, i.e. q-values (ordered first by q-value in CRC associations, followed by q-value in IBD associations and finally, by q-value in IBS associations, depending on the overlapping set under consideration). We picked the top 10 genes from this merged output and identified at most the top 10 associations involving these genes in each disease for the overlapping set under consideration (FDR < 0.1, Supplementary Table 11). Since lasso gives biased estimates of the coefficients, we used Spearman correlation coefficient (rho) to depict strength of association for visualizing host gene–taxa associations. All the associations in Fig.
4 were visualized using Cytoscape v3.5.1, where shared features are in grey and disease-specific features are in disease-specific colours143.

While the disease cohorts used in our study have been previously published3,8,25,28, to the best of our knowledge, our study appears to be the first to perform a comprehensive characterization of host gene–microbiome crosstalk within and across these disease cohorts. In the previous study that described the CRC cohort, Burns et al.3 characterized the tumour-associated microbiome, and how it varies in composition compared to the microbiome of adjacent matched normal colon tissue. For example, they reported loss in abundance of multiple taxa within the order Bacteroidales in tumour-associated microbiota compared with normal samples. Here we found that Bacteroidales is associated with host genes CCR2 and FPR1, which are part of the tumour-associated IL-10 signalling pathway. The previous study that described the IBD cohort compared IBD versus non-IBD samples, and found differences in transcriptional activity and abundance among taxa belonging to class Clostridia, and dysregulation of immune-related host pathways in disease state25,28. Our integrative analysis for the same cohort revealed associations between immunoinflammatory pathways and members within class Clostridia, including Peptostreptococcaceae and Clostridium sensu stricto 1. In the original study describing the IBS cohort, Mars et al.8 found overrepresentation of Streptococcus species in patients with IBS compared with healthy individuals, and identified associations between faecal microbes, such as Peptostreptococcaceae, with host genes implicated in peptidoglycan binding. Our analyses revealed several important associations between closely interacting tissue-adherent microbiome and host genes and pathways in IBS, including associations between Streptococcus and host genes that modulate macrophage inflammatory response, and between Peptostreptococcaceae and host pathways that regulate intestinal homoeostasis and inflammation.

Our study uncovered key insights at the systems level; for example, we found that gut microbes that have been associated with all three diseases, such as Streptococcus, associate with different host genes in each disease, suggesting that the same microbial taxon can contribute to different health outcomes by potentially regulating the expression of different host genes in the colon. We also identified numerous specific hypotheses in the form of disease-specific associations; for example, we found that: Bacteroidales is associated with host genes CCR2 and FPR1 in the IL-10 signalling host pathway in colorectal cancer; Peptostreptococcaceae is associated with MAPK3 and VIPR1 that are part of G protein-coupled receptors pathways in inflammatory bowel disease; and Bacteroides massiliensis is associated with the host gene PLA2G4A, a member of the prostaglandin biosynthesis pathway, in irritable bowel syndrome.

For the colorectal cancer cohort, all research conformed to the Helsinki Declaration and was approved by the University of Minnesota Institutional Review Board, protocol 1310E44403. For the inflammatory bowel disease and irritable bowel syndrome cohorts, ethical approval is described in their respective publications8,22,25.

Further information on research design is available in the Nature Research Reporting Summary linked to this article.







Nature Microbiology thanks Sean Gibbons, and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.

Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

is available for this paper at 10.1038/s41564-022-01121-z.

The online version contains supplementary material available at 10.1038/s41564-022-01121-z.

