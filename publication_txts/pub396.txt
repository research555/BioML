Guild-based analysis for understanding gut microbiome in human health and diseases

To demonstrate the causative role of gut microbiome in human health and diseases, we first need to identify, via next-generation sequencing, potentially important functional members associated with specific health outcomes and disease phenotypes. However, due to the strain-level genetic complexity of the gut microbiota, microbiome datasets are highly dimensional and highly sparse in nature, making it challenging to identify putative causative agents of a particular disease phenotype. Members of an ecosystem seldomly live independently from each other. Instead, they develop local interactions and form inter-member organizations to influence the ecosystem’s higher-level patterns and functions. In the ecological study of macro-organisms, members are defined as belonging to the same “guild” if they exploit the same class of resources in a similar way or work together as a coherent functional group. Translating the concept of “guild” to the study of gut microbiota, we redefine guild as a group of bacteria that show consistent co-abundant behavior and likely to work together to contribute to the same ecological function. In this opinion article, we discuss how to use guilds as the aggregation unit to reduce dimensionality and sparsity in microbiome-wide association studies for identifying candidate gut bacteria that may causatively contribute to human health and diseases.

The online version contains supplementary material available at 10.1186/s13073-021-00840-y.

In the past decade, high-throughput sequencing has revolutionized microbiome research, leading to an explosive growth of studies on the associations between gut microbiome and human diseases. These microbiome studies have linked changes in the human gut microbiome with many disease outcomes, including obesity, type 2 diabetes, liver diseases, various forms of cancer, allergies, and neurodegenerative diseases [1, 2]. However, in most cases, there is still a need to identify key gut microbial members and demonstrate their causative role in the etiology and progression of a specific disease phenotype.

When the dimension of a highly sparse microbiome dataset increases, it becomes substantially more difficult to identify patterns relevant to specific health outcomes and disease phenotypes. At present, two customary approaches, a taxon-based method and a gene-centric method, are frequently used to reduce the dimensionality and sparsity of a microbiome dataset. While the current popular methods effectively reduce data dimensionality and sparsity, they often heavily depend on prior knowledge and aggregate bacterial members into functionally heterogeneous groups, thus often leading to controversial results. Here we propose a more ecologically relevant aggregation method that collapses individual microbiome members into ecological functional units, namely “guilds,” providing a more ecologically sound approach for the search of putative causative agents to human disease phenotypes in the gut microbiota.

Currently, a common strategy for reducing dimensionality is to collapse bacterial strains based on nearest neighbor taxonomy [5, 6], which assigns a microbiome sequence to a taxon if the sequence’s similarity to a known bacterium passes a certain threshold. The higher the taxon level bacteria are collapsed into, the lower dimensionality and sparsity one can achieve. Such analysis has been commonly used in microbiome-wide association studies [7–10], in which sequences representing individual microbial populations are collapsed into different taxonomic levels from “species,” “genus,” “family,” all the way up to “phylum.” However, correlating these taxa with disease phenotypes to derive microbiome biomarkers can often lead to controversial results.

Another critical limitation of taxon-based analysis is that it often excludes novel bacteria from disease association studies. At present, the generally used practice in taxon-based analysis is assigning bacterial DNA sequence taxonomic names based on their similarity to the nearest neighbor recorded in a reference database [5, 6]. In this practice, one will categorize all sequences that do not meet the similarity cut-off to sequences with known taxonomy as unclassified, and in most cases, unclassified sequences will be left out of the subsequent taxon-based data analysis. This practice limits analysis of microbiome data to what is known and available in existing databases.

Compared with target region sequencing, e.g., hypervariable regions in the 16S rRNA gene, shotgun metagenomics reveals all genetic information from the gut microbial ecosystem. It provides us with more comprehensive and in-depth insights into the gut microbiota in a high-throughput manner. Due to the large amount of genetic information of the gut microbiome and limitation of the current sequencing capacity, deep sequencing with short reads is most commonly used in metagenomic studies. The raw data obtained from metagenomic sequencing is usually composed of tens of millions of 100–150 bp short reads per sample. The short reads are then ordered and merged into longer genetic fragments (contigs) using various strategies, such as a form of de Bruijin graph based on the k-mer frequency pattern of reads [25]. Recent advances in assembly algorithms and related methodologies have significantly improved the accuracy and efficiency of metagenomic assembly [26]. Individual genes identified via reads assembly and de novo prediction [27–29] are the basic units with biologically relevant information for assembly-based metagenomics. The non-redundant gut microbial gene catalog constructed in human metagenomic studies typically contains millions of genes from a few hundreds of samples, once again leading to the problem of high dimensionality and sparsity.

Gene-centric analysis also overlooks the important reality that genes contributing to the same function may come from different bacterial carriers. Thus, these genes may show conflicting patterns of abundance change because their respective bacterial carriers may have distinct growth trajectories within a given environment. For example, in our study of patients with type 2 diabetes [41], a high-fiber dietary intervention increased the gut microbial community’s capacity to produce butyrate, as evidenced by significantly higher fecal content of butyrate after 28 days of intervention. Associated with this increase was a significant increase in the community-wide abundance of the terminal gene but in the production pathway of butyrate. However, among the 30 prevalent bacterial strains that harbored the butyrate-producing pathway, only five strains were selectively promoted by the high-fiber diet, and these five were likely to be the main drivers of butyrate production. This finding suggests that strains possessing the same pathway may differ in their contribution to the community-wide expression of that pathway function. Gene-centric microbiome analysis overlooks this fact and may confound our understanding of gut microbiota-host interactions.

Members of an ecosystem seldomly live independently from each other; instead, they develop local interactions and form inter-member organizations to influence higher-level patterns and functions of the ecosystem [42]. In macro-ecology, an important form of inter-member organization is called “guild,” a term initially coined to represent “a group of species that exploit the same class of environmental resources in a similar way” [43]. Later, guilds became synonymous with “functional groups,” and members of the same guild also encompass those who perform similar functions within a community [43]. In this context of “guild” definitions, members of a guild tend to exhibit co-abundance patterns by thriving or declining together without regard to their taxonomic positions whenever resources become available or depleted.

In practice, we suggest choosing suitable correlation methods based on specific dataset structures, such as the workflow proposed by Weisis et al. [75]. How to compare and select the best correlation methods for different microbiome datasets is beyond the scope of this article. However, in the next two sections of this opinion article, we present two guild-based analysis examples using two different correlation methods to demonstrate the possibility of integrating various correlation methods into guild-based analysis. Specifically, we recommend a dichotomic and tree-based group identification method for partitioning potential guilds without presetting the number of groups. In brief, the correlation coefficients between two genomes, two OTUs, or two ASVs could then be converted into distance metrics (1- correlation coefficient) and clustered using the Ward clustering algorithm [76]. From the top of the clustering tree, permutational multivariate analysis of variance (PERMANOVA test) is used to sequentially determine whether any of the two clades are significantly different [50]. For example, if the clustering tree has two big clades (A and B) and each one has two small clades (C and D belonging to A, and E and F belonging to B), PERMANOVA will be used to test the two larger clades first. If they are significantly different, one can test the two smaller clades under each big clade separately. If there is no significant difference between the smaller clades (C vs. D, E vs. F), the clustering will stop here and conclude that there are two potential guilds (A and B). The method we described above only serves as one example of clustering stop. Many conditions can be adopted to optimize the clustering results. One essential issue to note is that a minimum of 25 samples is needed for a robust co-abundance network analysis in microbiota studies [49]. Based on in silico stimulation work, Berry and Widder proposed several recommendations for applying co-abundance network analysis in microbiota studies [49]. A larger sample size (> 25 samples) will increase sensitivity for identifying more robust co-occurrence events. Lastly, we acknowledge that several other algorithms, such as autoencoding neural nets [77], and algorithms based on Singular Value Decomposition (SVD) [78], could also be used to reduce the dimensionality. However, whether these mathematical methods reflect the biological reality of the microbiome community remains elusive. These methods often reconstruct the dataset variables into new analysis features, such as encoder layers or principal components, making it more challenging to interpret the original variables (in this case, the individual bacterial strains). And finally, various traditional (e.g., model-based) and modern clustering (e.g., spectral graph theory based) algorithm [79] are also worth testing for the identification of guilds in future works.

We first applied the concept of guild in a clinical trial to understand the role of gut microbiota in body weight regulation of obese children [46]. Genetically obese children with Prader-Willi syndrome (PWS) lost a significant amount of weight by consuming a diet enriched with non-digestible carbohydrates for 90 days. Fecal samples were collected at four time points (days 0, 30, 60, and 90) to track the associated gut microbiota changes [46] and deep metagenomic sequencing was performed on a total of 109 time series fecal samples (including two time point samples from a group of obese children with no genetic cause within the same intervention). 76.0 ± 18.0 million (mean ± s.d.) high-quality reads were obtained from each sample using the Illumina HiSeq platform. After de novo assembly with IDBA-UD [80], gene prediction with MetaGeneMark [81], and gene de-redundancy with CD-HIT [82], we generated a non-redundant gut microbial gene catalog containing ~ 2 million genes. The gene abundance matrix had a sparsity at 79% with more than 2 million dimensions (variables) for only 109 samples.

Interestingly, in our PWS study, none of the guilds we identified was taxonomically homogeneous. The nine genomes in guild #13 were from four different phyla (Firmicutes, Proteobacteria, Bacteroidetes, and Actinobacteria; Fig. 2a). Meanwhile, bacteria that belonged to the same taxon (e.g., species) were assigned to different guilds that responded differently to the intervention. For example, five high-quality draft genomes of Eubacterium eligens were found in three different guilds: one positively responded, one negatively responded, and the third did not respond to the high-fiber intervention (Fig. 2b). Specifically, from day 0 to day 30, one E. eligens strain dramatically increased in abundance, while the other four showed a sharp or steady decrease (Fig. 3a). When these strains were collapsed at the species level, the abundance change of these five strains would have been added together and represented by the black line in Fig. 3b. Such a process would have overlooked the different response patterns of these E. eligens strains to the intervention, leading us to a spurious conclusion that the abundance of these E. eligens strains consistently decreased over the course of the intervention (Fig. 3b). This observation indicates that taxa are functionally heterogenous and do not serve as a coherent functional unit for correlation analysis with host phenotypes even at the species level. This result again echoes the limitations of taxon-based analysis, suggesting that bacterial taxa (species to phyla) are functionally heterogeneous units. By contrast, guild-based analysis groups the E. eligens strains into three guilds and accurately captures all three types of response patterns to the intervention (Fig. 3b).

Guild-based analysis is also applicable for microbiome studies based on 16S rRNA gene sequencing. Conventionally, after quality control, reads are clustered into OTUs with 97% similarity using UPARSE [84] or other OTU picking methods. Recent advancement in the field is to perform denoising, which models and corrects sequencing amplicon errors, obtaining amplicon sequences variants (ASVs) with single-nucleotide resolution [85]. Studies can then identify guilds based on abundance correlations between OTUs/ASVs. Using a 16S rRNA gene V4 sequencing dataset from a study on green tea polyphenols, we found that the gut microbiome responded to polyphenols as guilds, and some guilds were associated with the polyphenols’ effect on lowering blood glucose in db/db mice [86]. In a series of studies on calorie restriction and gut microbiota, we applied the guild-based analysis to the 16S rRNA gene datasets. We identified a Lactobacillus murinus-dominated guild, which showed a positive correlation with lifespan and metabolic health and demonstrated a robust capacity to alleviate side-effects induced by a common chemotherapeutic agent [87–89].

In this PCOS study, the taxon-based analysis excluded nearly 20% of raw sequencing data, an indication that a substantial part of the sequencing data was novel and had no close neighbor at the genus level in the reference database. Although using a similar number of OTUs as the taxon-based method, guild-based analysis kept novel sequencing data intact and did not restrict the analysis dataset to OTUs known in a reference database. Furthermore, guild-based analysis and taxon-based analysis of this PCOS dataset showed critical differences between their results on the potential role of specific OTUs in human health and disease phenotypes. First, there were discrepancies between results on Bacteroides from these two analysis strategies. A total of 13 prevalent OTUs were classified as Bacteroides. In taxon-based analysis, genus-level results showed positive correlations between Bacteroides genus and disease phenotypes (Fig. 4a), giving the impression that all OTUs in this genus may play a detrimental role in host health. Guild-based analysis clustered these 13 Bacteroides OTUs into seven different guilds. Specifically, Bacteroides OTU4 (classified into guild#1) showed a positive correlation with disease phenotype and were potentially detrimental, while Bacteroides OTU7 and Bacteroides OTU63 (both classified into guild#18) showed a negative correlation and were potentially beneficial (Fig. 4b). This result suggests that the assumed positive correlations between all OTUs in the genus Bacteroides and disease phenotypes, derived from taxon-based analysis results, could mislead our understanding of the roles of members of Bacteroides in PCOS. Secondly, when OTUs were collapsed at the genus level, the genus Alistipes did not correlate with host clinical parameters. In contrast, using guild-based analysis, we classified all eight prevalent Alistipes OTUs into five different guilds. Interestingly, Alistipes OTU130 was classified into guild#12, a guild that showed a negative correlation with host clinical parameters, while Alistipes OTU200 was classified into guild#4, a guild that was positively correlated with disease phenotypes (Fig. 4c). This finding suggests that different members of the same genus may affect the host in an opposite manner, some (as part of a guild) are positively associated with the disease phenotype, while others are negatively associated. When all the OTUs are collapsed into the same genus and used as a single variable in the analysis, OTUs with opposite relationships with the same disease phenotype could cancel each other out, resulting in a genus-level result of no correlation with the disease phenotype. Thirdly, only one OTU was annotated as Akkermansia at the genus level in the PCOS dataset. In the taxon-based analysis, this Akkermansia OTU80 had significantly different abundance among the groups and showed negative correlations with the host phenotype. In the guild-based analysis, the Akkermansia OTU80 was clustered into a guild, which also had significantly different abundance among the groups and showed negative correlations with the host phenotype. In addition to identifying Akkermansia as a potentially beneficial bacterium to host health, guild-based analysis revealed that Akkermansia OTU80 was co-abundant with one Clostridium IV OTU236 and another 8 OTUs without annotation at the genus level (unclassified OTU318, OTU272, OTU281, OTU397, OTU303, OTU300, OTU398, and OTU328). These findings suggest that the beneficial role of this Akkermansia OTU may require interactions with other bacteria [92]. Thus, guild-based analysis provides a complete picture of the ecological interactions between OTUs relevant to host health.

The guild-based analysis we proposed here is a reference database independent and ecologically meaningful way for data aggregation that may lead to dissection of ecologically meaningful functional groups and identification of putative causative members of gut microbiota to specific disease phenotypes. This strategy overcomes two primary pitfalls of conventional taxon-based and gene-centric approach: (1) combining bacteria or genes that may have opposite relations with human health or diseases into new spurious variables and (2) focusing on bacteria or genes that are similar enough to those known in existing reference databases while ignoring the unknown and novel ones. Aggregating the microbial populations (strains) into guilds, or new variables that consider the ecological interactions between the microbiota members, will facilitate pattern recognition between microbiome and host phenotype or other metadata. It is pivotal for the microbiome research field to build new analytical methods or use existing methods, such as metabolic network reconstruction and modeling [93] or reverse ecology [94–96], to understand why and how guild members, especially those significantly correlated with host phenotypes, work together. Such investigation should eventually guide the isolation of bacterial strains as a consortium (functional groups) rather than single isolates. In mechanistic studies, these recognized patterns and isolates can help identify key functional gut bacteria contributing to human health and diseases causatively [97]. Guild-based analysis may create a paradigm shift towards an ecologically meaningful approach for understanding the relationship between the gut microbiome and human health.



Publisher’s Note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

Guojun Wu and Naisi Zhao contributed equally to this work.

