Systematic assessment of secondary bile acid metabolism in gut microbes reveals distinct metabolic capabilities in inflammatory bowel disease



The human gut microbiome performs important functions in human health and disease. A classic example for host-gut microbial co-metabolism is host biosynthesis of primary bile acids and their subsequent deconjugation and transformation by the gut microbiome. To understand these system-level host-microbe interactions, a mechanistic, multi-scale computational systems biology approach that integrates the different types of omic data is needed. Here, we use a systematic workflow to computationally model bile acid metabolism in gut microbes and microbial communities.

Therefore, we first performed a comparative genomic analysis of bile acid deconjugation and biotransformation pathways in 693 human gut microbial genomes and expanded 232 curated genome-scale microbial metabolic reconstructions with the corresponding reactions (available at https://vmh.life). We then predicted the bile acid biotransformation potential of each microbe and in combination with other microbes. We found that each microbe could produce maximally six of the 13 secondary bile acids in silico, while microbial pairs could produce up to 12 bile acids, suggesting bile acid biotransformation being a microbial community task. To investigate the metabolic potential of a given microbiome, publicly available metagenomics data from healthy Western individuals, as well as inflammatory bowel disease patients and healthy controls, were mapped onto the genomes of the reconstructed strains. We constructed for each individual a large-scale personalized microbial community model that takes into account strain-level abundances. Using flux balance analysis, we found considerable variation in the potential to deconjugate and transform primary bile acids between the gut microbiomes of healthy individuals. Moreover, the microbiomes of pediatric inflammatory bowel disease patients were significantly depleted in their bile acid production potential compared with that of controls. The contributions of each strain to overall bile acid production potential across individuals were found to be distinct between inflammatory bowel disease patients and controls. Finally, bottlenecks limiting secondary bile acid production potential were identified in each microbiome model.

This large-scale modeling approach provides a novel way of analyzing metagenomics data to accelerate our understanding of the metabolic interactions between the host and gut microbiomes in health and diseases states. Our models and tools are freely available to the scientific community.

The online version of this article (10.1186/s40168-019-0689-3) contains supplementary material, which is available to authorized users.

The human gut microbiome performs essential functions for human health and is directly implicated in the pathogenesis of complex diseases, such as inflammatory bowel disease, obesity, and type II diabetes [1]. Since the etiology of these diseases is multifactorial, they can be seen as having a malfunctioning network rather than a single cause [1]. To understand the interplay between the factors underlying the disease network, such as genome, microbiome, and diet, computational systems biology approaches are necessary to integrate the different -omes, such as metagenome and metabolome, and to identify key interactions in an unbiased manner [1]. Such data-driven systems biology approaches could also identify drug-network interactions [1] and predict individual treatment responses in patients [1, 2].

A well-established computational approach for modeling human and microbial metabolism is Constraint-based Reconstruction and Analysis (COBRA) [7]. The COBRA approach relies on having genome-scale reconstruction of a target organism, which assembled based on the organism’s genome sequence and manually curated against the available genomic data and literature following established protocols [8]. A genome-scale reconstruction can readily be converted into a mathematical model, in which reactions and metabolites are represented as a stochiometric matrix, and interrogated using established methods such as flux balance analysis (FBA) [9]. Briefly, FBA relies on physicochemical (e.g., mass-charge balance) and environmental (e.g., nutrient uptake) constraints that limit the flow of metabolites through the network resulting in a solution space of feasible flux distributions [9]. Generally, FBA relies on the definition of an objective function, such as the biomass reaction, which sums all known precursors required to form a new cell. The objective function is then minimized or maximized, and the optimal solution, aka flux distribution, under the given condition-specific constraints is computed [9]. FBA operates under the steady-state assumption and as such does not require kinetic parameters to compute an optimal solution [9]. Through implementation of condition-specific constraints, e.g., a certain dietary regime, COBRA simulations have provided further insight into the metabolic capabilities of, e.g., human intestinal microbes [10–14], for which a comprehensive collection of reconstructions (AGORA) has been published [15, 16]. An advantage of the COBRA approach for microbial community modeling is that the underlying genome-scale metabolic networks enable mechanistic predictions of metabolic fluxes in each individual species while taking into account biological features, such as substrate availability or species-species boundaries [17, 18]. Previous studies have already demonstrated the use of constraint-based multi-species models for the prediction of host-microbe interactions [12, 19] and gut microbial community interactions [13, 20]. COBRA models can also be contextualized through omics data, e.g., metagenomic data [2, 14]. More importantly, by mapping metagenomic data of an individual, the metabolic microbial community model is personalized to this individual enabling the prediction of personalized metabolic profiles, which can be used to ultimately stratify disease and control groups [2, 14].

To investigate the microbiome-level bile-acid production potential of healthy individuals and IBD patients, we derived a systematic, reproducible workflow (Fig.
1). First, we expanded bile acid metabolism pathways captured in 232 gut microbial reconstructions using state-of-the-art comparative genomics methods. We then joined these reconstructions into pairwise microbial models and predicted their potential to cooperatively produce secondary bile acids. While each microbe could only produce up to six of the 13 secondary bile acids in silico, microbial pairs could produce up to 12 of the 13 bile acids, highlighting bile acid biotransformation as a microbial community task. Subsequently, we constructed functional and personalized gut microbiome models using metagenomics data from healthy and IBD individuals to predict an individual’s bile acid biosynthesis potential. We found inter-individual variation in the production capability of bile acids in healthy individuals as well as significant differences between healthy and IBD microbiomes. Moreover, we were able to compute the contribution of each strain to bile acid deconjugation and transformation while taking the metabolic network of the whole microbiome community and the applied constraints (e.g., dietary uptake) into account. Finally, we identified bottlenecks limiting the biotransformation potential into secondary bile acids. This mechanistic, microbiome-wide modeling approach can be readily applied to the personalized computation of other health-relevant human-microbial co-metabolites.

To determine how widely genes encoding for bile acid pathways are spread in human gut microbes, we performed a systematic comparative genomic analysis of the bile acid deconjugation and transformation pathway (Fig.
2), starting with previously characterized enzymes for primary bile acid deconjugation [21] and transformation into secondary bile acids [22–25]. Of the currently 818 microbial AGORA reconstructions, which include 46 newly reconstructed gut microbes (see the “Materials and methods” for details), only 670 genomes were available at the PubSEED database [26, 27]. We additionally analyzed 23 further microbial genomes, yielding a total of 693 considered genomes (Fig.
1a). We found the bile salt hydrolase (bsh) gene, which encodes the deconjugation of conjugated primary bile acids, in 204 of the 693 (29%) genomes, including two archaeal genomes, Methanobrevibacter smithii ATCC 35061 and Methanosphaera stadtmanae DSM 3091 (Additional file 1: Table S1). The distribution of the bsh gene in Actinobacteria, Bacteroidetes, Firmicutes, as well as the two archaea (Fig.
2, Additional file 2: Figure S1) was in line with previously reported results [21]. Additionally, the bsh gene was found in 22 Proteobacteria genomes (Additional file 1: Table S1). Among all analyzed hydroxysteroid dehydrogenases (HSDHs), 7α-HSDH was the most widespread enzyme as it was found in 46 of the 693 (7%) genomes (Additional file 1: Table S1 and Additional file 2: Figure S2). Additionally, 3α-, 3β-, and 7β-HSDHs were found in 17, 12, and 3 genomes, respectively (Additional file 1: Table S1 and Additional file 2: Figure S2). Using results from a recent work [24], we found the 12α-HSDH in 39 genomes, which belonged mostly to Firmicutes representatives (Additional file 1: Table S1). We could not find the 12α-HSDH in the Clostridium leptum genome, although the enzymatic activity has been demonstrated [28].

In summary, our comparative genomics results expanded substantially our knowledge about bile acid deconjugation and transformation in gut microbes, while being consistent with previous studies [21–25]. Consequently, we propose that 253 of the 693 analyzed intestinal microbes (37%) can deconjugate and/or transform bile acids, including 232 reconstructed AGORA organisms (Additional file 1: Table S1, Fig.
1a).

The manual curation and refinement of genome-scale reconstructions is an iterative process [8]. Species-specific pathways are typically absent in draft reconstructions [31]. Since we did not explicitly account for bile acid pathways in the curation of AGORA [15] prior to the present paper, this subsystem was absent. The 232 metabolic reconstructions found to carry bile acid enzymes (Additional file 1: Table S1) were expanded with the corresponding metabolites and reactions, while ensuring functionality of the included pathways, following established procedures [8, 32] (see “Materials and methods” section). The complete reconstructed bile acid biotransformation subsystem contained 39 bile acid metabolites and 82 reactions (Fig.
2, Table
1, Additional file 1: Table S2a, b). For CA, CDCA, and the 13 secondary bile acids (Table
1), transport and exchange reactions enabling the uptake and secretion of these metabolites were added to the corresponding reconstructions. Taken together, we expanded the AGORA reconstructions with a bile acid module thus further improving their predictive potential and enabling their use for large-scale simulations of bile acid deconjugation and transformation.

The majority of primary bile acids, released by the human gallbladder into the intestine, where the gut microbiome encounters them, are conjugated to glycine or taurine [3]. However, many strains capable of synthesizing secondary bile acids do not possess the bile salt hydrolase (Additional file 1: Table S1) and thus, rely on bile salt hydrolase-encoding strains to access the deconjugated primary bile acids.

To investigate whether pairwise combinations of certain strains could complement each other’s bile acid pathways, the 232 bile acid-producing AGORA models were joined in every possible combination resulting in 26,796 pairwise models using the Microbiome Modeling Toolbox [33], a COBRA Toolbox [34] extension. When comparing the bile acid production capabilities of the pairwise models with the respective single-strain models on the bile acid-supplemented “Average European” diet, we identified 7673 microbe pairs (29%) that could synthesize at least one secondary bile acid whereas the respective two individual strains were incapable to do so, resulting in 19,883 cooperative bile acid syntheses (Fig.
3a, Additional file 1: Table S5). For example, 3135/7673 pairs (40.9%) could synthesize 12-dehydro-CA from Glyco-CA or Tauro-CA (Additional file 1: Table S5). Further, 736 pairs (2.7%) and 100 pairs (0.4%) could synthesize DCA/LCA and UCA/UDCA, respectively, from the conjugated primary bile acids (Additional file 1: Table S5), demonstrating distinct bile acid synthesis capabilities of microbial pairs. There was no pairwise combination enabling synthesis of all secondary bile acids as the maximal number of secondary bile acids to be synthesized by any pair was 12 out of 13 (Fig.
3a). Taken together, while only few strains were capable of both bile acid deconjugation and biotransformation, many of the microbial pairs are predicted to synthesize secondary bile acids from the conjugated bile acids. This example demonstrates that constraint-based modeling is an efficient approach to elucidate the combined capabilities present in thousands of microbe pairs compared with the single microbes. The presented computational workflow could readily be applied to other microbial pathways of interest, in which enzymes are distributed across multiple taxa in an ecosystem.

We next aimed to predict the bile acid deconjugation and biotransformation potential of individual-specific gut microbiomes. It is well known that bile acid metabolism is altered in individuals with IBD [3]. We were interested whether personalized modeling could provide novel insight into the differences in bile acid deconjugation and biotransformation potential between the microbiomes of IBD patients and controls as well as elucidate species contributing to the pathways. For comparison, we also evaluated the range in bile acid metabolic capabilities in healthy adults. We used metagenomic data from two sources: (1) 149 healthy American donors aged 18–40 years provided by the Human Microbiome Project Consortium [35] and (2) 20 children with newly diagnosed Crohn’s disease and microbial dysbiosis and 25 healthy controls (COMBO/PLEASE cohort [36, 37]). Using strain-level abundances, after mapping the reads onto the reference set of AGORA genomes [38], we generated personalized microbiome community models for each of the 194 sample by joining the corresponding metabolic reconstructions (Fig.
1b, the “Materials and methods” section ). Each microbiome model was constrained with the “Average European” diet supplemented with conjugated primary bile acids (Additional file 1: Table S3). A typical personalized microbiome model contained 127 AGORA models and 142,000 reactions (Table
2) making this work one of the largest constraint-based modeling efforts to date.

To predict the maximally possible bile acid deconjugation and biotransformation potential of the 194 microbiome models, we performed flux balance analysis while maximizing for the fecal secretion reaction flux (mmol × person-1 × day-1) of the primary bile acids, CA and CDCA, and 13 secondary bile acids (Fig.
3b, c and Additional file 1: Table S6). The quantitative production potential varied significantly between the models, with the quantitative production potential of LCA and DCA varying by a factor of 100 (Additional file 1: Table S6). A statistical analysis (Wilcoxon rank sum test, with p values adjusted for false discovery rate (FDR) by Benjamini-Hochberg method) was performed on the total community production potential of the 20 IBD patients (IBD_pediatric) and the 25 control microbiomes (Healthy_pediatric) (Fig.
3b, c, Additional file 1: Table S7). Compared with the microbiomes of healthy children, the IBD patient microbiomes were significantly depleted in 12-dehydrocholate production potential (p value < 0.001). Primary bile acid deconjugation potential was lower in IBD patients but only borderline significant after adjustment for FDR (adjusted p value = 0.0551); however, the abundance of the bile salt hydrolase reaction was significantly reduced in IBD microbiomes (p value 0.0235, Additional file 1: Table S7) and also differed based on phylum-and genus-level reaction abundances for many taxa (Additional file 1: Table S7). Microbiomes with low CA/CDCA liberation potential from the conjugated bile acids also had a low secondary bile acid potential (Additional file 1: Table S6) in agreement with the fact that the bile salt hydrolase is the gateway reaction in the pathway [39]. Taken together, we predicted the inter-person variability in the bile acid biosynthesis potential with microbiomes from IBD patients being significantly depleted in bile acid deconjugation and biotransformation potential, consistent with reports that IBD patients have higher levels of fecal conjugated and lower levels of secondary bile acids [5].

What is the contribution of individual strains to the overall bile acid deconjugation and biotransformation potential? While previous studies have correlated certain taxa to measured metabolite levels [40], we determined here exactly which strains were producing the bile acids in the individual microbiome models using the aforementioned simulation results. Overall, 198 strains contributed to total production flux of at least one bile acid in at least one microbiome model (Additional file 1: Table S8). Of those, 15 strains contributed in > 90% of communities across both cohorts and thus play a significant role in bile acid metabolism. These strains included known commensals, such as Ruminococcus gnavus ATCC 29149, Coprococcus comes ATCC 27758, Faecalibacterium prausnitzii L2_6, Clostridium sp. M62_1, Eubacterium ventriosum ATCC 27560, Bacteroides pectinophilus ATCC 43243, and Dorea formicigenerans ATCC 27755. A variety of Bacteroides strains performed bile acid deconjugation and 7-keto-DCA/7-dehydro-CDCA biosynthesis, and their contribution was significantly depleted in the IBD microbiomes (p values for all < 0.01, Additional file 1: Table S7). Consistently, a positive correlation between Bacteroides spp. and secondary bile acid biosynthesis was found [36]. Using a Principal Coordinates Analysis on the strain-level contributions, we observed a clear separation between the IBD patients and controls (Fig.
3d), as well as between the HMP individuals and the pediatric individuals, due to the difference in strains (Fig.
3d, Additional file 2: Figure S7). The strain difference is most likely due to differences in age, location, and ethnicity of the two cohorts. On the phylum level, the contributions in both the healthy adult and healthy pediatric microbiomes were mostly driven by Actinobacteria, Bacteroidetes, and Firmicutes representatives, as expected, while Proteobacteria contributed significantly in the IBD microbiomes (p values for all < 0.05, Additional file 1: Table S7 and Additional file 2: Figure S7). A Wilcoxon rank sum test adjusted for FDR on strain-level contributions revealed that 303 strain-level contributions differed significantly between dysbiotic IBD and healthy pediatric microbiomes (p value < 0.05, Additional file 1: Table S7). Strain contributions mostly depleted in the IBD microbiomes included those of Bacteroides vulgatus ATCC 8482, Ruminococcus (Blautia) torques L2-14, Faecalibacterium prausnitzii strains, Eubacterium rectale strains, Ruminococcus sp. SR1-5, and Clostridium sp. M62-1 (p values for strains were < 0.001, Additional file 1: Table S7). The IBD microbiomes had significantly lower deconjugated CA and CDCA contributions by Actinobacteria and Bacteroidetes representatives (p values < 0.05, Additional file 1: Table S7 and Additional file 2: Figure S7). The contribution of 12-dehydro-CA production flux, which was significantly reduced in the IBD microbiomes (p value < 0.001, Additional file 1: Table S7) was attributed mostly to representatives of the Lachnospiraceae and Ruminococcaceae families, which are considered to be beneficial due to containing many butyrate producers [41]. These representatives included two Faecalibacterium prausnitzii strains (p value < 0.001), a species well known to be depleted in IBD [42]. In contrast, the overall 7-dehydro-CA production potential was comparable between the IBD and the healthy pediatric microbiomes (Additional file 1: Table S7). However, the strains contributing were different, with reduced contributions by commensal bacteria to the production of 7-keto-DCA/7-dehydro-CDCA, and increased contributions of the pathogenic Escherichia coli strains O157-H7 Sakai and UTI89 UPEC (Additional file 1: Table S7). These two strains contributed significantly higher to deconjugation and 7-keto-DCA/7-dehydro-CDCA production in the IBD microbiomes (p value < 0.001, Additional file 1: Table S7). Taken together, the dysbiotic IBD microbiomes, compared to the healthy control microbiomes, were depleted in contributions of a variety of commensal microbes to bile salt hydrolase and to bile acid biotransformation but enriched in contributions of pathogenic Escherichia sp. (Additional file 1: Table S7). Thus, the IBD microbiomes had distinct bile acid deconjugation and transformation potential, consistent with reports that bile acid composition in IBD patients is abnormal [5]. In total, 488 analyzed features, which encompasses total production, strain contributions, and reaction abundances, were significantly different (p-value <0.05), of which 375 were highly significant (p-value <0.001) (Additional file 1: Table S7).

To test whether the bile acid production potential could be directly predicted from the abundance of the metagenomics data mapped onto the AGORA reconstruction (i.e., from the encoding gene abundance), we calculated the Spearman correlation between the individual production potential for the two deconjugated primary and 13 secondary bile acids (Table
1) and the total community abundance for all reactions in the bile acid pathway in the 194 community models. Consistently, for 13 of the 15 bile acids, the correlation between production potential and the abundance of reaction directly synthesizing the respective bile acid was 0.96 or higher (Additional file 1: Table S9). The secondary bile acid Iso-CA is synthesized from 3-dehydro-CA by 3β-HSDH. Surprisingly, the Spearman correlation between production potential for Iso-CA/Iso-CDCA and the abundance of the 3β-HSDH reaction (VMH ID: ICA3bHSDHe/ ICDCA3bHSDHe) calculated for all 194 microbiome models was only 0.18 indicating that the reaction abundance of the producing reaction did not correlate with production (Additional file 1: Table S9). In fact, only a minority of the 194 microbiome models with a high abundance of the 3β-HSDH reaction (VMH ID: ICA3bHSDHe), all of which were IBD microbiomes, also had a high Iso-CA production flux (Fig.
4a). Thus, factors other than 3β-HSDH abundance limited the production flux. To identify these factors, the metabolic fluxes needed to be analyzed in the context of the pathway and the microbial community. Constraint-based modeling is ideal for such analyses of metabolic dependencies since it is mechanistic on the molecule level and takes species-species metabolic exchanges and boundaries into account [18].

In summary, by analyzing the shadow prices associated with each flux balance analysis solution when optimizing for secondary bile acid production, strain-specific contributions to their biosynthesis were determined for each personalized community model. Four scenarios with different bottlenecks for the biosynthesis of Iso-CA were identified. This analysis highlights once more that the metabolic potential of an individual microbiome, and strategies to manipulate this metabolic potential, cannot be inferred solely from the abundance of single genes and depends on the community-wide metabolic network as well as metabolic constraints (e.g., substrate availability). We demonstrated that constraint-based modeling allows for the generation of mechanistic, testable hypotheses.

In this work, we used a systematic computational modeling workflow to investigate the bile acid production capabilities of gut microbes and gut microbial communities. After annotating and reconstructing the bile acid deconjugation and transformation pathways (Fig.
1a, Fig.
2) in 693 human gut microbe genomes, we first built pairwise microbial models providing novel insight into strain-specific bile-acid production capabilities. We then assembled gut microbiome models for each metagenomics sample of either healthy individuals or pediatric IDB patients. The three key results of our analysis are as follows: (1) microbes can complement each other’s bile acid pathway to achieve the broader bile acid production repertoire observed in fecal samples, (2) bile acid production profiles of 194 microbiome models were individual-specific and distinguished healthy controls from pediatric IBD patients, and (3) the bile acid production profiles could not be predicted by reaction (gene) abundance alone, as illustrated for Iso-CA illustrating the added value of computational modeling of metabolite production capabilities of microbial communities.

While the scope of the present work is the prediction of bile acid metabolism, in future efforts, other health-relevant microbial metabolic subsystems may be considered. For instance, Lewis et al. found that several pathways, e.g., glycerophospholipid metabolism, amino benzoate degradation, sulfur relay system, and glutathione metabolism, separated healthy and dysbiotic microbiomes [36]. In a follow-up work, fecal amino acid levels have been found to be altered in IBD patients and to positively correlate with Proteobacteria [40]. Applying the computational workflow presented in this study to predict the gut microbial metabolome beyond bile acid metabolism would allow us to mechanistically link altered metabolites with strain-specific capabilities. Ultimately, such analysis could lead to novel insights into the mechanisms behind altered metabolomes in disease states and allow pinpointing disease-relevant species and/or enzymes that may serve as novel drug targets.

We demonstrated that an in silico metabolic modeling workflow could elucidate the metabolic potential of an individual’s microbiome, which cannot be done based on gene count and reaction abundance alone. We illustrated this workflow using metagenomics data of healthy individuals and IBD patients while focusing on bile acid metabolism. Importantly, we were able to demonstrate that this mechanistic, strain- and metabolite-resolved, unbiased, and inexpensive approach allows for the systematic interrogation of the metabolic potential of an individual’s microbiome and can yield testable novel hypotheses. Integrative systems biology approaches are urgently needed to gain novel insight into complex, multifactorial diseases, such as IBD [1]. In future efforts, personalized modeling could also be applied to predicting individual-specific dietary or therapeutic interventions [63]. The AGORA resource, the COBRA Toolbox, and the Microbiome Modeling Toolbox are freely available to the scientific community. We have also created extensive tutorials (available at the COBRA Toolbox GitHub) aiding users interested in applying our framework. We expect that the metabolic modeling approach presented will have valuable applications in unraveling the role of human-gut microbiome metabolic interactions in human health and disease.

All 773 strains of the AGORA resource [15], 46 strains reconstructed in this study, and 23 currently not reconstructed strains were analyzed for the presence of their genomes at the PubSEED resource [26, 27], resulting in 690 bacterial and three archaeal genomes to be considered in this study (Fig.
1a). Note that only 670 of the reconstructed microbes had their genomes available in PubSEED and were consequently used for the comparative genomic approach. All 693 human gut microbe genomes were analyzed for the presence of orthologs of bile acid deconjugation and biotransformation genes (Additional file 1: Table S1). Orthologs are defined as genes that satisfy the following conditions: (1) Orthologs should be closely homologous proteins (e-value cutoff = e−50). (2) Orthologs should be found in the same genomic context, i.e., the structure of gene locus should be conserved in related genomes. (3) Orthologs should form a monophyletic branch of a phylogenetic tree.

The following previously analyzed genes were used as a starting point: (1) genes for bile salt BSH from multiple genomes [21], (2) 7α–HSDH) from Bacteroides fragilis [22], (3) 3α- and 3β-HSDHs genes from Eggerthella lenta DSM 2243 and Ruminococcus gnavus ATCC 29149 [23], (4) 7α-HSDH and baiABCDEFGHI genes for a multistep 7α/β-dehydroxylation pathway, (5) bai genes from Eggerthella lenta DSM [23], (6) 7β-HSDH gene from Clostridium absonum [25], and (7) 12α-HSDH from Clostridium hylemonae DSM 15053, Clostridium scindens ATCC 35704, and Clostridium hiranonis DSM 13275 [24]. Note that Clostridium leptum has been experimentally shown to have 12α-HSDH activity [28]; however, we were unable to identify the 12α-HSDH gene in its genome. BSH proteins are closely related to the penicillin V amidase (PVA) proteins [21]. To avoid mis-annotations, a phylogenetic tree for BSH proteins and their homologs in the analyzed genomes was constructed (Additional file 2: Figure S1), and orthologs of the known BSH genes were identified. All HSDH proteins listed above demonstrated similarity to each other and with BaiA proteins. Thus, orthologs for HSDH/BaiA proteins were resolved through the construction of a phylogenetic tree (Additional file 2: Figure S2). Finally, two new genes in the 7α/β-dehydroxylation pathway (BaiO and BaiP, Fig.
2) were predicted in this work. All of the annotated genes are represented as a subsystem at the PubSEED website [69] and can be found in Additional file 1: Table S1.

Reaction mechanisms were retrieved from the KEGG database [70] as well as published literature (e.g., [71]). For all genomes having genes for BSH, HSDHs, or the complete 7α/β-dehydroxylation pathway (Fig.
2), metabolic mass- and charge-balanced reactions were formulated. Exchange reactions were added for all extracellular metabolites. Most reactions were associated with genes and proteins annotated in the analyzed genomes. Reactions not-associated with genes and proteins were only added if the gene was unknown but the reaction was required to eliminate dead-ends in a metabolic pathway. Thus, the following gap-filling reactions were added without associations with genes or proteins: (1) A transport reaction for LCA, the final product of 7α/β-dehydroxylation pathway which was added as the transporter is unknown. (2) Pathways that yield allolithocholate (allo-LCA) and allodeoxycholate (allo-DCA) were included for strains possessing the bai gene cluster as these compounds are known to be side-products of the 7α/β-dehydroxylation pathway [72] and found in human adults under certain circumstances [3].

All metabolites and reactions were formulated following an established reconstruction protocol [8]. Metabolites and reaction abbreviations in the bile acid subsystem were created in accordance with the Virtual Metabolic Human (VMH) [16] nomenclature to ensure compatibility with the human metabolic reconstruction. The MATLAB-based reconstruction tool rBioNet [74], which ensures quality control and quality assurance, such as mass- and charge-balance, was used to add the metabolites and reactions to the appropriate reconstructions. All reactions and metabolites in the reconstructed bile acid subsystem are described in Additional file 1: Table S2a, b.

A total of 46 gut microbial strains were newly reconstructed. The reconstructions were generated by semi-automatically expanding and curating KBase [75] draft reconstructions following the established AGORA pipeline used in [15] (Additional file 1: Table S11). Of the 773 AGORA strains and 46 newly reconstructed strains, 232 strains total carried at least one gene in the bile acid pathway (Additional file 1: Table S1) and six produced coprostanol. The corresponding reconstructions were expanded by the appropriate metabolites and reactions using rBioNet [74] and subjected to extensive quality-assurance and control measures [8, 32] (Fig.
1a). The expanded resource, accounting for 818 strains, is available on the Virtual Metabolic Human website [16].

The 232 AGORA reconstructions carrying bile acid reactions were joined pairwise in every possible combination as described previously [15] using the Microbiome Modeling Toolbox [33]. In total, 26,796 pairwise models were created.

Metagenomic datasets from 194 samples in total were obtained from three sources: (1) Strain-specific relative abundance data from 149 individual microbiotas of healthy American individuals was obtained from the Human Microbiome Project website [35]. (2) Paired-end Illumina raw reads of 33 dysbiotic Crohn’s Disease patients in the PLEASE cohort [36] and of 26 healthy controls in the COMBO cohort [37] were retrieved from NCBI SRA under SRA: SRP057027. For the latter dataset, the reads had been pre-processed and then mapped onto the reference set of 773 AGORA genomes, as described in [38]. To reduce the number of false positives, a cutoff of 10% genome coverage was applied to the resulting coverages (representing a threshold of at least 10% genome coverage for each microbe in each human individual). The resulting coverages were normalized for each individual in order to obtain the relative abundances. To avoid too small model sizes, microbiome models, for which less than 20 strains could be mapped to the reference set of AGORA genomes, were excluded from the analysis. This was the case for 13 samples from the PLEASE cohort and one sample from the COMBO cohort.

Personalized microbiome models were then created using the mgPipe module in the Microbiome Modeling Toolbox [33] (Fig.
1b). Briefly, for all strains identified in at least one metagenomics sample, the corresponding AGORA reconstructions, if available, were joined into one global constraint-based microbiome community reconstruction as described elsewhere [17, 33]. For each of the 194 metagenomic samples, the list of all the mapped strains and their strain-level abundances served as input data for deriving a personalized microbiota model from the global community reconstruction, which consisted of the joined AGORA reconstructions corresponding to each strain present in the sample. The flux through each AGORA strain’s model was coupled to its respective biomass objective function, as described elsewhere [11]. Then, we parameterized the community biomass reaction by applying the strain-level abundances as stoichiometric values for each microbe biomass reaction in the community biomass reaction (Fig.
1b). These constraints enforced that all strains grew at the experimentally measured ratios. Subsequently, an Average European diet supplemented with conjugated primary bile acids (see below) was applied as constraints on the dietary exchanges. To simulate a realistic turnover of microbial biomass, the allowed flux through the community biomass reaction was set to be between 0.4 and 1 mmol × person-1 × day-1, corresponding to a fecal emptying of once every three days to once a day. The features of the personalized community models are given in Table
2.

A diet representing the nutrient intake of an average European individual was obtained from the nutrition resource in the Virtual Metabolic Human database [16] along with the corresponding flux values. The diet was supplemented with metabolites previously determined necessary for the biomass production of at least one AGORA reconstruction [15]. Each microbiota community model was constrained with the Average European diet using a dedicated function in the Microbiome Modeling Toolbox [33] (adaptVMHDietToAGORA.m). Additionally, to enable modeling of bile acid transformation, the uptake of the conjugated primary bile acids Glyco-CA (VMH ID: gchola), Tauro-CA (VMH ID: tchola), Glyco-CDCA (VMH ID: dgchol), and Tauro-CDCA (VMH ID: tdchola) was allowed to be taken up unlimitedly by setting the lower bounds on the corresponding exchange reactions to − 1000 mmol × person-1 × day-1. The lower bounds on all other dietary exchange reactions were set to zero preventing the uptake of these metabolites. The constraints implemented to simulate the diet are given in Additional file 1: Table S3.

The bile acid production potential in 232 AGORA reconstructions and 26,796 pairwise models was determined using FBA [9]. To predict the maximally possible bile acid production flux, the exchange reactions (in the single and pairwise models) and the fecal secretion reactions (in the community models) for CA, CDCA, and 13 secondary bile acids were individually chosen as the objective function and maximized. The 194 sample-specific community models were interrogated using distributedFBA [76]. To determine the total maximal production potential, the maximal flux through the fecal exchange reactions in the community models was maximized. To retrieve the contribution of each individual strain to overall production, the minimal fluxes through the luminal exchange reactions of each joined AGORA model (representing secretion into lumen) were extracted. Shadow prices were retrieved from each computed flux balance solution [7]. To extract the shadow prices for all metabolites in the respective community model that were computed while maximizing the production flux of secondary bile acids, a dedicated function (analyseObjectiveShadowPrices.m) in the Microbiome Modeling Toolbox [33] was used.

Model creation and contextualization, and simulations were carried out using the COBRA Toolbox [34] and the Microbiome Modeling Toolbox [33] in MATLAB version 2016b (Mathworks, Inc.) as programming environment. Flux balance analysis (FBA) [9] for pairwise simulations was performed using the optimization solver CPLEX through the Tomlab (Tomlab, Inc.) interface for MATLAB. Distributed flux balance analysis (distributedFBA) [76] for personalized microbiome simulations was performed using the IBM CPLEX solver (IBM, Inc.) through the CPLEX interface for Julia.

The calculation of the Spearman correlation and the two-sided Wilcoxon rank-sum test was performed in MATLAB version 2016b (Mathworks, Inc.) using the corr and ranksum functions, respectively. The p values were adjusted for false-positive discovery rate with the Benjamini-Hochberg method using the mafdr function in MATLAB. Heatmaps were generated with R version 3.3.2 [77] using the aheatmap, pheatmap, ggplot2, easyGgplot2, and RColorBrewer packages, as well as the ComplexHeatmap package in Bioconductor 2.7 (http://www.bioconductor.org/). Principal Coordinates Analysis (PCoA) was performed with the vegan package in R using the Bray-Curtis dissimilarity index. Other plots were generated with MATLAB.



This study was funded by Luxembourg National Research Fund (FNR) through the ATTRACT program grant (FNR/A12/01 to I.T.), the National Centre of Excellence in Research (NCER) on Parkinson’s disease, and the OPEN (FNR/O16/11402054) grant and by the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation program (grant agreement No 757922).

The annotated bile acid pathway genes are represented as a subsystem at the PubSEED website [69]. The expanded AGORA reconstructions generated in this study are available at the VMH database (https://vmh.life) [16]. The simulation results are shown in this article and its Supplementary files. Scripts used to analyze simulation results are available as a tutorial in the COBRA Toolbox [34] GitHub (https://github.com/opencobra/cobratoolbox) and rely on the COBRA Toolbox [34], COBRA.jl [76], and the Microbiome Modeling Toolbox [33].

Not applicable. All data has been published elsewhere [35–37].

Not applicable. All data has been published elsewhere [35–37].

The authors declare that they have no competing interests.

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

