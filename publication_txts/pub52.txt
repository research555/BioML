Genome-wide associations of human gut microbiome variation and implications for causal inference analyses





Recent population-based1–4 and clinical studies5 have identified a range of factors associated with human gut microbiome variation. Murine quantitative trait loci6, human twin studies7 and microbiome genome-wide association studies (mGWAS)1,3,8–12 have provided evidence for genetic contributions to microbiome composition. Despite this, there is still poor overlap in genetic association across human studies. Using appropriate taxon-specific models along with support from independent cohorts, we show association between human host genotype and gut microbiome variation. We also suggest that interpretation of applied analyses using genetic associations is complicated by the likely overlap between genetic contributions and heritable components of host environment. Using fecal derived 16S rRNA gene sequences and host genotype data from the Flemish Gut Flora Project (FGFP, n=2223) and two German cohorts (FoCus, n=950, PopGen n=717), we identify genetic associations involving multiple microbial traits (MTs). Two of these associations achieved a study-level p-value threshold of 1.57×10−10; an association between Ruminococcus and rs150018970 near RAPGEF1 on chromosome 9, and between Coprococcus and rs561177583 within LINC01787 on chromosome 1. Exploratory analysis was undertaken using 11 other genome-wide associations with strong evidence for association (p-value < 2.5×10−08) and a previously reported signal of association between rs4988235 (MCM6/LCT) and Bifidobacterium. Across these 14 SNPs there was evidence of signal overlap with other GWAS including those for age at menarche and cardiometabolic traits. Mendelian randomization (MR) analysis was able to estimate associations between MTs and disease (including Bifidobacterium and body composition), however in the absence of clear microbiome driven effects, caution is needed in interpretation. Overall, this work marks a growing catalog of genetic associations which will provide insight into the contribution of host genotype to gut microbiome. Despite this, the uncertain origin of association signals will likely complicate future work looking to dissect function or use associations for causal inference analysis.

Human host-microbiome mGWAS are still in their infancy and feature a paucity of overlap for even the most compelling signals across studies13. This is an observation influenced by environmental variables dominating microbial trait variation1 and the complications of variation in sample collection, storage conditions, DNA extraction method, PCR primers, and amplicon versus shotgun sequencing14. While recent advances are improving resolution and reliability of microbiome profiles15, inter-study analytical methodologies analyzing those profiles vary extensively (Table S1). Microbiota profiles, being the product of ecological sampling, are often zero-inflated with varying distributions across taxa. Consequently, variation in modeling, normalization procedures and choices of diversity indicators can greatly influence results across studies.

Genetic variants, representing LD-tagged loci, associated with 16S gut microbiome phenotypes at a meta-p-value smaller than 2.5×10-08. Presented are the microbial taxa, the trait model type - abundance (AB) or presence/absence (P/A) - the reference SNP identifier (rsID), the SNP ID composed of chromosome, base pair (build hg19), alternative allele and effect allele, chromosome, position (bp), the effect allele frequency (EAF), the meta estimated effect size (β; presented as odds ratios for P/A, and in SD units of change for AB outcomes), standard error (se, in log(OR) scale for P/A outcomes), two-sided inverse variance fixed effect meta p-value, meta-sample size (N), Cochran’s Q heterogeneity statistic (Q), the heterogeneity p-value (hetP), the proportion of variation among studies due to heterogeneity (I2) and the physically closest gene (+/- 250kb). P, C, O, F, G preceding taxa names indicate the classification levels phylum, class, order, family and genus, while u indicates unclassified. Genetic variants are sorted by significance (p-value), with the top two surpassing the study-wide meta-analysis p-value shaded in blue. Taxon names include abbreviated taxonomic levels, where “G” represents genus, “F” family, “O” order, “P” phylum, and “u” unclassified.

Results from bi-directional Mendelian randomization analysis querying causal relationships between microbial traits (MTs) on each trait and each trait on MTs. The exposure identifies the independent variable in the analysis, while the outcome is the dependent variable. Presented are the trait model type - abundance (AB) or presence/absence (P/A) and the number of SNPs used as “instruments” for the exposure (nSNP). Primary MR results were limited to two MR models, namely the inverse variance weighted (IVW) and Wald ratio methods. All other models were considered sensitivity analysis and can be found in Table S13. The beta, se, and p-value provide the effect estimate (risk ratios for binary outcomes (*) and SD units of change for continuous outcomes), standard errors (in log(OR) scale for binary outcomes), and uncorrected two-sided model p-values for that analysis, respectively. Analyses were restricted to those MTs found in Table 1, with rank normalized Bifidobacterium (shaded in grey) as an addition. Sample sizes for each previously published GWAS disease trait can be found in Table S14.

Using a targeted meta-analysis framework, including the largest cross-sectional study with host genetics and microbiome data available, combined with distinct modeling of different MTs, we have detected evidence for host genetic associations to the gut microbiome. While environmental effects are likely to preside over host genetics as source of variation, this work illustrates that, even in the presence of unavoidable study-based heterogeneity, standardized and appropriate analytical protocols allow signal detection. We note that this study is limited to genus-level microbiome traits and that host-microbial interaction signals might be more pertinent at species or strain levels, but strain-level GWAS require much larger population sizes and metagenomic sequencing. Additionally, we have shown that associated loci can be deployed in frameworks designed to explore function and causality in otherwise observational associations between MTs and human phenotypes. To that end, future large-scale meta-analyses will likely advance this type of endeavor by providing larger catalogues of genetic variants associated with microbiome, however this approach is unlikely to be straightforward. It appears likely that signals captured in this type of mGWAS reflect a microbial footprint of disease or behavior and this complexity will need to be accounted for in future analyses aiming to use human genetics to target causal effects of the gut microbiome31. Despite this, with a further expanded catalog of reliable loci contributing to microbiome variation, there will be greater insight into the contribution of host genotype to gut microbiome variation and better understanding of the relationship between gut microbiota, host molecular biology and disease.

Individuals from the Flanders region of Belgium were recruited into the Flemish Gut Flora Project (FGFP) through public announcements in print and social media through the FGFP website (www.vib.be/darmflora), from January 2013 onwards. Volunteers provided informed consent by mail and FGFP procedures were approved by the medical ethics committee of the University of Brussels/Brussels University Hospital (approval 143201215505, 5/12/2012). A declaration concerning the FGFP privacy policy was submitted to the Belgian Commission for the Protection of Privacy. Additional information on the age, sex, height, weight BMI, waist hip ratio, and low-density lipoprotein distributions for FGFP cohort samples are provided in Supplementary Information (Table S6, Supplementary Fig. 3).

Fecal DNA was extracted from the frozen fecal samples using the PowerMicrobiome RNA Isolation Kit (MOBIO Laboratories Inc.) following manufacturer’s instructions, with the addition of a heating step (10min at 90°C) after vortexing/bead beating to increase DNA yield, and with the exclusion of DNA removal steps (steps 12 to 16 in the protocol). Further information on recruitment, sampling and DNA extraction can be found in Falony et al 4.

For 2482 FGFP individuals, the V4 region of the 16S rRNA gene was amplified using the 515F/806R primer pair (GTGYCAGCMGCCGCGGTAA and GGACTACNVGGGTWTCTAAT, respectively), modified to contain a barcode sequence between each primer and the Illumina adaptor sequences to produce dual-barcoded libraries32. Size selection was performed using Agencourt AMPure to remove fragments below 200 bases. Sequencing was carried out on the Illumina HiSeq platform at the VIB Nucleomics core laboratory (Leuven, Belgium) with 500 cycles (sequencing kit HiSeq-Rapid SBS kit, version 2), producing 2x 250bp paired-end sequencing reads. After de-multiplexing with sdm as part of the LotuS pipeline33 without allowing for mismatches, fastq sequences were further analyzed per sample using DADA2 pipeline (v. 1.6)15. In brief, after inspecting quality, sequences were trimmed to remove the primers and the first 10 bases after the primer, keeping only 200 bases and 130 for the R1 and R2 files, respectively. After merging paired sequences and removing chimeras, compositional matrices for each taxonomical level were carried out using the Ribosomal Database Project (RDP) training set ‘rdp_train_set_16’. Each sample was randomly down-sampled, also known as a rarefaction step, reducing the microbiome to a size of 10,000 reads. Classifications with low confidence at the genus level (<0.8) were organized in an arbitrary taxon of “unclassified_group”.

The DADA2 pipeline yielded count data for 499 taxa across five levels of the microbiota phylogeny from phylum to genus (Extended Data Fig. 4a and 4b). Quality control on an individual level was performed by constructing an initial multi-dimensional scaling plot using Bray Curtis distances derived from the vegdist() function of the vegan package, and the argument method=”bray”, followed by a Kruskal’s nMDS using the function isoMDS() from the MASS package using rarefaction data from genera level counts. Two individual samples were identified as outliers in their genus-level microbiome profiles in this analysis (Supplementary Fig. 4), with the outlier cut-off set at greater than or less than five standard deviations (SDs) from the population mean of both nMDS axes. These two individuals were removed from all subsequent analysis including all association analyses.

In preparation for the association analysis, each abundance phenotype was rank normal transformed using the rntransform() function from the GenABEL35 package and fit to a multivariate linear model, using the function lm() from the stats package, with the following covariates: the extraction type (drill or cut), the extraction year, the aliquot year (for 16S rRNA sequencing), the person performing the aliquot, the library preparation plate, genotype derived principle components 1-10, genotype predicted sex, and age. Residuals from this model were extracted using the function residuals() from the stats package and used in univariate linear modeling in the association analysis with genotypes, details below. Shapiro-Wilk W statistics for the raw and residualized data distributions can be found in Tables S17–S18. Analysis and preparation of the microbial trait data was carried out in R version 3.4.1 “Single Candle”36.

To identify biological phenotypes that may be influenced by gut microbiome variation in the FGFP data set (generalized) linear models, as described above, where fit with age, sex, and the top ten principle components as covariates along with each of the microbial traits (MT) analysed in the GWAS (results not included, but available on request). Human phenotypes include blood lipids, glycemic traits, anthropomorphic traits, diet and Bristol stool score. To identify laboratory batch variables that may have influenced 16S microbiome variation, we set all available variables as dependent variables in univariate analysis, with each MT set as the response variable to identify those that should be included as covariates in the GWAS. Batch variables that exhibited independent effects on at least one MT are the extraction type (drill or cut), the extraction year, the aliquot year (for 16S rRNA sequencing), the person performing the aliquot, and the library preparation plate. Further information and results from these analyses can be found in Supplementary Information (Supplementary Fig. 5).

A total of 2646 FGFP individuals were processed on two different arrays - the Human Core Exome v1.0 (N = 576 samples) and the Human Core Exome v1.1 (N = 2112 samples), which included repeat measurements. Allele calling was performed using GenomeStudio v2.0.4 following manufacturers default recommendations. While running GenomeStudio Log R Ratio (LRR) and B Allele Frequency (BAF) statistics were also extracted for copy number variant (CNV) calling with PennCNV37. Unmapped and duplicate positions were removed, and the two batches were merged into a single data set resulting in 545,535 overlapping markers.

Copy number variants (CNVs) were called with PennCNV v1.0.437 using the perl script detect_cnv.pl. Cleaning was performed with the perl script clean_cnv.pl, and filtered with the script filter_cnv.pl using the flags --numsnp 5 --length 250 -qclrrsd 0.35 -qcnumcnv 716. Unique CNVs were defined by unique base pair start and stop locations. In total 35,020 unique CNVs were identified across the FGFP sample; 949 CNVs were shared across 1% or more individuals. Global CNV burden was estimated for each individual as the number of CNVs that do not equal the copy number count of 2. Insertions (>2) and deletions (<2) were treated the same. Regional CNV burden was calculated in sliding windows of 200 kilo-bases and estimated following the same rules as for global burden estimation.

Chip-based heritability was estimated for each microbiome presence/absence (62) abundance (92) and α-diversity metric (3) phenotype used in the association analysis, using the GCTA-GREML restricted maximum likelihood (REML) method, and a single genetic relationship matrix (GRM) as implemented in GCTA version 1.91.1beta43. The GREML power calculator was used to estimate the power to detect genetic covariation in the FGFP data set (Extended Data Fig. 7)44. For the abundance phenotypes, the residualized data used in the association analyses were used in the estimation of heritability. For binary phenotypes, the same covariates, mentioned above, were fit to the trait by GCTA. To produce the genetic relationship matrix (GRM) for running GCTA, we first identified all genotypes with an info (imputation quality) score greater than or equal to 0.9, a minor allele frequency greater than 0.05, and not deviating from Hardy-Weinberg equilibrium. Genotype probability score data was converted to hard call plink format data using qctools. SNP variation was linkage disequilibrium pruned using plink2 and the flag --indep-pairwise 50 5 0.45. Finally, the GRM was constructed using GCTA and the flags --grm-cutoff 0.025 --make-grm. In addition, for a more direct comparison with previously published studies7, we also performed box-cox transformations of the abundance phenotypes and regressed out our covariates.

Following genotype and microbiome QC, 2257 individuals remained, and 2223 remained after accounting for data missingness among covariates. All microbiome α-diversity, abundance and presence/absence associations analyses were performed using snptest.2.5.045. All abundance traits were regressed on covariates (the aliquoting procedure, the extraction year, the aliquot year (for 16S rRNA sequencing), the person performing the aliquot, the library preparation plate, genotype derived principle components 1-10, genotype predicted sex, and age) and residuals were regressed on genotype probability data in a univariate fashion, assuming an additive genetic model and using the missing data likelihood score test in snptest (snptest flags: -frequentist 1 -method score and -use_raw_phenotypes). Presence/absence mGWAS were performed using the same covariates as those described above for abundance traits in a multivariate analysis again using the same snptest settings. These primary analyses were performed as a first pass signal detection step in order to determine signals to take forward for meta-analysis and to confirm the ability of score analyses to effectively rank the expectation–maximization (em) method (Supplementary Fig. 8). Association analyses for enterotype were run using a multinomial logistic regression for categorical traits as employed by snptest.2.5.4-beta3 and the flags -frequentist add -method newml and setting the -baseline_phenotype to “Bacteroides1”. Finally, associations for β-diversity (a two axis MDS) were run using a bespoke R script and the function manova() from the stats package, in a multivariate analysis using the same covariates stated above and genotype dosages as derived by qctool v2.0. A flow chart of the mGWAS is provided in Extended Data Fig. 6b.

The FoCus11 and PopGen16 cohorts were genotyped using the Illumina Omni Express + Exome array and the Affymetrix Genome-Wide Human SNP Array 6.0, respectively. Genotyping QC and imputation in these two cohorts were performed following protocols defined here: https://github.com/alexa-kur/miQTL_cookbook#chapter-2-genotype-imputation. SNPs where filtered as a MAF of 0.01 and an INFO score of 0.3, as was done in the FGFP cohort. Microbiome census data for the Kiel based cohorts, targeting the 16S V1-V2 regions, was generated as described previously11. Data processing was performed using DADA215 modified for V1-V2 (https://github.com/mruehlemann/rep-cookbook/blob/master/scripts/Seq_dada2_V12_Kiel.R) following the same standardized workflow described in the above Microbiome trait preparation section. α- and β-diversity metrics, enterotypes, and abundance measures for association analysis were calculated as previously indicated. Three genera, Escherichia Shigella, Hespellia, and Methanobrevibacter were not present in the FoCus or PopGen cohorts (Supplementary Fig. 9). As such, in all three instances, their P/A and zero-truncated AB MTs were not available for association and inclusion in the meta-analysis. Association analyses were carried out as described below.

For the purposes of the meta-analysis, all outcomes were defined as described above in the “Primary FGFP association analysis” section, however, the expectation–maximization (em) method was used, rather than the score method, to account for genotype uncertainty and given the performance of “score” at low allele frequency and phenotype/trait group size (Supplementary Information).

Beta estimations (genotypic effects) for P/A traits are defined as an increase in the log odds ratio for each additional effect allele. For AB traits, beta is defined as a change in SD units for each effect allele carried. The study-wide p-value threshold was defined as a Bonferroni correction assuming 2 million independent genetic association tests across 159 mGWAS (0.05 / (2×1006 × 159) = 1.57×10-10).

Representative 16S rRNA gene sequences of all the genera identified were retrieved from the RDP database. Multiple sequence alignments were performed for all taxa and for genera included in the GWAS analyses using MUSCLE v.3.847. The alignments were used to build maximum likelihood trees using FastTree v2.1.048 with default parameters. iTOL49 was used for visualizing the trees with corresponding metadata, including the number of loci, prevalence of the MT, abundance of the MT and heritability of the AB and P/A trait(s) (Fig. 1 and Table S3).

Annotation of variants of interest was carried out with the biomaRt R package50 with additional linkage disequilibrium based annotation and enrichment analysis with DEPICT51. When using biomaRt, we referenced the (feb2014.archive.ensembl.org) Ensembl 75 archive for GRCh37/hg19 coordinates and identified all genes and the closest gene within 250 kilo-bases up- and down-stream of each polymorphism. Given that DEPICT utilizes pre-computed LD structure from genotypes derived from 1000 Genomes Project Phase 1 CEU, GBR and TSI and HapMap Project release 2 and 3 CEU data, a substantial proportion of our SNPs of interest were not represented. As such, we identified tag SNPs for our SNPs that are also present in the DEPICT data set, when possible. To do so, we extracted dosage data for all variants +/- 200kb of our variant, using qctools, and then computing r2 using a bespoke R script. We kept all variants with an r2 > 0.2 with our SNP of interest and then queried if any of those tag SNPs existed in the DEPICT data. If more than one was present, we kept the one with the highest r2 value. Subsequently, the list of reference SNP identifiers (rs-ids) composed of our SNPs of interest, when they existed in the DEPICT data, or alternatively tag SNPs, when they were present, were run through the DEPICT framework. Each MTs was run individually using FGFP variants associated at a threshold of 1×10-5. Results from these analyses, gene enrichment, tissue enrichment, and gene priority are available in Table S19, S20, S21, respectively.

Finally, variants with associations that met our study-wide and genome-wide confidence thresholds as well as those that may be deemed as replicated from other studies were passed through PhenoScanner V2, an online platform to screen for genotype-to-phenotype associations, expression quantitative loci, and methylation quantitative loci from previously published genome-wide -omics association analysis28. All of these results are provided in Table S11.

We undertook two-sample, bi-directional Mendelian randomization30 analyses to estimate potentially causal relationships between gut MTs and 11 metabolic health, inflammatory and neurological traits. These were selected a priori as they have all been repeatedly been associated with variation in the gut microbiome and have been the focus of credible and accessible GWAS studies. They include waist circumference, waist-hip ratio, BMI, and type 2 diabetes; Crohn’s disease, inflammatory bowel disease, ulcerative colitis and rheumatoid arthritis; and Alzheimer’s disease, Parkinson’s disease and major depressive disorder.

In analyses interrogating the impact of each continuous (AB) MT on each outcome, effect estimates represent the SD change for continuous outcomes (waist circumference, waist-to-hip ratio and BMI) or risk ratio for binary outcomes (type 2 diabetes, Crohn’s disease, inflammatory bowel disease, ulcerative colitis, Alzheimer’s disease, major depressive disorder, Parkinson’s disease and rheumatoid arthritis) for a SD unit of AB MT phenotype. For analyses interrogating the impact of each binary (P/A) MT on each outcome, effect estimates represent the SD change for continuous outcomes or risk ratio for binary outcomes for a doubling of the genetic liability to presence (vs. absence) of each P/A MT phenotype. Results reaching a p-value threshold of (p<0.05) are presented (Table 2).

A catalog of previously published associations was compiled starting from the work of Rothschild et al1, and includes Blekham et al8, Davenport et al9, Bonder et al10, Goodrich et al7, Turpin et al12, and Wang et al11. Data are available in Tables S1, S7, and S8 (Supplementary Figs. 10 and 11).

Author contributions

Competing interests

Authors declare no conflict of interest.

The full analysis pipeline is available at https://github.com/kul-fgfpgwas/rep-cookbook and includes four parts: (i) microbiome processing; (ii) genotype quality control and imputation; (iii) genome-wide association analysis and (iv) phylogenetic analysis.

All microbiome GWAS summary statistics are available online at the University of Bristol data repository, data.bris, at https://doi.org/10.5523/bris.22bqn399f9i432q56gt3wfhzlc. FGFP rarefaction count and transformed microbial trait data can be found in Supplementary Table 2. FGFP genotype data and host metadata from this study are not open but are available in accordance and in consent with ethical permission through managed access subject to a data use agreement with the Flemish Gut Flora Project and organised via Principal Investigator Jeroen Raes. The process of enquiry for data access is outlined as follows: Upon data request by email to eb.nevueluk@sear.neorej, the FGFP data access committee will evaluate access permission, which will be granted upon signature of a data use agreement between the governing legal entities. This is outlined on the study website http://www.raeslab.org/companion/fgfp-gwas/. Raw 16S data is available at the European Genome/Phenome Archive (https://ega-archive.org) under accession number EGAS00001004420. The datasets from Universitätsklinikums Schleswig-Holstein are available by application through their biobank (https://www.uksh.de/p2n/).

