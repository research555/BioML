Human gut microbiome aging clocks based on taxonomic and functional signatures through multi-view learning



The human gut microbiome is a complex ecosystem that is closely related to the aging process. However, there is currently no reliable method to make full use of the metagenomics data of the gut microbiome to determine the age of the host. In this study, we considered the influence of geographical factors on the gut microbiome, and a total of 2604 filtered metagenomics data from the gut microbiome were used to construct an age prediction model. Then, we developed an ensemble model with multiple heterogeneous algorithms and combined species and pathway profiles for multi-view learning. By integrating gut microbiome metagenomics data and adjusting host confounding factors, the model showed high accuracy (R2 = 0.599, mean absolute error = 8.33 years). Besides, we further interpreted the model and identify potential biomarkers for the aging process. Among these identified biomarkers, we found that Finegoldia magna, Bifidobacterium dentium, and Clostridium clostridioforme had increased abundance in the elderly. Moreover, the utilization of amino acids by the gut microbiome undergoes substantial changes with increasing age which have been reported as the risk factors for age-associated malnutrition and inflammation. This model will be helpful for the comprehensive utilization of multiple omics data, and will allow greater understanding of the interaction between microorganisms and age to realize the targeted intervention of aging.

In humans, aging is a continual and progressive process that results in decreased physiologic function across all organ systems. The gut microbiota is considered the most important symbiotic microecosystem, and has multiple functions in human health, including in digestion, immunity, metabolite production, and even neural function.1 Numerous cohort studies have implicated age as a dominant factor influencing the adult microbiome.2 Given the rapid increase in life expectancy and the increasing proportion of older adults, increased understanding of the biological mechanisms that underlie the gut microbiota–aging interactions implicated in the development of aging-related diseases is warranted. In line with this, the resolution of gut microbiome signatures will be invaluable for the development of noninvasive microbiome-based tests to determine signs of accelerated or delayed aging in the elderly, and to evaluate gut microbiota-based interventions to alleviate the aging-related diseases.

The aim of this study was to deliver a universal and reliable aging clock based on the functions and composition of the gut microflora. To this end, we used meta-analysis to rectify the problem of data heterogeneity between multiple metagenomic cohorts based on a large-scale dataset to effectively avoid the influence of host or technical factors. Moreover, we built multi-view learning models to integrate the taxonomic and metabolic pathways of the gut microbiota with the aim to establish the functional and mechanistic interpretations between the gut microbiota and age. Finally, we describe how the abundance and function of microbes affect age prediction, and how this knowledge can be used to identify potential biomarkers of intestinal aging. The results of this study will improve the understanding of the relationship between the gut microbiome and age, provide insights into a new aging-diagnosis strategy, and suggest potential intervention targets for future research.

A total of 4478 fecal samples were collected from 31 study cohorts covering 13 subregions (Figure 1a, Supplementary Table S1) that all samples from individuals with age were ≥ 18 years. Permutational multivariate analysis of variance (PERMANOVA) was performed to analyze the influence of age and other host-associated factors on the taxonomic and metabolic pathway profiles of the gut microbiome. Geographical factors, including country and subregion, had the largest interaction with gut microbiome composition and function, followed by Westernization and age (Figure 2b). Collectively, these results showed that age was a major factor responsible for the significant difference in the adult gut microbiome (adjusted for DNA extraction kit and sequencing platform; Bonferroni-corrected p < .001).

We combined two methods to reduce the correlation between geographic location and age to avoid age–regional distribution problems. We first grouped countries into different subregion-level bins based on geographic location; this ensured that, after decrease regions with special distributions, still maintain most samples. After clustering, the subregional factor was still an important factor affecting the species and pathways of the gut microbiome (Figure 2b). And there was still a certain relevance at the subregion level (LR, 0.016 ± 0.007; RF, 0.110 ± 0.019). Therefore, we next screened each dataset on the basis of the clustering result. To ensure statistical power, subregion-level bins with sample sizes > 200 were considered for subsequent analysis. The RF model was used to further judge the strength of the association between subregion and age factors using the feature importance score to sequentially remove the subregion bin that most related to age (Figure 2d). Finally, we identified a subset of subregions that had no obvious correlation with age (R2 < 0.01; Figure 2e), including Eastern Asia (EA), Northern America (NA), Northern Europe (NE) and Southern Europe (SE). We evaluated the relevance of this subset on different machine learning algorithms (figure 2f). In all models, the screened data subsets effectively avoided the distribution problem compared to the country level (both R2 < 0.01).

The diversity of the base regressor was necessary to achieve an effective model ensemble as heterogeneous algorithms were expected to obtain more diversity, so as to reduce deviation through integration.13 Thus, we performed a systematic evaluation of different machine learning algorithms on the adjusted dataset (2604 samples total; all individuals in the dataset were between 18 and 107 years old, with a median age of 52 years).

Additionally, we compared the influence of the extra subregion label feature on model performance based on the filtered data (Figure 3c). The tree-based methods (RF, GBRT, XGB, XGBRF, and LGB) were more sensitive to the additional feature, and the results demonstrated that subregion information can significantly improve model performance.

To construct a highly precise age regression model based on gut microbiome metagenomics data and improve data utilization, we further considered the composition of the metabolic pathways of the flora in addition to the previously mentioned taxonomic profiles. Moreover, a systematic evaluation of different machine learning algorithms was conducted on the metabolic pathway annotation results.

We next implemented the same feature selection strategy and the GBRT-based selection method has the least feature dimension without affecting the predictive performance of each model (Figure 4b, Supplementary Table S3). Thus, the GBRT-selected data were used for the subsequent model ensemble. We next compared the impact of an extra geographical feature on the model performance based on the screened data (Figure 4c). Similar to the phenomenon of species modeling, the tree-based methods were easier to learn the influence of subregion characteristics. In contrast, the geographic factors showed higher performance gains in the pathway modeling process.

We next examined whether the fusion of multiple models can improve the prediction accuracy compared to a single model. To this end, nine pre-verified regression methods (Lasso, EN, BR, SVM, RF, GBRT, XGB, XGBRF and LGB) were applied to construct the ensemble model and LR was used as the weight learning algorithm of the generalizer. First, we compared the predictive accuracy of the single and ensemble algorithm with multiple data types (modeling using species set and pathway set respectively, and modeling using multiple datasets). To evaluate the performance, the LGB that showed the highest accuracy on both datasets was decided as the benchmark for the comparison. The result has shown that the ensemble method can significantly improve prediction accuracy in all data types, which emphasizes that the method was feasible (Figure 5a). Moreover, the result of multiple sets shows that the multi-view-based approach can further improve the performance.

We also tested dissimilar weights learning methods and judged the changes to the ensemble effect. The simple average (SA) result was used as the baseline for different weighting methods and the non-ensemble tree model was considered as the potential generalizer, including LR, Lasso, BR, SVM with linear kernel (LSVM), and SVM with non-linear kernel (SVM). The rationale behind this was to avoid overfitting of complex models in the generalization process and resulting in performance loss. We observed that the basic linear models (LR, Lasso, BR, LSVM and SVM) were able to obtain the ideal integration effect compared with the SA, and there was no significant difference between these methods (Figure 5c). It was noteworthy that the DT experienced severe performance degradation, with performance lower than the benchmark, which implies that the DT may have a serious overfitting problem. Combining the above results, we determined the simplest LR algorithm as the generalizer of the ensemble model, following which, basic learners can obtain an ideal performance. Our ensemble model demonstrated a stable predictive effect across all age ranges, with no abnormal prediction bias in any specific age range (Figure 5d).

We next sought to interpret the ensemble model to identify the age-related features included species and pathway two aspects. The permutation feature importance (PFI) method was used to investigate the relationship between individual features and aging. We obtained a set of biomarkers that were significantly related to the aging process (Figure 6a). Among them, the species and pathways of the gut microbiome showed a different extent of influence on age prediction. We observed that a total of 102 microbial species and 41 metabolic pathways had a significant impact on age prediction (Supplementary Table S4). The most predictive factors were acetyl-CoA biosynthesis, nicotinate degradation and Finegoldia magna. The remaining factors included taxadiene biosynthesis, Streptococcus thermophilus, Prevotella copri, hexitol fermentation, Bifidobacterium dentium and Streptococcus infants.

Among these identified biomarkers, we found that many of the species and pathways showed specific trends with age. For example, F. magna, B. dentium, and Clostridium clostridioforme had increased abundance in the elderly, while P. copri and Burkholderialse bacterium 1_1_47 decreased in abundance with age (Figure 6b). Similar age distribution characteristics were observed in metabolic pathways; acetyl-CoA biosynthesis, nicotinate degradation and L-leucine degradation had a higher probability of enrichment in the gut with increasing age. In contrast, taxadiene biosynthesis, tRNA processing and L-isoleucine biosynthesis had a high possibility of function loss with increasing age (Figure 6c).

The development of machine learning algorithms has provided new opportunities for comprehensive and in-depth analysis of gut microbiome data, and has allowed us to associate the complex species and pathway composition of microorganisms with host states. In this study, we constructed and evaluated a novel ensemble modeling framework for universal age regression using a large-scale collection of metagenomic sequencing data of more than 2500 gut microbiomes. Our ensemble model achieved better prediction accuracy and higher data utilization capabilities than the currently used methods. It is worth noting that our study is unique in that we not only corrected the influence of location factors on the host flora, but we also integrated heterogeneity algorithms and multi-view learning in the field of gut microbiome research.

The current study consists of a multi-view data-adapted ensemble machine learning framework. Through the integration of heterogeneous models and data, we observed broad patterns of gut microbiome changes in aging and clarified the impact of the species and functions in this process. Future studies should focus on further improving the collection of big data on the gut microbiome. Although we have removed some host confounding factors in this study, more high-quality and diverse data are necessary to explore the in-depth associations between gut bacteria and age. The machine learning framework should also be improved. Indeed, new algorithms are constantly being proposed, especially neural network models, which have shown considerable predictive potential in other fields.36 Through improvements in methods, it will be possible to extend data to ensure the reliability of the conclusion and maximize its utility.

The data used in this analysis comes from a pre-processed public metagenome data from curatedMetagenomicData.37 We first selected stool samples and subsequently removed the samples that contained incorrectly annotated information. From these datasets, we deleted samples having age less than 18 years of age, a total of 4478 stool samples from 31 cohorts are included in this study (Supplemental Table S1).

In order to explore the impact of metadata between different datasets, we considered the reliable and non-redundant metadata which is defined as missing values is less than 40% and not associated with existing metadata (E.g. Age and Age-category), and finally 7 metadata remained, divided into 5 covariates (non-westernized, age, gender, country, and BMI) and 2 confounding factors (sequencing platform, DNA extraction kit). And for subsequent data analysis, we regrouped country into subregion level (based on United Nations subregions, standard country or area codes for statistical use, M49).

To filter a subset which was no correlation between geographical and age, we first constructed a random forest age prediction model based on full subregion labels (encode by sklearn OneHotEncoder). Next, we removed the corresponding subregion data in descending order of feature importance score until one area remained. In each epoch, a random forest model was constructed with screened data, and 10 times 5-fold cross-validation was used to judge the association.

To achieve an effective model ensemble, heterogeneous machine regression models were constructed, including Linear Regression (LR), Lasso, Elastic Net (EN), Bayesian Ridge (BR), Support Vector Machine (SVM), Decision Tree (DT), Random Forest (RF), Gradient Boosted Regression Trees (GBRT), eXtreme Gradient Boosting (XGB) and LightGBM (LGB). Before construct machine learning models, the zeros in species and pathway profiles were replaced with a very small number to suit logarithmic conversions (using the multiplicative_replacement function implemented in scikit-bio, http://scikit-bio.org/). Next, use the centered log-ratio (CLR, using the clr function implemented in scikit-bio) to transform the preprocessed profiles.

For each algorithm, built regression model based on species and metabolic pathway data. 10 times 5-fold cross-validation was performed to avoid random errors, R2 and mean absolute error (MAE) were used as the performance evaluation metrics. Among them, LR, Lasso, EN, BR, SVM, DT, RF and GBRT models are constructed using packages of the scikit-learn,38 XGB and XGBRF are constructed using xgboost package39 and LGB model is constructed using lightgbm package.40

Feature selection was performed to improve prediction accuracy and decrease feature dimension which helped to reduce the computational cost, contain Univariate linear regression tests (f_regression, FR), Mutual information estimation and model-based selection method (RF, GBRT, XGB, XGBRF and LGB). For each feature selection method, the filtered data was applied to each regressor with 10 times 5-fold cross-validation to avoid random errors, and the average R2 score was used as an evaluation indicator. We next used paired Wilcoxon rank-sum test to compare the performance changes between the original features and the filtered features, and the p-value was corrected by Bonferroni.

The feature selection method was evaluated by the number of models that performance was significantly different after selection, the method with the least number of models with the lowest performance degradation is the optimal algorithm. In the case of multiple methods with the same counts, the number of models with the performance increase and the feature dimension as the secondary screening basis.

A stacking ensemble strategy was utilized to construct a powerful meta-learner and the stacking process includes two stages. In the first stage (Figure 1a), the training set is randomly split into k-fold (5-fold was used in this study). Used four of the subsets to construct machine learning model, and the rest as the validation set, repeat the above process until all the subsets are traversed. Finally, we obtain a predicted value dataset corresponding to the entire training set named “Predicted Training Set”. Simultaneously, we get five prediction outcomes by test sets, calculate the mean of the result and named “Predicted Test Set”.

For multi-view learning, the integration of different data types was performed in the second stage. After performed the training of each model in the first stage on different types of datasets and obtained their predicted training set. Next concatenated each set to obtain the merged set for weights learning and perform the same process as mentioned above.

After constructed the ensemble model, in order to determine the importance of each feature in the prediction process, the permutation feature importance (PFI) was used to measure individual feature importance which evaluates by eliminating a single feature (randomly shuffle the feature 50 times) to calculate the extent of change in the prediction effect (R2 score reduction as the metric and the feature which has a positive effect of R2 score was not considered). Based on multiple repeated calculation results, paired Wilcoxon rank-sum test was used to compare the prediction performance with the original model which without feature replacement. Features that are significantly different from baseline data are considered as potential biomarkers and ranked by the extent of influence on the prediction performance. Furthermore, Spearman’s rho test was applied to judge the association between the biomarkers and age. All p-values were Bonferroni-corrected.

The data presented in this study are are available in GitHub: https://github.com/hcwang-jn/gut-ensemble

Yutao Chen and Hongchao Wang: Conceptualization, Methodology, Software, Validation, Formal analysis, Writing – original draft. Wenwei Lu: Investigation, Conceptualization, Methodology, Writing – original draft. Tong Wu and Weiwei Yuan: Investigation, Formal analysis. Jinlin Zhu: Investigation, Methodology, Formal analysis. Yuan Kun LEE, Jianxin Zhao, Hao Zhang and Wei Chen: Supervision, writing – review & editing.

No potential conflict of interest was reported by the author(s).

Supplemental data for this article can be accessed on the publisher’s website

