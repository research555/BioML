Gut metabolites predict Clostridioides difficile recurrence

Clostridioides difficile infection (CDI) is the most common hospital acquired infection in the USA, with recurrence rates > 15%. Although primary CDI has been extensively linked to gut microbial dysbiosis, less is known about the factors that promote or mitigate recurrence. Moreover, previous studies have not shown that microbial abundances in the gut measured by 16S rRNA amplicon sequencing alone can accurately predict CDI recurrence.

We conducted a prospective, longitudinal study of 53 non-immunocompromised participants with primary CDI. Stool sample collection began pre-CDI antibiotic treatment at the time of diagnosis, and continued up to 8 weeks post-antibiotic treatment, with weekly or twice weekly collections. Samples were analyzed using (1) 16S rRNA amplicon sequencing, (2) liquid chromatography/mass-spectrometry metabolomics measuring 1387 annotated metabolites, and (3) short-chain fatty acid profiling. The amplicon sequencing data showed significantly delayed recovery of microbial diversity in recurrent participants, and depletion of key anaerobic taxa at multiple time-points, including Clostridium cluster XIVa and IV taxa. The metabolomic data also showed delayed recovery in recurrent participants, and moreover mapped to pathways suggesting distinct functional abnormalities in the microbiome or host, such as decreased microbial deconjugation activity, lowered levels of endocannabinoids, and elevated markers of host cell damage. Further, using predictive statistical/machine learning models, we demonstrated that the metabolomic data, but not the other data sources, can accurately predict future recurrence at 1 week (AUC 0.77 [0.71, 0.86; 95% interval]) and 2 weeks (AUC 0.77 [0.69, 0.85; 95% interval]) post-treatment for primary CDI.

The prospective, longitudinal, and multi-omic nature of our CDI recurrence study allowed us to uncover previously unrecognized dynamics in the microbiome and host presaging recurrence, and, in particular, to elucidate changes in the understudied gut metabolome. Moreover, we demonstrated that a small set of metabolites can accurately predict future recurrence. Our findings have implications for development of diagnostic tests and treatments that could ultimately short-circuit the cycle of CDI recurrence, by providing candidate metabolic biomarkers for diagnostics development, as well as offering insights into the complex microbial and metabolic alterations that are protective or permissive for recurrence.

Video Abstract video file.(99M, mp4)

The online version contains supplementary material available at 10.1186/s40168-022-01284-1.

Clostridioides difficile infection (CDI) is the most common cause of healthcare associated infection in the USA, with symptoms ranging from diarrhea to life-threating fulminant colitis [1]. Annually in the USA, there are > 460 K CDI cases and > 30 K deaths, with costs to the health care system estimated at > $4.8 billion [2]. CDI recurrence after initial infection is common, with an estimated overall 15.5% rate of first recurrence, and escalating recurrence risk with each subsequent episode [2, 3]. Clostridioides difficile is a Gram positive, anaerobic spore-forming bacteria that can colonize the gut asymptomatically, with estimates of asymptomatic colonization up to 17% of healthy adults in the community and 50% of hospital patients [1, 4]. Toxigenic strains of C. difficile can release endotoxins that bind to intestinal epithelial cells to cause cell death and severe inflammation [4, 5]. However, even toxigenic strains have been found to colonize asymptomatically, and dysbiosis of the microbiome is critical for CDI to occur [4]. Indeed, antibiotic exposure, particularly with drugs that deplete gut anaerobes, is a major risk factor for development of CDI [6, 7].

To address the gaps in prior studies, including cross-sectional analyses, lack of metabolomic data, and potentially confounding comorbidities or antibiotic use, we conducted a prospective, longitudinal study of participants recruited consecutively from the inpatient service at the Brigham and Women’s Hospital (BWH) and two affiliated hospitals. Exclusion criteria included inflammatory bowel disease, inherited or acquired immunodeficiencies, severe or fulminant CDI, or ongoing non-CDI antibiotic use that continued past the CDI antibiotic course. Participants were followed for up to 8 weeks after completion of their CDI antibiotic treatment or until recurrence. We previously reported an analysis of the clinical and demographic characteristics of the full cohort of 75 participants, 22 of whom experienced recurrent CDI [23]. In the present study, we report on detailed multi-omic analyses of serial stool samples from 53 participants (with 19 recurrences) from the parent study, using broad LC/MS metabolomic profiling, 16S rRNA amplicon sequencing, and targeted short-chain-fatty-acid (SCFA) analysis. We use univariate and multivariate statistical techniques to investigate how microbial composition and metabolomes of recurrers vs. non-recurrers changed and diverged over time. Further, we use cross-validated machine learning/statistical methods to quantify the capability of the data sources to predict future recurrences.

We performed multi-omic analyses on serial fecal samples (Fig.
1) from 53 subjects who had participated in a parent prospective, longitudinal study of CDI at Brigham and Women’s Hospital (BWH) and two affiliated hospitals [23]. In the parent study, fecal samples were collected at the time of diagnosis (if available), 1 week after antibiotic treatment, and every week or half week for up to 8 weeks. Participants for the multi-omic study were chosen from the parent study based on the availability of a week 1 stool sample, a desired ratio of approximately 2:1 non-recurrers to recurrers to sufficiently power predictive analyses while maximizing study resources, and age and sex matching between non-recurrers and recurrers. This yielded a cohort of 34 non-recurrent and 19 recurrent participants for the multi-omic study. Table
1 provides demographic and clinical data for this cohort. Comorbidities for participants are provided in Additional file 1. The only demographic or clinical variable found to be significantly associated with CDI recurrence was the use of enzyme immunoassay (EIA) testing vs. PCR for initial CDI diagnosis (p = 0.046). This finding is consistent with analyses of the parent study, and may be due to higher-false positive rates or detection of non-toxin elaborating C. difficile strains with the PCR test. The parent study also found treatment of initial CDI with metronidazole versus vancomycin to be associated with recurrence; this association was only borderline significant (p = 0.12) in the subset of patients analyzed for our multi-omic study, likely due to the smaller sample size. Note that while the parent study found a significant association between platelet count and CDI recurrence, we were not able to analyze this variable for the subset of participants in our multi-omic study, due to missing blood work data in > 25% of these participants.

Table
2 provides a summary of the fecal samples analyzed. Because all participants who recurred did so within the first 3 weeks after initial treatment, we focused our subsequent analyses primarily on data-points prior to week 3. This time window provides a sufficient number of recurrent samples for statistical testing and also, in the context of developing diagnostic testing in the future, represents a relevant time period for clinically actionable decision-making. Each sample was analyzed with (1) 16S rRNA amplicon sequencing, (2) liquid-chromatography/mass-spectrometry (LC/MS) untargeted metabolomics, and (3) targeted short chain fatty acid (SCFA) analyses. For amplicon analyses, this yielded 4,605,740 total sequencing reads (average of ~ 10 K/reads per sample) and subsequent bioinformatic processing with dada2 produced 2509 unique amplicon sequence variants (ASVs). The LC/MS untargeted metabolomics platform quantified 1387 unique and annotated metabolites. SCFA analyses quantified nine metabolites: acetate, propionate, isobutyrate, butyrate, isovalerate/2-methylbutyrate (indistinguishable by the platform used), valerate, isocaproate, caproate, and heptanoate. However, heptanoate and caproate were only present in one or two samples, respectively, and were thus removed from subsequent analyses.

To gain high-level insights into the structure of microbiomes, we assessed their overall ecological diversity using alpha [26] and beta diversity measures [27]. For more detailed understanding of microbiomes, we analyzed taxonomic composition at the level of amplicon sequence variants (ASVs). After filtering low abundance/rare taxa, we obtained 237 ASVs, which we used for subsequent DESeq2 fold-change analyses [28]. Because participants received treatment for initial CDI with either vancomycin or metronidazole, and these antibiotics are known to have differential effects on the gut microbiome, we included terms in DESeq regression models to account for the antibiotic type used, and report only changes that remained significant when controlling for the antibiotic type. For analyses at both the level of ecological diversity and at the level of ASVs, we performed both intra-group (i.e., differences in diversity or abundance of ASVs between time-points within the same group, either non-recurrers or recurrers) and inter-group (differences in diversity or abundance of ASVs between non-recurrers and recurrers).

Finally, we assessed inter-group differences in ASV composition, comparing between non-recurrers and recurrers at pre-CDI treatment, week 1, or week 2 post-CDI treatment. This analysis showed that non-recurrers had significantly higher abundances of 10 ASVs pre-CDI treatment, 15 ASVs at week 1 post-CDI treatment, and 35 ASVs at week 2 (Fig.
3A; Additional file 3). The set of ASVs at increased abundance at week 2 was significantly enriched for taxa in the Bacteroidaceae (FDR = 0.03), Ruminococcaceae (FDR = 0.03), and Lachnospiraceae (FDR = 0.03) families (Additional file 4). Many of the taxa in these families found to be significantly increased in non-recurrers have been associated with normal microbiome function, including Clostridium cluster XIVa taxa (ASVs 90, 97, 99, 198, 214) within the Lachnospiraceae family and Clostridium cluster IV taxa (ASVs 59, 60, 62, 66) within the Ruminococcaceae family [29] (Additional file 3). Interestingly, one of the Clostridium cluster XIVa taxa at higher abundance in non-recurrers (significant at week 2 and with a trend toward higher abundance at other time-points) was Clostridium scindens (ASV 99), which has been shown to provide host resistance to C. difficile [12, 13]. A number of the other genera found to be at higher abundance in non-recurrers have been previously linked to protection against CDI in human studies, including Bacteroides (ASVs 26, 28, 29, 32, 33, 34) and Veillonella (ASV 154) [20, 30]. Taken together, these intra- and inter-group comparisons of taxa abundances suggest a picture of broader depletions of the normal microbiome in recurrers, evident even pre-CDI antibiotic treatment, but with increasingly more pronounced differences over time, consistent with slower recovery of recurrers’ microbiomes.

We first performed ordination analyses to evaluate overall changes and differences in broad gut metabolomic profiles between recurrers and non-recurrers (Fig. S2). Paralleling our findings on changes in microbial diversity, ordination analyses on metabolomic data (760 metabolites after filtering) showed that the metabolomes of non-recurrers changed significantly from pre-CDI treatment to week 1 post-CDI treatment (p = 10−3), and from week 1 to week 2 post-CDI treatment (p = 10−3), but the metabolomes of recurrers only changed significantly from pre-CDI treatment to week 1 post-CDI treatment (p = 10−3) (Additional file 2). Comparing recurrers to non-recurrers at each time-point, differences were only significant at week 2 (p = 0.001), which recapitulated our findings in microbiome alpha diversity (Additional file 2). Taken together, we saw parallel patterns for overall gut metabolomic profiles and microbial diversity, with recurrers and non-recurrers initially exhibiting similar gut metabolomes that only significantly diverged by week 2 post-CDI antibiotic treatment, due to a slower recovery in the recurrent group.

At week 2, levels of metabolites involved in host immune or inflammatory modulation, predominately conjugated anti-inflammatory compounds and endocannabinoids, also differed significantly between recurrers and non-recurrers. The observed lower levels of conjugated corticosteroids in non-recurrers not only indicates greater microbial deconjugation activities, but may also indicate increased host anti-inflammatory activity: unconjugated corticosteroids, such as tetrahydrocorticosterone, are key anti-inflammatory compounds, and unconjugated sex steroids have also been shown to act as important modulators of inflammation in the gut [33, 37]. Other conjugated compounds found to be significantly higher in recurrers, specifically glucuronides of piperine, salicyluric glucuronide, and apigenin sulfate, have also been shown to have unconjugated forms with anti-inflammatory effects [38–41]. Levels of the endocannabinoids behenoyl ethanolamide (FDR = 5×10−4) and lignoceroyl ethanolamide (FDR = 0.04) were significantly lower in recurrers. Endocannabinoids have been shown to maintain gut homeostasis through modulating the immune system and gut motility; additionally, endocannabinoids have been found to increase in the presence of Akkermansia muciniphila, a taxa we found to be significantly more abundant in non-recurrers at week 2 (ASV 9, FDR = 2 × 10−19) [42–44]. Taken together, these results suggest a picture of reduced capability to modulate inflammation in recurrers.

To estimate how well our data can predict CDI recurrence in patients, we built supervised machine learning/statistical models and evaluated them using cross-validation. This approach fundamentally differs from the univariate statistical tests presented in the previous sections in two ways: (1) univariate approaches evaluate one variable at a time, and thus cannot find combined effects (e.g., increased risk if multiple metabolites are elevated), and (2) statistical testing approaches cannot provide an estimate of predictive accuracy, or how well the model might perform on unseen data. Both these capabilities are necessary for developing a clinically useful diagnostic, which is an important objective in the field. For prediction tasks, we evaluated three standard methods: lasso-logistic regression (LR), random forests (RF), and lasso-Cox regression (CR). The first two methods predict binary outcomes (recurrence or non-recurrence), whereas CR predicts the time to recurrence. We evaluated these methods based on their ability to predict outcomes using a cross-validation methodology (training the models on subsets of the data and predicting on held-out data). For the two methods predicting binary outcomes, we used the area under the receiver operator curve (AUC) score as the evaluation metric, and for CR we used the concordance index (CI).

To determine which metabolites were predictive in models with median AUCs > 0.7, we assessed cross-validated odds ratios and Gini feature importance measures. At week 1, LR, RF, and CR all selected N-carbamoylaspartate and vanillylmandelate as the top predictors, both of which favored recurrence when at higher levels (Fig.
5). Of note, these metabolites were also found in univariate analysis to be borderline-significantly increased in recurrers at week 1. At week 2, RF robustly identified lignoceroyl sphingomyelin as an important feature; this metabolite was also found to be significantly more abundant in recurrers in univariate analyses. RF also identified features with borderline significance that were found in the univariate analyses, including sphingomyelins, primary bile acids, and a phosphorylated lipid (Fig.
5). The predictive models also identified features that were not detected in univariate analyses: 4-hydroxyhippurate and bilirubin in the week 1 LR model were identified as predictive of recurrence when at higher levels. 4-hydroxyhippurate is a product of microbial degradation of polyphenols found in fruits and other plant-based foods [45]. Bilirubin is the product of host heme catabolism and is further reduced to urobilinoids/urobilinogens by the gut microbiome, so its higher levels in recurrers’ gut metabolomes is consistent with subpar microbiome function [36]. Because the predictive methods employed make different underlying assumptions (e.g., logistic regression is a generalized linear model whereas random forests is a nonlinear model), metabolites selected by multiple models are more likely to be robust [46]. Thus, the set of predictive metabolites identified by multiple methods (Fig.
5) may serve as strong candidates for future trials to validate biomarkers for recurrence prediction in larger, independent cohorts.

To our knowledge, our work represents the largest prospective study of CDI recurrence employing both microbiome sequencing and untargeted metabolomics analyses. Although prior studies have investigated some aspects of the relationship between the microbiome and CDI, our study design and analysis methods allowed us to probe further. The longitudinal nature of our study allowed us to investigate how rates of microbiome recovery relate to recurrence. Past studies investigating CDI recurrence were unable to observe the marked divergence of microbial diversity between recurrers and non-recurrers shortly after antibiotic treatment due to either a cross-sectional study design or a lack of systematic longitudinal sampling [15, 18–20]. Seekatz et al., though longitudinal, did not sample at the same timepoints for all participants; thus, although they noted that the alpha diversity of recurrers’ microbiomes trended lower than that of non-recurrers, they could not evaluate dynamic changes in alpha diversity within each group during the specific time-windows of interest [19]. Additionally, the prospective nature of our study allowed us to build predictive models of CDI recurrence, which are not possible with cross-sectional designs.

Thus, follow up, multi-institutional studies that assess larger and more diverse cohorts receiving uniform vancomycin treatment for initial CDI, as well as integration of C. difficile genome analysis data will be important to generalize our findings. Another interesting question, which could not be addressed with our study design, is whether metabolite biomarkers reflect gut pathology that is permissive for CDI versus very early damage caused by CDI prior to the onset of symptoms. Ultimately, the true clinical value of CDI predictors, such as the metabolite biomarkers found in our study, will need to be assessed in the context of their utility for informing early interventions that significantly lower recurrence rates.

We found in our prospective, longitudinal, multi-omic study of CDI recurrence that the gut microbial compositions and metabolomes of participants, while similar immediately before and after initial treatment, diverged rapidly as non-recurrers recovered normal microbiota and metabolic functions and recurrers remained dysbiotic. Our analyses uncovered specific metabolic derangements in participants who experienced subsequent recurrence, including evidence of loss of normal metabolic activities of the gut microbiome, host gut inflammation and cell death, and decreases in anti-inflammatory and immune-modulating compounds. Moreover, we found that differences in specific metabolites in the first 2 weeks post-CDI antibiotic treatment accurately predicted future recurrence, while microbiome sequencing data did not yield high predictive accuracy. These results suggest that metabolomics may be the more robust modality for evaluating recovery of microbial function. By providing specific candidate predictive biomarkers and expanding our knowledge of the complex metabolic changes preceding recurrence, our findings have implications for development of diagnostic tests and treatments for CDI recurrence.

Fecal samples analyzed for the present multi-omic study were collected as part of a larger prospective parent study that was conducted to assess predictors of CDI recurrence [23]. Participants with primary, uncomplicated CDI were identified by positive test results from the Brigham and Women’s Hospital (BWH) Clinical Microbiology Laboratory and recruited consecutively from BWH’s inpatient service, as well as two affiliated hospitals, between August 1, 2015 and September 1, 2018. Participants who were being treated for primary CDI, diagnosed with diarrhea symptoms and a positive C. difficile test by either glutamate dehydrogenase (GDH) or enzyme immunoassay (EIA) toxin or polymerase chain reaction (PCR), were eligible for inclusion. Primary CDI was defined as no episodes of CDI within the past 6 months. Exclusion criteria included inflammatory bowel disease, inherited or acquired immunodeficiencies, severe or fulminant CDI as defined by [49], or ongoing non-CDI antibiotic use that continued past the CDI antibiotic course.

Participants for the multi-omic study were chosen from the parent study based on the availability of a week 1 stool sample, a desired ratio of approximately 2:1 non-recurrers to recurrers to sufficiently power predictive analyses while maximizing study resources, and age and sex matching between non-recurrers and recurrers. This yielded a cohort of 34 non-recurrent and 19 recurrent participants for the multi-omic study. Because all participants recurred before week 4, samples after week 4 were not analyzed.

Weight and height were collected individually and used to calculate participants’ BMI. Significance testing for demographic and clinical variables was conducted using Fisher’s exact test for binary variables, the chi-squared test for categorical variables, and the Wilcoxon-rank-sum test for continuous variables. To ensure a sufficient number of participants for valid statistical inference, significance testing was only performed on demographic/clinical variables if greater than 3 participants had the characteristic of interest.

For DNA extraction, all fecal samples were processed with the Zymo Research ZymoBIOMICS DNA 96-well kit according to manufacturer instructions with the addition of bead beating for 20 min. The extracted DNA was used for 16S rRNA gene Amplicon sequencing and 16S rRNA qPCR for total bacterial concentration estimation. Amplicon sequencing of the v4 region of the 16S rRNA gene was performed using the previously described protocol in [50] using 515F and 806R primers for PCR along with:

LC-MS untargeted metabolomics was performed by Metabolon (Durham, NC USA). After delivery to Metabolon, samples were homogenized in methanol to extract metabolites and then centrifuged to separate the supernatant from debris and precipitates. The supernatant was divided into five aliquots for four analyses plus one extra and then dried using a TurboVap (Zymark). Dried samples were stored overnight under nitrogen gas. Samples were reconstituted and measured with Waters ACQUITY ultra-performance liquid chromatography (UPLC) and Thermo Scientific Q-Exactive high resolution/accurate mass spectrometry (MS), heated electrospray ionization source (HESI-II) and Orbitrap pass analyzer (35,000 mass resolution). Samples were analyzed in the following four different ways: (1) elution with C18 column (Waters UPLC BEH C18-2.1 × 100 mm, 1.7 μm) in positive-ion mode with water/methanol gradient mobile phase containing 0.05% perfluorpentanoic acid (PFPA) and 0.1% formic acid (FA), (2) as in (1), except with water/acetonitrile/methanol gradient mobile phase containing 0.05% PFPA and 0.01% FA, (3) elution with a separate C18 column in negative-ion mode with water/methanol gradient mobile phase containing 6.5 mM ammonium bicarbonate, pH 8, and (4) elution with HILIC column (Waters UPLC BEH amide 2.1 × 150 mm, 1.7 μm) in negative-ion mode with water/acetonitrile gradient mobile phase containing 10 mM ammonium formate, pH 10.8. The MS analysis was performed as dynamic exclusion, altering between MS and data-dependent MSn scans with a scan range of 70–1000 m/z. Data extraction, peak identification, quality control, and annotation were performed by Metabolon’s proprietary software.

Volatile SCFAs were quantified as described in [51]. Acidified internal standards with 100uL of either ethyl anhydrous or boron trifluoride-methanol was added to 100 μL of supernatant from homogenized cecal contents. Chromatographic analyses were carried out on an Agilent 7890B system with a flame ionization detector (FID). Chromatogram and data integration were done using the OpenLab ChemStation software (Agilent Technologies, Santa Clara, CA). SCFAs were identified by comparing their specific retention times relative to the retention time in the standard mix. Concentrations were determined as mM of each SCFA per gram of sample for the raw cecal/fecal material. The Agilent platform cannot discriminate between isovalerate and 2-methylbutyrate, and so these are reported as a single peak value.

Sequencing generated 4,605,740 total reads and 97,994 average reads per sample. The paired-end Fastq files were truncated, filtered, denoised, and merged using the dada2 pipeline and filtering parameters identical to the dada2 tutorial [52]. Our analysis found 2509 unique amplicon sequencing variants (ASVs) in the dataset, and taxonomy was assigned using the dada2 RDP and Silva reference databases [53, 54]. If taxa assignments between the two databases disagreed, the taxa assignment from the RDP database was used.

Prior to calculating alpha and beta diversity, relative ASV abundance was calculated by dividing each ASV’s counts by the total number of counts in a sample. Using ASV relative abundance, we calculated the alpha diversity (Chao1) at pre-treatment, week 1, week 2, week 3, and week 4 using scikit-bio (skbio.diversity.alpha.chao1) [26]. Significant differences in intra-group alpha diversity over time and inter-group alpha diversity at pre-treatment, week 1, and week 2 were tested using the Mann-Whitney U test. A one-sided test was used to test the hypothesis that alpha diversity of both groups decreased during antibiotic treatment and then recovered, and the hypothesis that non-recurrent participants would have higher alpha diversity. Beta diversity was calculated at pre-treatment, week 1, week 2, week 3, and week 4 from the Bray-Curtis dissimilarities (calculated using scipy.spatial.distance.pdist) of relative ASV abundances between each subject. To visualize the dissimilarity of outcome groups at each timepoint and the intra-group dissimilarity between timepoints, we performed multi-dimensional scaling (using scikit-learn.manifold.MDS) on the Bray-Curtis dissimilarities. We used permutational multivariate analysis of variance (PERMANOVA) (skbio.stats.distance.permanova) with 999 permutations to assess the significance of inter- and intra-group dissimilarities at pre-treatment, week 1, and week 2.

Prior to differential abundance analysis, ASVs were filtered to remove rare taxa. We included ASVs present with > 10 counts and in ≥ 10% of participants in either pre-treatment, week 1, or week 2. This resulted in 237 ASVs post-filtering.

After filtering, differential abundance analyses between recurrers and non-recurrers at pre-treatment, week 1, and week 2 were performed using the DESeq function within the DESeq2 package [55]. To control for effects of CDI treatment with either vancomycin or metronidazole, antibiotic treatment type was included as a covariate in the regression equation for inter-group analyses at week 1 and week 2. Because every ASV in the dataset contained zeros, we pre-computed the geometric means and then the size factors using the estimateSizeFactors function within DESeq2. Intra-group differential abundance analysis was also performed between pre-treatment and week 1, and between week 1 and week 2, for both recurrers and non-recurrers using the same procedure in DESeq2, including controlling for the antibiotic treatment type. All differential abundance analyses were followed by the Benjamini-Hochberg correction for multiple hypotheses [56]. The relative abundances of ASVs that were significantly different between recurrers and non-recurrers at pre-treatment, week 1, or week 2 are shown in Fig.
2 on a logarithmic scale, along with the phylogenetic relationships of these ASVs (found with methods detailed below). In this figure, recurrers and non-recurrers at each timepoint are clustered hierarchically using scipy.cluster.hierarchy with optimal ordering and ‘average’ distance.

To further clarify phylogenetic relationships between ASVs of interest, we built a reference tree and then performed phylogenetic placement of ASVs. For the reference tree, all typed, isolated strains of good quality that were longer than 1200 base pairs were downloaded from the RDP bacteria and archaea datasets [53]. Reference sequences were then aligned using the RDP aligner. The reference sequences were then filtered to remove: (1) sequences with unaligned lengths ≥ 1600 bp and, (2) sequences with rare insertions (defined as a base pair in a position where there were 5 or less sequences with un-gapped base pairs in that position). Filtered reference sequences were then realigned using the same RDP aligner. A reference tree was constructed using FastTree version 2.1.7 SSE3 with the general-time-reversible maximum likelihood option [57]. Pplacer v1.1.alpha19 with default settings [58] was then used to place query ASVs onto the reference tree.

Enrichment analyses were performed on the ASVs found in each differential abundance analysis with FDRs < 0.05 (Additional file 5). For a given family A, we tested if the family was significantly overrepresented in differentially abundant ASVs using the hypergeometric probability distribution:

Here, N is the total number of (post-filtering) ASVs, K is the subset of N in family A, n is the number of differentially abundant ASVs, and k is the subset of n in family A. To prevent false positives due to small family sizes, we did not test (1) families that had too few ASVs in the total post-filtering set (K ≤ 3) or (2) families that had too few ASVs in the differentially abundant subset (k ≤ 2). For all families large enough to pass the filter, p values were computed using the hypergeometric test, and the Benjamini-Hochberg procedure was using to correct for multiple hypothesis testing [56].

“OrigScale” data returned by Metabolon was used in all analyses described in this manuscript; these data represent values normalized in terms of raw area counts.

To assess inter-group dissimilarity at each timepoint and intra-group dissimilarity between timepoints, we computed matrices using Spearman rank correlation on the unfiltered and untransformed metabolomic data. We used PERMANOVA (skbio.stats.distance.permanova) with 999 permutations to test the significance of differences (Additional file 3).

LC-MS untargeted metabolomics measured 1387 metabolites. To retain only metabolites with sufficient prevalence and variance across time or participants, we included metabolites with: (1) non-zero values in ≥ 25% of participants in either pre-treatment, week 1, or week 2 samples, and (2) co-efficient of variations in the top 50th percentile in either pre-treatment, week 1, or week 2 samples. These criteria resulted in 760 metabolites post-filtering.

Before univariate analyses, metabolite values were log transformed (after adding a small positive number, 10% of the minimum non-zero value in the dataset) to all values, and standardized to have a mean of 0 and a standard deviation of 1. After filtering and transforming the metabolic data, we performed ordinary least squares linear regression using the statsmodels (v0.14.0) package in python, with both antibiotic treatment type (metronidazole or vancomycin) and recurrence/non-recurrence as covariates. To control for the effect of antibiotic type on the level of each metabolite, hypothesis testing was performed using the t-test on the coefficient of the recurrence/non-recurrence variable. The Benjamini-Hochberg procedure was applied to correct for multiple hypothesis testing [56].

Enrichment analyses were performed on the metabolites found in univariate analysis with FDRs < 0.05, with an analogous method as used for enrichment analysis of the ASVs. We used the hypergeometric test with Benjamini-Hochberg [56] multiple hypothesis correction to assess whether pre-specified groups (super pathways and sub-pathways) were significantly over-represented in the differentially abundant metabolites. As with the ASV enrichment analysis, we did not perform hypothesis testing on super and sub-pathways with (1) too few metabolites in the total post-filtering set (K ≤ 3) or, (2) too few metabolites in the differentially abundant subset (k ≤ 2).

SCFA profiling found eight SCFAs in the analyzed samples: acetate, propionate, isobutyrate, butyrate, isovalerate/2-methylbutyrate, valerate, heptanoate, isocaproate, and caproate. Heptanoate was removed from subsequent analyses due to only being present in one sample. Caproate was present in only two samples and was also removed from further analyses. The remaining seven SCFAs were log transformed and standardized analogously to the untargeted metabolomics data prior to univariate analysis; univariate analyses were also performed analogously to those on the untargeted metabolomics data.

The following data sources were used as input to predictive modeling methods: (1) clinical variables found to be associated with recurrence in prior studies (age, previous PPI use, antibiotic treatment regiment, and CDI diagnostic test), (2) 16S rRNA amplicon sequencing (ASVs) from pre-treatment, week 1, or week 2 samples, (3) untargeted metabolomics data from pre-treatment, week 1, or week 2 samples, (4) SCFA profiles from pre-treatment, week 1, or week 2 samples, and (5) data sources 1–4 combined. In each predictive model, training datasets were filtered with the same criteria described for univariate analyses. Metabolites and SCFAs were log-transformed and standardized, and ASV relative abundances were transformed with the centered log ratio and then standardized. Continuous clinical variables (i.e., age) were log-transformed and standardized.

Relevant predictive features were identified through a nested leave-one-out cross-validation procedure (described in detail below for each method). To summarize the results for each feature, we report the median and 95% interval over the folds (i.e., regression coefficients for logistic and cox regression, feature importances for random forests). We deem features significant if the 95% cross-validated odds-ratio/feature-importance intervals did not contain 1.0, and marginally significant if the 75% cross-validated interval did not contain 1.0. The code to reproduce these analyses can be found in https://github.com/gerberlab/cdiff_paper_analyses.

Logistic regression models were fit using scikit-learn’s (v0.24.2) logistic regression function with L1 lasso regularization, balanced classes, and a liblinear solver. We used nested leave-one-out cross validation to find the optimal L1 lambda hyperparameter, performing a grid search over a range of 200 values from the maximum lambda value (i.e., the value that resulted in all zero coefficients) to 0.1% of the maximum lambda value. Performance in the inner loop was evaluated by area under the receiver operator curve (AUC) score calculated from the predictions of all the held-out samples. To reduce overfitting, the inner loop performances were smoothed using a n = 5 moving average, and the optimal L1 hyperparameter was that which resulted in the highest value on the smoothed performance curve. After choosing the best L1 hyperparameter, the model’s predictive capability was evaluated by its leave-one-out cross validated AUC score. Variance estimates of model performance and regression coefficients were calculated from the cross-validation folds.

Random forest models were fit using scikit-learn’s (v0.24.2) random forest classifier. We performed a nested leave-one-out cross validation procedure with grid search, to determine the number of estimators (50 or 100), the maximum features to subsample at each split (the total number of features or the square root of the number of features), the minimum samples required to split an internal node (2 or 9) and the minimum samples required to split a leaf node (1 or 5). All other parameters were set to their default values except for class weight (‘balanced’) and out of box score (True). The feature importances were calculated with the impurity-based feature importance, or the Gini importance, using the feature_importance attribute of the fitted model. Model performance and feature importance statistics were calculated from the cross-validation folds.

Cox regression models were fit using scikit-survival’s (v0.15.0) Coxnet Survival Analysis function with L1 regularization. We used a similar nested cross validation as described for our logistic regression analyses to optimize the L1 lambda parameter, searching over a range of 200 values from the maximum lambda value (i.e., the value that resulted in all zero coefficients) to 0.01% of the maximum lambda value. We evaluated both the inner and outer loops of the survival analysis using the concordance index (CI). Rather than leave-one-out cross validation, we used a leave-two-out method, where all left out pairs had at least one recurrer, to calculate the CI. In this formulation (mathematically equivalent to the standard definition of CI), CI is computed by dividing the number of times a pair was ordered correctly by the number of times a pair ordering was attempted. Variance estimates of model performance were calculated from the cross-validation folds.



Publisher’s Note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

Jennifer J. Dawkins and Jessica R. Allegretti are co-first authors.

