The gut microbiome buffers dietary adaptation in Bronze Age domesticated dogs

In an attempt to explore the role of the gut microbiome during recent canine evolutionary history, we sequenced the metagenome of 13 canine coprolites dated ca. 3,600–3,450 years ago from the Bronze Age archaeological site of Solarolo (Italy), which housed a complex farming community. The microbiome structure of Solarolo dogs revealed continuity with that of modern dogs, but it also shared some features with the wild wolf microbiome, as a kind of transitional state between them. The dietary niche, as also inferred from the microbiome composition, was omnivorous, with evidence of consumption of starchy agricultural foods. Of interest, the Solarolo dog microbiome was particularly enriched in sequences encoding alpha-amylases and complemented a low copy number of the host amylase gene. These findings suggest that Neolithic dogs could have responded to the transition to a starch-rich diet by expanding microbial functionalities devoted to starch catabolism, thus compensating for delayed host response.

Mammals live in close association with mutualistic microbial communities, called microbiomes, which have become integral to host physiology (McFall-Ngai et al., 2013; Moeller et al., 2016). In particular, the gut microbiome (GM) provides the mammalian host with essential ecological services that are strategic for metabolic and immune functions, with an ultimate impact on the host health (Krautkramer et al., 2021).

The Bronze Age Solarolo site has been investigated since 2005, providing a detailed picture of the settlement size, ancient diet, and resource management (Cattani 2009; Cattani et al., 2018; Debandi 2021). The site was presumably inhabited by a few hundred people with an economy based on agriculture and animal breeding, as evidenced by a large amount of archaeozoological (Maini 2012) and archaeobotanic remains. In particular, the discovery of dog coprolites, and the detection of scavenging traces on bones, led the researchers to assume that dogs were kept free to circulate inside the village (Maini, 2012), thus likely consuming refuse and meal remains discharged from the suspended floors of pile dwellings. Since a strong mutualism with dogs is supposed, the interpretation built from the archaeological site cannot rule out that a privileged attitude toward these animals facilitated sharing food (and room) with human companions. This postulated scenario makes Solarolo dogs good candidates to explore the GM role in facilitating host adaptation to the stark dietary and lifestyle changes occurring during the Neolithic transition. Specifically, we highlight that the GM components found in the Solarolo dogs demonstrate an amylase-enriched layout, as a possible early adaptation to a starch-rich diet, complementing a low copy number of the host amylase (AMY2B) gene.

Thirteen canine coprolites were found at the Bronze Age (ca. 3,600–3,450 years ago) site of Solarolo, in the Eastern part of the Emilia-Romagna region, in Southwest of Ravenna, Italy. Over 350M reads were generated by shotgun metagenomics of extracted DNA, of which ∼1.2% mapped to the dog reference genome (CanFam3.1), in line with previous findings (Borry et al., 2020), confirming the canine origin of the samples. First, MapDamage analysis demonstrated that the samples possessed typical deamination damage profiles that are characteristic of ancient DNA (Figure S1). In order to reconstruct the phylogeny of Solarolo dogs, the DNA sequences of all the coprolite samples were merged and mtDNA reads were retrieved to construct a consensus mitochondrial genome. Phylogenetic relationships were assessed by comparing the obtained genome with publicly available canine mtDNAs, including ancient wolf-like and dog-like whole mtDNA sequences, mtDNA sequences from a comprehensive panel of modern dogs across four major clades (A–D) (Thalmann et al., 2013; Frantz et al., 2016; Botigué et al., 2017), and mtDNA sequences purposely retrieved from previous metagenomic studies (Lyu et al., 2018; Alessandri et al., 2019). According to our findings, Solarolo dogs belong to haplogroup C (Figure 1), together with the Upper Palaeolithic 12,500-year-old Kartstein Cave dog and other European Neolithic dogs, i.e., the Early Neolithic 7,000-year-old Herxheim dog and the 4,700-year-old Cherry Tree Cave dog from the End Neolithic period in Central Europe.

To characterize the taxonomic composition of the ancient microbial community from Solarolo canine coprolites, we used PhyloFlash (Gruber-Vodicka et al., 2020), a tool specifically designed for taxonomic profiling of short-read shotgun metagenomic data. By using this approach, we were able to detect several host-associated microorganisms in the Solarolo coprolites. In particular, components of the mammalian and, especially, canine GM were identified (Alessandri et al., 2019; Gaspardo et al., 2020; Pilla and Suchodolski, 2020; Zannoni et al., 2020), including members of the families Peptostreptococcaceae, Lachnospiraceae, Prevotellaceae, and Fusobacteriaceae. As expected for coprolite samples, members of bacterial families known as environmental contaminants (e.g., Streptomycetaceae) were also detected (Figure 2A). The ancient origin of the identified host-associated microorganisms was validated by the HOPS pipeline (Hübler et al., 2019; Jensen et al., 2019), a fast classifier tool for taxonomic assignment and ancient validation of metagenomic data. In brief, taxa with more than 500 assigned reads, more than 50 reads with postmortem degradation score (PMDS) > 1, −Δ % (negative difference proportion of PMDS >1 reads) > 0.9 and showing patterns of C-T transition at 5′ were considered to be of ancient origin (see Table 1 and Figure S2 for C-T transition at 5′ and edit distance distribution). A large number of reads assigned to previously identified canine GM taxa (Alessandri et al., 2019; Gaspardo et al., 2020; Pilla and Suchodolski, 2020; Zannoni et al., 2020) sustained deamination and substitution profiles that are consistent with that of ancient DNA (e.g., Ruminococcus bromii, Collinsella intestinalis, Enterococcus faecalis, Faecalibacterium prausnitzii, Roseburia faecis, and Prevotella copri).

Depth (DoC) and breadth of coverage (>1x) were calculated using BEDTools. Deamination rates at the 5′ ends of DNA fragments were calculated for the first 10 bases using mapDamage. −Δ % refers to the negative difference proportion introduced by Hübler et al. (2019). C-T (%) and −Δ % are computed on PMDS >1 reads. See also Figure S2.

It is well known that different species of the mammalian GM exhibit a different nutritional specialization, with some microbes able to digest both plant and animal materials and others specialized on specific substrates (Groussin et al., 2017). According to Groussin et al. (2017), the host dietary niche can therefore be inferred from the peculiar pattern of diet-related GM components. Accordingly, we attempted to predict the diet of Solarolo dogs from their GM profile. To this end, we first extracted the sequences mapping to 16S rRNA gene references of the SILVA database using PhyloFlash (Gruber-Vodicka et al., 2020) and then sought for the layout of diet-related taxa. For comparison, a comprehensive dataset of healthy canids was created, including information on the host diet and corresponding GM structure. In particular, the following studies were considered: Lyu et al. (2018) and Alessandri et al. (2019), for a total of nine canids, including one dog following a bones and raw food diet, four dogs consuming commercial food (including kibble and/or leftover foods), and four wolves with a strictly carnivorous diet. By combining all the dietary information, a matrix of Euclidean distances between the animal feeding patterns was constructed. Then, the canine GM components that showed a distribution in subjects correlated with the respective diet-based distances were retained (P ≤ 0.05, Mantel test), allowing the identification of 61 diet-related canine GM bacterial taxa. On the basis of the abundance profiles of these taxa, a principal component analysis (PCA) of inter-subject compositional differences was carried out (Figure S3), and PCA coordinates were next used as an independent explanatory variable in a logistic regression model for predicting the canine dietary niche. The dietary niche was considered binomial, as in PCA subjects segregated into two main diet categories, i.e., omnivorous (dog-like) and carnivorous (wolf-like). Following cross-validation testing to validate the accuracy of our GM-based method to predict diet (see STAR Methods section), the model was finally utilized to infer the dietary niche of Solarolo dogs, based on their peculiar abundance profile of diet-responding taxa. According to our findings, Solarolo dogs showed evidence of a dog-like omnivorous diet. Of interest, our prediction was confirmed by the presence of authenticated ancient DNA mapping to eukaryotic specimens that match known dietary constituents at that time and location, including Ovis aries (sheep), Triticum aestivum (wheat), and Vitis vinifera (grapes) (Varalli et al., 2015; Alonso and Bouby, 2017; Sabatini et al., 2019; Arena et al., 2020; Pecci et al., 2020). See Table 2 for validation of the ancient origin of these taxonomic assignments by the HOPS pipeline (Key et al., 2017; Hübler et al., 2019; Jensen et al., 2019; Rampelli et al., 2021).

Depth (DoC) and breadth of coverage (>1x) were calculated using BEDTools. Deamination rates at the 5′ ends of DNA fragments were calculated for the first 10 bases using mapDamage. −Δ % refers to the negative difference proportion introduced by Hübler et al. (2019). C-T (%) and −Δ % are computed on PMDS >1 reads.

Metagenomic data from Solarolo canine coprolites were further explored in the wider context of the whole set of available metagenomes from modern canine GMs, including four wolves and five dogs (Lyu et al., 2018; Alessandri et al., 2019). From this dataset, also integrating ancient data from Solarolo coprolites, we extracted the sequences mapping to 16S rRNA gene references of the SILVA database by PhyloFlash (Gruber-Vodicka et al., 2020), as reported above. We retrieved 3,561 references, from which we reconstructed a time-calibrated bacterial phylogenetic tree (Groussin et al., 2017). Based on this tree, a principal coordinates analysis (PCoA) of unweighted UniFrac β-diversity between canine GMs was performed, highlighting a clear separation between the GMs of modern dogs and wolves (P = 0.007, permutational test with pseudo-F ratio), with the putative GM from ancient Solarolo dogs positioned in an intermediate site between the two clusters (Figure 2B). Solarolo dogs in fact possessed both the bacterial taxa previously identified as characteristic of the GM of modern dogs, such as Dorea, Parabacteroides, Streptococcus, and other Clostridiales and Bacteroidales members, and those exclusively present in the GM of contemporary wild wolves, including Pseudomonas, Slackia, Subdoligranulum, and Eubacterium coprostanoligenes (Alessandri et al., 2019) (Figure S4), combining peculiarities of the GM of wild wolves and the modern dog. Of interest, when we sought for congruence between the mtDNA-based phylogenetic tree and a matched tree based on GM diversity, as inferred using unweighted UniFrac dissimilarities (Ochman et al., 2010; Brucker and Bordenstein, 2012, 2013), we found a phylosymbiotic signal (P = 0.001, Mantel test; P = 0.006, non-randomness permutational test for Procrustes Analysis) (Figure S5), suggesting the possible co-diversification of the GM structure and canine phylogeny. PCoA analysis of the Bray-Curtis distances between the functional profiles of GMs from wild wolves, modern dogs, and Solarolo dogs showed that the latter segregated with modern dogs (Figure S6). In particular, when focusing on the total abundance and pattern of carbohydrate-active enzymes (CAZymes), we found that the GM of Solarolo dogs was generally comparable with that of modern dogs, possessing a higher load of reads assigned to CAZymes and a dog-like overall compositional profile of CAZyme families (Figure S6).

The domestication of dogs has undoubtedly represented a major step in recent canine evolutionary history, requiring progressive adaptation steps to multiple and rapid ecological transitions, as a result of sharing life and establishing a close mutualistic relationship with humans (Perri et al., 2021). To specifically examine the canine GM components responding to domestication and to subsequent ecological transitions, we applied the BDTT (β-diversity through time) method, which was previously developed to discriminate the evolutionary dynamics of GM components in response to host phylogeny or diet (Groussin et al., 2017). This approach involves the construction of a time-calibrated phylogenetic tree from a set of GMs of a given host species (or other taxonomic groups) and its subsequent progressive partition over bacterial evolutionary time. For each partition, the GM is re-measured, allowing one to reconstruct the dynamics of inter-individual GM diversity along the bacterial evolutionary time. The BDTT approach (with Sørensen metric) was applied to the metagenome dataset from 10 canid hosts, i.e., the nine modern dogs and wolves whose sequences are publicly available (Lyu et al., 2018; Alessandri et al., 2019) and the Solarolo dogs, on which the time-calibrated bacterial phylogenetic tree was previously constructed. Phylogenetic distances between the 10 canid hosts were inferred from the corresponding mitogenomic tree. In order to account for the ecological transitions that occurred with dog domestication (meaning dietary changes and, in general, the relationship with the environment), a distance matrix was created, approximating the ancient Solarolo dogs as an ecological intermediate between wild wolves and modern dogs, as also inferred by the GM. Based on BDTT, different evolutionary dynamics of canine GM components in response to host phylogeny or ecological transitions (hereinafter referred to as “host ecology”) were discriminated. In particular, the most recently differentiated GM constituents were highly responsive to host phylogenetic differences (Mantel test: R2 = 0.35 at 100 Mya, P = 0.003; R2 = 0.32 at 500 Mya, P = 0.002; R2 = 0.31 at 900 Mya, P = 0.005), whereas the most ancient lineages were highly responsive to variations in host ecology, responding to the ecological differences between wild wolves, ancient Solarolo dogs, and modern dogs (R2 = 0.28 at 100 Mya, P = 0.002; R2 = 0.29 at 500 Mya, P = 0.002; R2 = 0.38 at 900 Mya, P < 0.0001) (Figure 3). We computed different bioinformatic experiments to evaluate the robustness of these signals of phylogenetic scale disparity between host phylogeny and host ecology (Figure S7). Specifically, we measured the influence of topological uncertainties in the bacterial tree and the influence of host phylogenetic and ecological distance matrices with respect to randomness. All these bioinformatic controls supported the signal of scale disparity between the two factors. Finally, canine GM components that correlated to host phylogeny and ecology, including taxa nested within ancient clades, were identified, resulting in 165 and 98 bacterial lineages associated with phylogeny and ecology, respectively, with 16 taxa correlated to both factors (Figure 4 and Table S1). According to our findings, host phylogeny was associated with a pattern of members within the two gut families Bacteroidaceae and Prevotellaceae. On the other hand, Erysipelatoclostridiaceae positively correlated with host ecology, whereas Bacteroidaceae, Lachnospiraceae, Christensenellaceae, and Succinivibrionaceae correlated inversely, i.e., they were more represented in the GM of wild wolves. Samples were also clustered according to the pattern of relative abundance of the gut bacterial lineages correlated with host phylogeny and/or ecology. Of interest, the GM metacommunity from the Solarolo dogs clustered together with modern domesticated dogs but was still close to the wild wolf cluster (Figure 4), with which they shared a higher relative abundance of members from the Christensenellaceae, Lachnospiraceae, and Succinivibrionaceae families (Figure S8). Taken together, these data confirm that the GM of Solarolo dogs retained some of the characteristics of the wild canine ecosystem.

The low copy number of the AMY2B gene observed in ancient samples of Canis lupus familiaris (4,800, 5,000, and 7,000 years ago) indicated that, in dogs, amylase expansion, as an adaptive response to a starchy diet, may have occurred after the initial domestication, well after the advent of agriculture and the Neolithic in Europe (only 8,000–6,000 years ago) (Botigué et al., 2017). In the metagenome from Solarolo coprolites, we detected a low host AMY2B copy number (n = 2) (Figure S9), suggesting that the extreme enrichment of this gene in European dogs could be postponed to less than 3,500 years ago. In this context, we hypothesized that, in the early domestication process, the limited canine amylolytic potential would have been complemented by an adaptive GM response, resulting in the expansion of microbiome functionalities associated with starch metabolism. Supporting this hypothesis, in the GM of Solarolo dogs we observed a higher abundance of reads for alpha-amylase than in the GM of modern dogs (Figure 5). Of interest, the GM of Solarolo dogs was also particularly enriched in reads for genes involved in SCFA production, i.e., genes within propanoate metabolism (ko00640), butanoate metabolism (k00650), and pyruvate metabolism (ko00620) of the KEGG database and genes encoding enzymes directly associated with butyrate (butyryl-CoA transferase/acetyl-CoA hydrolase), acetate (acetate-formyltetrahydrofolate synthetase/formate-tetrahydrofolate ligase) and propionate (propionyl-CoA:succinate-CoA transferase/propionate CoA-transferase) production (Figure S10).

In this study we successfully extracted and sequenced ancient DNA from 13 dog coprolites collected from the Bronze Age archaeological site in Solarolo, North Italy, dated 3,600–3,450 years ago. Analysis of the ancient mtDNA reads confirmed the canine origin of the coprolite samples. Although we cannot rule out that other haplotypes were also present, haplotype C was the most prevalent in our study. The same haplotype was previously detected in 27 ancient Italian dogs dated from the Late Pleistocene to the Bronze Age, including a dog from the Solarolo site (Koupadi et al., 2020). Ancient bacterial reads were then retrieved from the metagenomes of the Solarolo coprolites and used to reconstruct the putative GM of the corresponding Bronze Age dogs. According to our findings, the GM of Solarolo dogs showed a general layout matching the modern canine GM, with notably members of the Peptostreptococcaceae, Lachnospiraceae, Prevotellaceae, and Fusobacteriaceae families (Alessandri et al., 2019; Gaspardo et al., 2020; Pilla and Suchodolski, 2020; Zannoni et al., 2020). The GM compositional structure of Solarolo dogs shared features with both modern wild wolves and domesticated dogs, likely reflecting a transitional state between the GM of the wolf and that of the fully domesticated modern dog.

In conclusion, through the characterization of the GM from Italian Bronze Age dogs, we were able to provide some glimpses on the importance of the canine GM as an adaptive counterpart, allowing rapid adaptation to the profound changes in diet occurring along the course of domestication, while also complementing the limited plasticity of the host genome. However, our data remain preliminary and need to be confirmed on a larger population of ancient dogs, possibly spanning a larger temporal transect across the Neolithic transition and including different geographical sites. Our findings may encourage archaeologists to pay more attention to the collection of coprolite samples, generally neglected in excavation campaigns. Coprolites can indeed represent a proxy for ancient GMs, with the potential to provide meaningful information on the GM importance for mammalian evolutionary trajectories. With a more systematic collection of dog coprolites, it will be possible not only to confirm our preliminary results but also to reconstruct a more resolved trajectory of GM variation along the complex history of dog domestication.

In addition to a small sample size, our study is limited by the fact that the dogs were all from the same archaeological site and within a short time span, which limits the extensibility of our findings. Furthermore, there are not many studies available to date on ancient dogs or wolves profiling the gut microbiome, which has limited possible comparisons.



Further information and requests for resources and reagents should be directed to and will be fulfilled by the lead contact, Simone Rampelli (simone.rampelli@unibo.it).

This study did not generate new unique reagents.

The samples used for this study were found during the excavations at the archeological site of Via Ordiere, Solarolo, Ravenna, Italy. All necessary permits were obtained from ‘Soprintendenza Archeologia, Belle Arti e Paesaggio’ (Prot. DG-ABAP 5499 Class. 34-31-07/5.9). All material including paleofeces is considered archaeological material, so no further permits were required for the presented study. The 13 canine coprolites collected during the excavations were stored in sterile plastic bags until their processing.

All work was conducted at University of Oklahoma LMAMR (The Laboratories of Molecular Anthropology and Microbiome Research) ancient DNA laboratory following protocols for coprolite-derived materials, as previously reported (Rampelli et al., 2021). Briefly, DNA was extracted from approximately 200 mg subsampled from the interior of each coprolite. Samples were incubated with 400 μl of 0.5 M EDTA and 100 μl of proteinase K (QIAGEN) on a rotator for 4 hours, bead-beaten with 750 μl of PowerBead solution (QIAGEN) and then extracted using the MinElute PCR Purification kit (QIAGEN) with a modified protocol (method B) described in Hagan et al. (2020) and based on Dabney et al. (2013). Two cleaning steps were performed prior to final elution into two 30 μl of EB buffer (QIAGEN).

Shotgun sequencing indexing libraries were constructed following the “BEST” (Blunt-End-Single-Tube) method (Carøe et al., 2018). Briefly, deaminated (C to U) bases were first partially removed (UDG-half) by treatment with uracil DNA glycosylase using USER enzyme (Rohland et al., 2015). End overhangs were repaired, creating blunt-end phosphorylated regions for adapter ligation. Adapter oligos were hybridized as per Meyer and Kircher (2010) and filled in to create priming sites for index primers. After purification with a MinElute column (QIAGEN), indexed libraries were generated in triplicate for each sample with the Kapa +U enzyme (Roche). The triplicates were pooled, cleaned using AMPure XP magnetic beads (Beckman Coulter) in a PEG/NaCl buffer (Rohland and Reich, 2012) and then run on a Fragment Analyzer (Advanced Analytical) for library fragment-size analysis. Samples containing adapter dimers below the main peak for putative authentic endogenous DNA (i.e., 200-250 bp) (Ziesemer et al., 2015), were further purified as described above (Rohland and Reich, 2012). Final libraries were sequenced on an Illumina NextSeq 500 platform (Illumina) at the University of Bologna (Bologna, Italy), using 2 × 75 bp paired-end chemistry. Quality score exceeded Q30 for more than 95% of the sequenced bases. Sequencing data were pre-processed keeping only the merged reads matching the forward and reverse barcodes using AdapterRemoval (Lindgreen, 2012). The sequences from the 13 coprolites were then merged and used as a single sample for the following analysis.

Trimmed and filtered reads were first mapped to CanFam3.1 using the bwa aln algorithm with the following options: maximum accepted edit distance set to 1% (-n 0.01), maximum number of gap opens to 2, with long gap and seed length disabled (-e 1 -l 16500). Only reads with a mapping quality ≥ 30 were kept and PCR duplicates were removed. MapDamage (Jónsson et al., 2013) was used to evaluate the authenticity of retained reads (Figure S1).

The AMY2B gene copy number was estimated from the mapped read depth using previously developed methods for analysing AMY2B copy number variation (Bergström et al., 2020). In brief, the reads mapped to CanFam3.1 with mapping quality ≥ 30 were kept. To maximize power particularly for low-coverage ancient samples, the AMY2B copy number was estimated based on depth in the AMY2B region on chromosome 6 (46,948,800-46,956,325) as well as three other unplaced contigs (chrUn_AAEX03020568, chrUn_AAEX03022739, chrUn_AAEX03024353), with a total size of about 75 kb. For each sample, we counted the number of reads mapped to the amylase regions and the number of reads mapped to 75 randomly selected windows of 1-kb size throughout the whole genome, and calculated the ratio of the number of amylase-mapping reads to the sum of reads mapping to the control and amylase regions. We obtained standard errors for these read count ratios using binomial confidence intervals, following a previous approach to infer biological sex from the ratio of reads mapped to Y and X chromosomes (Skoglund et al., 2013). To convert these ratios into estimates of diploid copy numbers, we used the same assumption as Bergström et al. (2020), considering wolves with copy number of two and calculating the mean scaling factor needed to map the read count ratios of these wolves to a copy number of two. Such scaling factor was then used for scaling to copy number estimation all the scores from the rest of the dogs, including Solarolo dogs.

PhyloFlash (Gruber-Vodicka et al., 2020) was applied to metagenomic sequences to get a quick description of the family-level microbiome structure using the default options. We then used HOPS (Hübler et al., 2019) to further characterize the metagenomic profile of the non-canid reads. The filtered reads were first aligned to the reference database using a modified version of MALT (Herbig et al., 2016; Vågene et al., 2018), then the reads assigned to bacterial genomes were extracted with the MaltExtract tool and realigned to their respective reference genomes to examine edit distances, coverage distributions, and post-mortem DNA damage patterns (Key et al., 2017; Hübler et al., 2019; Rampelli et al., 2021). In particular, we chose to extract and further investigate bacterial species of canine origin (i.e., already detected within the stool microbiome of C. lupus or C. lupus familiaris in other studies) (Alessandri et al., 2019; Gaspardo et al., 2020; Pilla and Suchodolski, 2020; Zannoni et al., 2020), with ≥ 500 assigned reads (including strain-specific reads). For this purpose, we applied bwa aln with the same options used for the host analysis (-l 16500 -n 0.01 -o 2). MapDamage was utilized to estimate deamination rates (Jónsson et al., 2013). Post-mortem degradation score (PMDS) distributions were calculated using the pmds tool (Skoglund et al., 2014). The breadth and depth of coverage were calculated with bedtools (Quinlan and Hall, 2010). Edit distances for all reads and for reads filtered for PMDS > 1 were extracted from the bam files with the samtools view (Li et al., 2009) and plotted in R (Figure S2). The negative difference proportion (-Δ %) was calculated considering the first 10 bases of reads with PMDS > 1. This metric was proposed by Hübler et al. (2019) as a measure of decline in the edit distance distribution, with a –Δ % value > 0.9 indicating a declining distribution associated with an ancient DNA profile. Taxa with more than 500 assigned reads, more than 50 reads with PMDS > 1, −Δ % > 0.9 and showing patterns of C-T transition at 5′ were considered to be of ancient origin. The MALT reference database was created by malt-build using the “representative” and “reference” bacterial (n = 11,270) and archaeal (n = 408) genomes downloaded from NCBI RefSeq on November 16, 2020.

We applied the previously developed BDTT (β-diversity through time) method (Groussin et al., 2017) to a subset of samples, including Solarolo coprolites and shotgun metagenomic samples of modern canids available from the literature (Lyu et al., 2018; Alessandri et al., 2019). We first built an abundance table by extracting the number of hits for each sample assigned to 16S rRNA gene references of the SILVA database using PhyloFlash (Gruber-Vodicka et al., 2020). In order to discard the bacterial reads of environmental origin contained in the Solarolo samples, only the hits for bacteria found in the GM of modern canids were specifically retained. The sequences for each reference were then merged and used as a representative set in subsequent analyses. The final dataset comprised 3,561 unique bacterial sequences. To use BDTT on our data, we followed the same procedure as Groussin et al. (2017). In particular, we reconstructed the phylogenetic tree of the 3,561 unique bacterial sequences, by also adding external 16S rRNA gene sequences of 50 Cyanobacteria, 50 Rickettsiales, 15 Chlorobium and 15 Chromatiales. These external 16S rRNA gene sequences were used to incorporate calibrations when computing divergence times and were subsequently removed for all our analyses. We aligned all 16S rRNA gene reads with the SINA v 1.7.2 (Pruesse et al., 2012) and the SILVA database (release 138.1). We removed the sites containing > 95% gaps obtaining a final alignment with 1,279 positions. We then used FastTree (Price et al., 2009) to build the phylogenetic tree of all 3,561 stool-derived sequences plus 130 external sequences. We applied the GTR model and the CAT approximation to evaluate the heterogeneity rate across sites. We retrieved the phylogeny topology from the SILVA database, forcing the phyla Proteobacteria, Actinobacteria and Firmicutes to be monophyletic. The phylogenetic tree was rooted on the branch separating either Actinobacteria or Proteobacteria from the rest of the sequences. We then used PATHd8 (Britton et al., 2007) to construct a cladogram from the FastTree tree. To do this, we set the origin of Cyanobacteria at > 2.5 Gy ago (Schirrmeister et al., 2013). The divergence of Rickettsiales from the rest of Alphaproteobacteria was set at > 1.6 Gy ago, as the ancestor of the mitochondrion was evolutionarily close to Rickettsia (Parfrey et al., 2011). Furthermore, we calibrated the divergence of Chlorobium from the rest of Bacteroidetes at > 1.64 Gy ago, since Chlorobium-specific biomarkers were found in rocks at 1.64 Gy ago (Brocks et al., 2005). Finally, the divergence between Chromatiales and the rest of Gammaproteobacteria was set at > 1.64 Gy ago, since Chromatiales-associated biomarkers were also found in rocks at 1.64 Gy ago (Brocks et al., 2005). A maximum divergence time of 3.8 Gy ago was set at the root of the tree. The BDTT approach was computed by combining this phylogenetic tree with the abundance table retrieved from PhyloFlash using the Sørensen metric. In particular, the bacterial tree was continuously cut from leaves to root following evolutionary time. For each time scale, the tree was sliced, creating new 16S rRNA clades that were used as taxonomic units in the downstream analysis. The microbiome structure was then determined for each metagenomic sample by considering these new clades, and compositional dissimilarities were retrieved. It is important to note that BDTT analysis provided a phylogenetic decomposition congruent with the unweighted UniFrac metric (P=0.0001, Mantel test; P=0.002, non-randomness permutational test for Procrustes Analysis).

We transformed the mitochondrial-based phylogeny retrieved from the metagenomic samples into a distance matrix using the function “cophenetic” of the R package “stats”. Regarding host ecology, we considered the Solarolo dogs as an intermediate between ancient wild animals and modern domesticated dogs, as also inferred by the GM, with a diet already influenced by proximity to humans (see “Inference of the putative diet of Solarolo dogs from the gut microbiome layout” paragraph in the Results section) but a relationship with the environment very different from modern dogs (Bergström et al., 2020). Indeed, their archaeological context revealed dispersion of canine coprolites in the peripheral part of the excavation (outside the village), as dogs, consuming meals discharged from their human companionship, could freely circulate in the countryside all around Solarolo (Maini, 2012). For all these reasons, the host ecological distances were approximated to “1” between dog and wolf samples, “0” between wolf or dog samples, and “0.5” between the Solarolo dogs and the rest of the samples.

For each time period, we correlated β-diversities to host phylogenetic and ecological distances using the Mantel test with Pearson’s correlations (Mantel, 1967). All Mantel tests were run with the mantel.rtest function from the ‘ade4’ R package (Dray and Dufour, 2007). To test whether R2 values were significantly higher than expected by chance, we used permutation tests on distance matrices and computed the 95% credibility interval of the correlations between community dissimilarities and both host phylogenetic and ecological distances at each phylogenetic slice, producing 95% credibility envelopes for both factors. At each slice, host names were randomly shuffled 10 times in the ecological and phylogenetic distance matrices, and the correlations with community dissimilarities (β-diversities) were re-computed for each replicate, yielding a distribution of 10 R2 coefficients with respect to each factor. A correlation with either host phylogeny or host ecology was considered significant when R2 was above the upper bound of the 95% credibility interval as visualized in Figure S7. Furthermore, to verify that the BDTT profiles and associated correlations were not the result of the hierarchical dependency between leaves and internal branches of the tree, we compared the observed correlations with appropriate null expectations. In particular, we shuffled the names of the leaves of the bacterial community within the phylogenetic tree and re-run the analysis. This null model breaks down the observed phylogenetic relationship between sequences, keeping the tree hierarchical structure constant. It also preserves the elements of the abundance table deduced from the repartition of unique sequences (tips of the tree) across samples, so that the correlations between compositional dissimilarities and host phylogeny or ecology at the youngest time slice remain identical to those observed. However, we observed that under this null model, correlations rapidly dropped when older time scales were considered (Figure S7). The observed correlations were not the result of an artefact due to the hierarchical structure of the bacterial tree. At all bacterial scales defined by time or evolutionary distance, we measured the percentage of individual bacterial lineages that had a distribution across our 10 canids correlated to host ecological and phylogenetic distances, using permutation multivariate analysis of variance tests (Oksanen et al., 2020) and a false discovery rate (FDR) approach to correct for multiple tests. Bacteria nested within lineages were then recovered from the initial abundance table, filtered for relative abundance > 0 and visualized by hierarchical clustering with Ward linkage and Spearman correlation index. The coherence between these clusters and the ecological or phylogenetic distance matrices were evaluating by applying the Mantel test (P≤0.05).

We used the EltonTraits 1.0 database to retrieve dietary information for wolves (Wilman et al., 2014). Information concerning the dogs from Alessandri et al. (2019) is available from their work. In particular, the dogs were fed the Bones and Raw Food (BARF) or commercial food (including kibble and/or leftover foods) diet, depicting greater variability in the diet of modern domesticated dogs (10 to 40% of carbohydrate and fibre consumption), compared to wolves that exclusively consumed meat from other mammals or birds. We used Euclidean distances to build the diet distance matrix based on food consumption.

To search for dietary components within the coprolites, we realigned the metagenomic reads against the entire set of mitochondrial sequences listed at the MitoSeqs website (https://www.mitomap.org/foswiki/bin/view/MITOMAP/MitoSeqs), including all mitochondrial sequences available at the NCBI database using MALT (Vågene et al., 2018). Higher eukaryotes with ≥ 100 assigned reads were chosen for further analysis. In particular, the reads were extracted with the MaltExtract tool and realigned to the respective reference genomes to examine edit distances, coverage distributions, and post-mortem DNA damage patterns as previously described in the “Microbiome characterization of Solarolo coprolites” paragraph. Taxa with more than 100 assigned reads, −Δ % > 0.9 and showing patterns of C-T transition at 5′ were considered to be of ancient origin.

Metagenomes were functionally profiled using HUMAnN2 (Franzosa et al., 2018), to reconstruct the relative abundance profiles of KEGG pathways and CAZyme families, and to quantify the normalized read abundances for alpha-amylases and genes involved in SCFA production. Reads were first recruited to sample-specific ChocoPhlAn pangenomes including all gene families in any detected microbes using Bowtie2 (Langdon, 2015). Unmapped reads were aligned against UniRef90 (Suzek et al., 2015) using the DIAMOND translated search (Buchfink et al., 2015). Hits were counted per gene family and normalized for length and alignment quality. The resulting table was transformed into EC number and KO abundant tables using the “humann2_regroup_table” command and the level4ec-Uniref90 or KEGG-Uniref90 mapping files. In order to exclude biases due to bacterial contaminants from the environment within our ancient samples from Solarolo, we estimated HUMAnN2 DNA level using only the reads assigned to bacterial species of canine origin (i.e., already detected within the stool microbiome of C. lupus or C. lupus familiaris in other studies) (Alessandri et al., 2019; Gaspardo et al., 2020; Pilla and Suchodolski, 2020; Zannoni et al., 2020). In particular, we used the same sequences previously extracted for the ancient validation of the taxonomic assignment. The KO and EC abundance tables thus obtained were transformed into KEGG pathways and CAZyme tables, respectively, using the “humann2_regroup_table” command and two different mapping files manually curated by the authors.

With regard to SCFAs, we screened the metagenome data for enzymes associated with butyrate (butyryl-CoA transferase/acetyl-CoA hydrolase), acetate (acetate-formyltetrahydrofolate synthetase/formate-tetrahydrofolate ligase), and propionate (propionyl-CoA:succinate-CoA transferase/propionate CoA-transferase) production, together with the abundance of KEGG pathways associated with SCFA production, i.e., propanoate metabolism (ko00640), butanoate metabolism (k00650) and pyruvate metabolism (ko00620). Graphical representations were performed using the R packages vegan, base and made4.

Statistical comparisons were performed in R (version 4.0.2) using the test and function reported within the “method details” section. When appropriate, p values were adjusted for multiple comparisons using the Benjamini-Hochberg correction. A false discovery rate (FDR) of ≤ 0.05 was considered statistically significant.

M. Candela, S.T., S.R., R.H., and M. Cattani conceptualized the study. F.D. and M. Cattani performed the field work, excavation, and sampling. S.L.S. and C.A.H. performed DNA extraction and library preparation. A.T., F.D.A., and S.T. performed sequencing. S.R. carried out bioinformatics and biostatistics analyses and prepared the figures. P.B., M. Candela, S.L.S., and C.A.H. secured funding. M. Candela, S.T., and S.R. wrote the original draft. A.A., M. Cattani, F.D., R.H., E.B., C.A.H., and S.L.S. performed the review and editing of the original draft.

The authors declare no competing interests.

Supplemental information can be found online at https://doi.org/10.1016/j.isci.2021.102816.

