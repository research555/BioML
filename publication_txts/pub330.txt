Competitive lottery-based assembly of selected clades in the human gut microbiome





While the composition of the gut microbiome has now been well described by several large-scale studies, models that can account for the range of microbiome compositions that have been observed are still lacking. One model that has been well studied in macro communities and that could be useful for understanding microbiome assembly is the competitive lottery model. This model posits that groups of organisms from a regional pool of species are able to colonize the same niche and that the first species to arrive will take over the entire niche, excluding other group members.

Here, we examined whether this model also plays a role in the assembly of the human gut microbiome, defining measures to identify groups of organisms whose distribution across samples conforms to the competitive lottery schema. Applying this model to multiple datasets with thousands of human gut microbiome samples, we identified several taxonomic groups that exhibit a lottery-like distribution, including the Akkermansia, Dialister, and Phascolarctobacterium genera. We validated that these groups exhibit lottery-like assembly in multiple independent microbiome datasets confirming that this assembly schema is universal and not cohort specific. Examining the distribution of species from these groups in the gut microbiome of developing infants, we found that the initial lottery winner can be replaced by a different member of the group. We further found that species from lottery-like groups tend to have fewer genes in their genomes, suggesting more specialized species that are less able to engage in niche differentiation.

Combined, our findings highlight the complex and dynamic process through which microbial communities assemble and suggest that different phylogenetic groups may follow different models during this process.

The online version of this article (10.1186/s40168-018-0571-8) contains supplementary material, which is available to authorized users.

The human gut microbiome is a complex ecosystem that harbors hundreds of bacterial taxa and is tightly linked to our health [1, 2]. Efforts to characterize the composition of the microbiome, using either marker gene-based approaches or shotgun metagenomics, have found not only compositional shifts associated with host disease, but also tremendous variation across healthy individuals [1, 3]. Indeed, early attempts to identify a core microbiome—a set of species that are shared between all healthy hosts—were generally unsuccessful, suggesting that such shared species comprise only a small fraction of the overall microbiome composition [4–6].

To this end, here we develop a computational framework to characterize the distribution of species across microbiome samples and to identify groups of microbial species whose distribution potentially reflects a competitive lottery schema. We defined the groups taxonomically as it has previously been found that the strongest priority effects occur between closely related bacteria [26]. Moreover, phylogenetically related species are more likely to have similar sets of genes and accordingly, similar niches. For example, it has been shown that a group of genes that includes many ABC transporters and two-component systems (which are involved in sensing nutrient levels and are likely related to niche space) is primarily conserved within the Vibrionaceae family but not in more distant relatives [33]. Similarly, a microscopy study has shown that different Bacteroides species overlap in spatial organization within the gut [34], further supporting the notion that closely related species are more likely to compete for a shared niche. Applying this framework to thousands of metagenomic samples from the gut microbiome, we found that indeed, different microbial clades follow different schemas and that while most of the common gut-dwelling microbial clades do not appear to follow the lottery schema, several less well-studied groups exhibit strong lottery-like-induced assembly patterns.

Our model of microbiome assembly assumes a collection of species, which are divided into several groups. These groups may represent phylogenetically related species or guilds of unrelated species that compete for similar niche space. Our model further assumes that the abundance of each species in the microbiome is determined by a two-step assembly process. The first step determines the abundance of each group based on, for example, the total niche space available to that group (Additional file 1: Figure S1A; note that when discussing abundances, we are always referring to “relative” abundances). Once the group abundance has been determined, a second step takes place where the abundance of each group is divided between the group’s species following a specific schema, which could be the competitive lottery schema (Additional file 1: Figure S1B) or some other unknown schema. These schemas reflect within-group ecological processes such as competition for this niche space or commensal interaction. Importantly, we assumed that different groups may be governed by different schema but that the same group is governed by the same schema in all samples (reflecting inherent ecological or functional attributes of that group). We further assumed that the two assembly steps are completely independent and focus on identifying the ecological processes that govern the second step of assembly.

To more closely explore the structure of genera with high vs. low winner prevalence (and high vs. low winner diversity), we further examined the distribution of OTUs in each genus, highlighting the different patterns governing OTU abundances (Fig. 2). In Akkermansia (a genus identified above as having a high winner prevalence and high winner diversity), for example, a single OTU clearly occupies the majority of this genus’ abundance in each sample and the lottery winner OTU varies from sample to sample, as predicted by the competitive lottery schema (Fig. 2a). This is in sharp contrast to genera with very low winner prevalence such as Blautia, where the group abundance is more evenly distributed among the group OTUs (note that in Fig. 2a, samples and OTU are ordered to emphasize any potential lottery pattern). The difference in OTU distribution between these two genera is even clearer when visualizing the fraction of the group abundance captured by the most abundant OTU in the sample and comparing it to the abundance of the other OTUs (Fig. 2b). Indeed, in Akkermansia, the most abundant OTU in each sample generally captures ~ 100% of the group’s abundance, whereas in Blautia, the most abundant OTU generally coexists with other OTUs (Fig. 2b). We again confirmed that this is not an artifact of the higher number of OTUs included in Blautia compared to Akkermansia (see Additional file 2: Supporting Text and the plots for these two genera in Additional file 5: Figure S4). To further quantify this effect, we calculated the Shannon diversity observed in each sample within these genera, again demonstrating a markedly skewed distribution toward low diversity (namely a single OTU) in Akkermansia compared to a more even distribution observed in Blautia (Fig. 2c). Examining the distribution of OTU abundances across all genera further revealed both additional clear cases of lottery-based assembly and more complex patterns (Fig. 3 and Additional file 5: Figure S4). For example, OTU abundance distributions in Phascolarctobacterium, Serratia, and Dialister exhibit all the hallmarks of lottery-based assembly, including complete exclusion and high diversity of winners. In contrast, in Acinetobacter and in Porphyromonas, some OTUs show nearly complete exclusion, whereas others show very little exclusion. Finally, the OTU distribution in Haemophilus clearly reflects the single lottery winner suggested by the genus’ low winner diversity reported above.

To more comprehensively characterize the ecological processes that are at play in the assembly of the gut microbiome, we next examined whether a similar lottery schema may govern the assembly of higher-level taxonomic groups. Indeed, our initial focus on genus-level groups was arbitrary, and a broader characterization of taxonomic groups across the microbial tree of life can provide a more complete picture of the assembly mechanisms of the human gut microbiome. Such a characterization will also allow us to examine the consistency of assembly schemas across different taxonomic lineages and to identify interesting patterns in the evolution of assembly rules.

Note also that our definition above allows for complex hierarchical patterns of assembly schemas (Additional file 7: Figure S6). For example, the order Lactobacillales exhibits clear coexistence patterns with multiple families from this order co-occurring in each sample, yet some of these families (e.g., Lactobacillaceae and Streptococcaceae) in turn exhibit lottery-like assembly, with only one genus from each family present in each sample (Additional file 6: Figure S5 and Additional file 7: Figure S6). Furthermore, while the family Streptococcaceae exhibits lottery-based assembly, with the genus Streptococcus generally excluding the genus Lactococcus, the different OTUs in the genus Streptococcus tend to coexist (see Fig. 3).

We next set out to confirm that our findings are not specific to the American Gut data due to cohort-specific population structure or study-specific protocols. For example, in the American Gut project, samples have been collected without freezing, in contrast to most other large-scale microbiome studies. Such differences in sample preservation could impact growth conditions post-egestion and ultimately affect observed within-group abundance distributions. Similarly, different sequencing methods or different computational processing pipelines could impact inferred community compositions and introduce bias into the estimated lottery parameters. To this end, we further obtained several other microbiome datasets, characterized the assembly of phylogenetic groups in each such dataset, and compared the obtained lottery parameters across datasets (Fig. 5). Notably, different datasets may include a somewhat different set of OTUs and accordingly a different set of groups that can be compared given our filtration process. We first considered an independent 16S-based gut microbiome dataset, obtained from a twin study in the UK [39]. We focus on this dataset because of the large number of samples (n = 1017 using the same 5000 read cutoff as above). Calculating the lottery measures defined above for all groups in this dataset, we found a strong correlation between the lottery prevalence parameter in the American Gut data and in the UK twins data (Fig. 5a, ρ = 0.93; Spearman correlation test), suggesting that a similar suite of groups may be assembled according to a lottery-like model. We next considered the human microbiome project (HMP; [1]), which is commonly used as a benchmark for human microbiome studies. Again, we found a strong correlation between the lottery prevalence values calculated for the HMP and the American Gut dataset (Fig. 5a, ρ = 0.91). Since species interactions that give rise to a lottery-like distribution probably primarily occur between species that are at close proximity, we further considered a gut microbiome dataset that was obtained from biopsies [40] (rather than fecal samples), allowing us to evaluate whether our findings hold in microbiome profiles sampled from regional microenvironments in the gut. Even though this dataset is naturally substantially smaller (n = 23 after our filtration process), we still found a good correspondence between the winner prevalence parameter in these biopsy samples to those calculated based on the American Gut data (Fig. 5a, ρ = 0.85).

Finally, we sought to investigate whether our results are sensitive to the OTU processing approach and taxonomic annotations used (Fig. 5d). We focused on the UK twin dataset discussed above (which was originally clustered into OTUs by Qiita and annotated by the GreenGenes taxonomy) and examined whether using instead a sequence denoising approach (Deblur; [47]) or a different taxonomy (SILVA; [48]) impacts the obtained lottery parameters. We found a strong and significant correlation between the lottery parameters obtained in the original UK twin datasets to those obtained with sequence denoising or SILVA (lottery prevalence ρ = 0.93 and ρ = 0.77, respectively; lottery diversity ρ = 0.70 and ρ = 0.50, respectively), suggesting that our findings are not an artifact of a specific processing pipeline. Moreover, the few instances where groups displayed substantial differences in winner prevalence (e.g., Porphyromonadaceae, which exhibited high winner prevalence when annotated with GreenGenes but low winner prevalence when annotated with SILVA) appear to occur due to additional annotations to these groups in SILVA.

Why would the niche space available to lottery-like groups such as Akkermansia, Dialister, and Phascolarctobacterium only support a single OTU, while the niche space available to non-lottery-like groups such as Bacteroides, Parabacteroides, and Faecalibacterium allows multiple species to colonize the same community? One possibility is that coexisting species can exploit a more diverse set of resources and therefore partition their niche, allowing multiple species to inhabit it [18, 49]. Species in lottery-like groups, in contrast, may have a narrower and overlapping nutritional niche, promoting fierce competition and mutual exclusion. This hypothesis is also in line with previous theories concerning the different strategies specialists and generalists species may employ to compete for nutrients. For example, a recent large-scale metabolic modeling-based study of bacterial ecological strategies has demonstrated that metabolic variability is correlated with growth rate and with competition [50]. It suggested that microorganisms may adopt one of two strategies: a specialist strategy that is associated with little co-habitation (analogous to our lottery-like schema) or a generalist strategy that is associated with fast growth and intense co-habitation (analogous to our non-lottery-like schema). Similarly, an assay discussing oligotrophs vs. copiotrophs (organisms that thrive in nutritionally poor vs. rich environments, respectively) suggested that one of the key reasons underlying the different environments in which such organisms survive has to do with the efficiency with which they compete for certain nutrients [51].

This analysis demonstrated that species in lottery-like genera have significantly fewer genes compared to species in non-lottery-like genera (Fig. 6a; P < 0.005). This simple, yet important difference between species in lottery vs. non-lottery-like groups is in agreement with our hypothesis above, suggesting that competitive lottery groups tend to represent more specialized and streamlined species that cannot partition their niche. Furthermore, we found that this difference in the number of genes is not uniform for all genes and that it is much more pronounced for genes without a KO annotation, suggesting that the coexistence of species in non-lottery-like groups may involve novel and yet-to-be-characterized mechanisms (Fig. 6b; P < 0.05 for KO-annotated genes, P < 0.005 for genes with no KO annotation).

In this paper, we used a simple model for the assembly of the human gut microbiome to assess how well different groups follow the competitive lottery schema. We found that the canonical microbiome members from the Bacteroidetes and Firmicutes phyla do not appear to be governed by a lottery-like schema but rather support a non-lottery-like assembly that supports significant coexistence among members. This result is perhaps not surprising given the current state of knowledge of the microbiome and numerous studies that report various species coexistence patterns and analyses [54]. Importantly, however, we did find a substantial number of taxonomic groups that exhibit lottery-like distribution, including the genera Akkermansia, Dialister, and Phascolarctobacterium. In these lottery-like genera, the entirety of the group’s abundance quota is occupied by a single OTU (though this OTU may be different in each sample), and all other members are excluded from the community. Notably, a few of the identified lottery-like groups, such as Phascolarctobacterium, tend to be understudied compared to the non-lottery-like groups and relatively little is known about their ecology, niche, and interactions with other species. Other lottery-like groups are relatively well characterized, such as Akkermansia, whose members are metabolically flexible and play a role in the host metabolic health [55]. Moreover, some of the identified competitive lottery groups have unusual properties. For example Dialister and Phascolarctobacterium from the Veillonellaceae family are gram-negative members of the gram-positive Firmicutes phylum, and yet form endospores, which is generally considered a gram-positive trait [56].

Our analysis has focused on testing a simple assembly schema and on identifying groups that are likely governed by the lottery schema. Importantly, however, there are likely many other processes that are at play in the assembly of the human gut microbiome. Moreover, while the competitive lottery assembly schema assumes that strong priority effects lead to complete exclusion of all species beyond the first, it is important to note that priority effects can also have different outcomes. For example, positive priority effects, where a colonizing species aids subsequent species to join the ecosystem, may give rise to highly structured communities. For example, the plant Jacobaea vulgaris alters the soil conditions allowing other plant species to flourish [69]. There could also be a complex mixture of positive and negative priority effects that depend on the exact species of the group. For example, the oral bacterium Porphyromonas gingivalis usually cannot grow in the presence of Streptococcus oralis, but it is able to coexist with S. oralis in the presence of S. gordonii [70]. Furthermore, our hierarchical method shows that assembly schema can impose different structuring forces at different taxonomic levels, and thus, identifying the scope at which any given assembly schema can function is an avenue for future research.

Beyond the findings described above, our study demonstrates the utility of a computational approach for understanding assembly processes in the human gut. Specifically, by assessing the competitive lottery schema and its fit to observed distribution of species abundances across samples, we were able to identify taxonomic groups that appeared to conform to this schema and others that diverged significantly from it. Future studies following this approach could further assess additional processes that are governing the assembly of the microbiome and their contribution to microbiome composition.

We downloaded processed 16S rRNA data from the Qiita database which has applied QIIME to detect closed reference OTUs at the 97% identity level [36]. Obtaining data from Qiita ensured uniformity of preprocessing across samples and datasets and in a way that is in harmony with the practices of the field. Specifically, we downloaded data from the American Gut project [35], a large study of twin microbiomes from the UK [39]. Finally, we obtained a dataset of biopsy samples from the human colon [40], as well as data from the Human Microbiome Project [1], and applied QIIME to detect closed reference OTUs at the 97% identity level. We removed samples with less than 5000 16S counts and filtered any OTU that did not appear at > 0.05% abundance in 0.5% of samples (to a minimum of 10 samples), resulting in a total of 1514 OTUs across 7781 samples from the American Gut project, 1201 OTUs across 1017 samples from the UK twins study, 793 OTUs across 284 samples from the HMP dataset, and 78 OTUs across 23 samples for the biopsy data for downstream analysis. To focus on taxonomic groups for which statistical analysis could be robust, we further filtered groups that did not have > 0.5% abundance in at least 0.5% of samples (to a minimum of 10 samples). Furthermore, due to the large number of groups in the American Gut data, for simplicity, only groups that had > 0.5% abundance in > 200 samples were included in our analysis.

We also obtained shotgun metagenomic samples from infant microbiomes that were sampled over time. These were amalgamated from a number of different studies including a study of vertical inheritance [41], a study of autoimmune diseases [42], a study of antibiotic usage [43], and a study of the development of type 1 diabetes [44]. MetaPhlAn 2.0 was run on these samples to assess species-level abundance with default parameters. Using similar filtering criterion as with the 16S data described above resulted in 437 OTUs across 171 samples for downstream analysis. In our turnover analysis, we only considered those individuals with at least two time points with at least 0.5% group abundance for each group, resulting in 287 individual-group pairs in the infant dataset and 70 in the HMP dataset for downstream analysis. For these individual-group pairs, we looked for at least two time points with different lottery winners dominating the community (> 90% abundance). However, when visualizing the data, we kept the full complement of time points from that subset of individuals in our analysis.

Our model aims to describe the observed abundance of the most prevalent OTUs across microbiome samples based on an assembly process such as the competitive lottery schema. We assume that this assembly process determines the abundances of OTUs within a given group and that the same group follows the same process in all samples. Specifically, we assume a two-step model: in the first step, the total abundance of a sample (100%) is allocated between groups according to some unknown process. Then in the second step, the abundance allocated to each group is split between the group’s members according to a competitive lottery schema.

In analyses that required classifying groups into lottery-like vs. non-lottery-like groups, we defined lottery-like groups as those that exhibit winner prevalence > 0.75 and winner diversity > 0.25. In our analysis of genome content, we specifically focused on groups that exhibit lottery-like assembly in both the American Gut dataset and at least one other dataset of those analyzed above.

We obtained 16S sequences from the partial or complete genomes of 76,657 bacteria from NCBI. In order to map OTUs from a group to sequenced genomes, we used BLAST against the database of 16S sequences and accepted the best hit above 97% identity. We then obtained information on gene content on those genomes from Integrated Microbial Genomics (IMG) [53] and averaged gene content number over each species.



This work was supported by the NIH New Innovator Award DP2AT00780201to EB and by the NIH grant 1R01GM124312–01 to EB. AJV was supported by a postdoctoral fellowship from the Natural Sciences and Engineering Research Council of Canada (NSERC).

The 16S datasets analyzed in the this study were obtained from: https://qiita.ucsd.edu/study/description/10317, https://qiita.ucsd.edu/study/description/2014, https://www.ebi.ac.uk/ena/data/view/PRJEB15003, https://www.ebi.ac.uk/ena/data/view/PRJEB6705, and https://portal.hmpdacc.org/.

The shotgun metagenomic datasets analyzed in the current study are available in the DIABIMMUNE and European Nucleotide Archive repositories: https://pubs.broadinstitute.org/diabimmune/three-country-cohort/resources/metagenomic-sequence-data; https://pubs.broadinstitute.org/diabimmune/t1d-cohort/resources/metagenomic-sequence-data; https://pubs.broadinstitute.org/diabimmune/antibiotics-cohort/resources/metagenomic-sequence-data; https://www.ebi.ac.uk/ena/data/view/PRJEB6456.

Not applicable.

Not applicable.

The authors declare that they have no competing interests.

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

