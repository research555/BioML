Metabolic modelling reveals broad changes in gut microbial metabolism in inflammatory bowel disease patients with dysbiosis

Inflammatory bowel diseases, such as Crohn’s Disease, are characterised by an altered blood and faecal metabolome, and changes in gut microbiome composition. Here, we present an efficient, scalable, tractable systems biology framework to mechanistically link microbial strains and faecal metabolites. We retrieve strain-level relative abundances from metagenomics data from a cohort of paediatric Crohn’s Disease patients with and without dysbiosis and healthy control children and construct and interrogate a personalised microbiome model for each sample. Predicted faecal secretion profiles and strain-level contributions to each metabolite vary broadly between healthy, dysbiotic, and non-dysbiotic microbiomes. The reduced microbial diversity in IBD results in reduced numbers of secreted metabolites, especially in sulfur metabolism. We demonstrate that increased potential to synthesise amino acids is linked to Proteobacteria contributions, in agreement with experimental observations. The established modelling framework yields testable hypotheses that may result in novel therapeutic and dietary interventions targeting the host-gut microbiome-diet axis.

The human gut microbiome plays an important role in human health and disease. It performs important functions, such as maturation of the host immune system, digestion of food, synthesis of short-chain fatty acids, vitamins, and amino acids, and protection against pathogens1,2. Changes in microbiome composition have been linked to complex multifactorial diseases, e.g., type 2 diabetes, metabolic syndrome, and non-alcoholic fatty liver syndrome2,3, as well as inflammatory bowel disease (IBD)4. IBD can be separated into two subtypes, Crohn’s Disease and ulcerative colitis4. Factors contributing to the IBD pathogenesis include genetics, diet, lifestyle, and the gut microbiome5. There is an urgent need for a mechanistic understanding of the role of these complex host-microbiome–environment interactions in IBD6. Ultimately, personalised treatment approaches targeting the diet-host-microbiome axis are needed6. A number of studies have reported differences in the abundances of certain taxa between IBD patients and healthy controls, identified through 16S rRNA sequencing or metagenomic approaches6–8. However, metagenomic approaches alone are insufficient to infer the functional metabolic activity of the microbiome6. Thus, functional, pathway-based analyses are required to elucidate not only the changes in composition in the gut microbiomes of IBD patients but also the metabolic changes that could serve as a target for therapeutic interventions.

Previously, Lewis et al.8 have performed metagenomic sequencing of the microbiomes of paediatric Crohn’s Disease patients and healthy control children and found that the Crohn’s Disease microbiomes stratified into two clusters, i.e., a “near cluster”, which resembled the healthy microbiomes in composition and a “far cluster” characterised by microbial dysbiosis that was distinct in composition from both healthy controls and the near cluster microbiomes. Based on these results, they separated the patients into two groups, “non-dysbiotic” and “dysbiotic” IBD8. We have previously constructed personalised models for a subset of 20 dysbiotic Crohn’s Disease and 25 healthy control microbiomes from this cohort24. We have then applied the COBRA approach to predict the bile acid deconjugation and biotransformation potential of each sample24. The computational modelling stratified the Crohn’s Disease microbiomes and healthy microbiomes by their bile acid metabolism profiles24. Here, we substantially expanded the computation of metabolic profiles to a wide variety of metabolic subsystems. We systematically predicted the potential of each microbiome to secrete and take up all metabolites, for which biosynthesis pathways and transport reactions were present in the community models and identified the metabolites that best stratified the dysbiotic and non-dysbiotic individuals. For all secreted metabolites, we computed the respective contributing strains in each microbiome. Finally, we validated the predictions for amino acid metabolites against published metabolomic data from the same cohort. Taken together, we present a computational systems biology approach that bridges the gap between metagenomic and metabolomic data and provides mechanistic, testable hypotheses for metabolite–microbe associations.

In this study, we aimed at improving the understanding, which microbial metabolites may be altered in IBD due to altered faecal microbial community structure. Therefore, we predicted the metabolic profile, i.e., the combined quantitative potential of all community members to take up dietary metabolites and secrete metabolic end products, as well as the strain-level contributions to these overall fluxes, of 108 analysed microbiomes, corresponding to 20 IBD microbiomes with dysbiosis, 63 non-dysbiotic IBD microbiomes, and 25 control individuals as defined in ref. 8 (Fig.
1, Methods). We stratified the 108 microbiomes according to the predicted metabolic profiles. We demonstrate that the metabolite profiles of microbiomes from individuals with IBD and dysbiosis were distinct from both healthy microbiomes and IBD microbiomes with dysbiosis and identify the features that best separate these groups. Finally, we compared our results with published metabolomic data from the same individuals. In agreement with published findings, we predicted that dysbiotic Crohn’s Disease microbiomes have an increased potential to synthesise amino acids.

First, we developed a large-scale, computationally efficient constraint-based modelling approach (Fig.
1). Briefly, we created a personalised microbiome model for each sample by mapping the relative strain-level abundances onto the reference set of reconstructed organisms and by then joining the corresponding AGORA reconstructions together as described previously24. A community biomass reaction was formulated that ensured growth of the strains at experimentally determined ratios (Methods). Each personalised microbiome model was further contextualised by simulating the intake of an Average European diet (Methods). The metabolic profile of each microbiome was then computed as follows: All dietary, faecal, and strain-specific exchange reactions present in the model were retrieved, and the minimal and maximal fluxes through these exchange reactions were computed using distributed flux balance analysis25 (Methods). This approach enabled a systematic evaluation of secretion potential, uptake potential, and strain-specific contributions for each metabolite that could be transported by at least one microbiome model. The modelling framework captured the range of metabolic capabilities encoded by the human gut microbiome, and the variation in metabolic potential as a function of microbiome composition.

Overall, the 108 microbiome models accounted for exchange reactions for 419 metabolites, for which the minimal and maximal fluxes were computed. We calculated the microbiomes’ theoretical potential to take up and secrete metabolites (Supplementary Table 1). Of the maximally possible 419 metabolites, 143 could be secreted into the faecal compartment by at least one microbiome but were not taken up, i.e., they were of microbial origin but not dietary. Another 59 metabolites could only be taken up by at least one microbiome and were thus only present in the simulated diet. Finally, further 86 metabolites were both taken up and secreted meaning they were both dietary and microbial of origin. The remaining 131 metabolites that could be neither taken up nor secreted either lacked the necessary biosynthesis precursors in the given dietary input or were dead-end metabolites, i.e., metabolites that only be consumed or produced, in the corresponding AGORA reconstructions. Some qualitative metabolite biosynthesis capacities were present in almost all microbiomes metabolite while others were rare (Supplementary Table 1). Taken together, the systematic in silico metabolic profiling predicted that the analysed microbiomes could convert the dietary inputs into a variety of metabolites from diverse subsystems.

Since the microbial composition of the dysbiotic and non-dysbiotic individuals clearly differed8, we expected these microbial differences to be reflected in the predicted metabolic profiles. We performed a statistical analysis (Methods) of the predicted uptake and secretion fluxes reported in Supplementary Tables 2–3. Of the 229 metabolites that were produced by at least one microbiome, 44 differed statistically significantly between the microbiomes of IBD patients and healthy controls (Wilcoxon rank sum test corrected for false discovery rate, Supplementary Table 4a). Moreover, 122 metabolites had statistically significantly different production potential in the dysbiotic compared with the non-dysbiotic IBD cluster (Supplementary Table 4b). Overall, the production potential for 139 metabolites differed between at least two of the three groups (Supplementary Table 4a, b). The clearer separation between the dysbiotic and non-dysbiotic IBD cluster than between healthy and IBD was in line with our expectations as the modelling framework was personalised with only the individuals’ gut microbial compositions and did not account for other factors (e.g., human metabolism and non-microbiome-mediated effects of medication). Taken together, dysbiotic IBD microbiomes were distinct in metabolite secretion potential as a direct consequence of their distinct microbial compositions.

To link the predicted metabolite secretion potential to specific microbes, we calculated the Spearman correlation between metabolite secretion and uptake potential and species abundances. Strong correlations (>0.75) between species and metabolites were found for 66 secreted metabolites (Fig.
3a). For instance, glycan degradation products strongly correlated with several Bacteroides spp., in agreement with Bacteroides being known glycan degraders32 (Fig.
3a). Secondary bile acids correlated with species known to biotransform bile acids (Fig.
3a) as observed previously24. As expected, methane correlated positively with Methanobrevibacter smithii33, and p-cresol correlated with the known p-cresol producer Clostridioides difficile34 (Fig.
3a). The remaining 163 secreted metabolites did not strongly correlate with specific species. Thus, the uptake and production of these metabolites was carried out by a combination of multiple taxa.

To explain the observed changes in metabolite secretion potential, we calculated and inspected the absolute presence of reactions in the microbiomes, as well as the quantitative reaction abundances on the whole community, class, and genus level. The absolute presence of 84 and 393 reactions was distinct between healthy and IBD and between the dysbiotic and non-dysbiotic IBD cluster, respectively (Fig.
3b and Supplementary Table 4b). Thus, the dysbiotic IBD microbiomes were depleted or enriched in the absolute presence of certain pathways. Specifically, reactions involved in glycan degradation were absent in most dysbiotic microbiomes (Fig.
3b).

The abundances of 460 reactions on the total community level, 868 reactions on the phylum level, and 37,059 reactions on the genus level differed significantly between healthy controls and IBD patients (Supplementary Table 4a). Moreover, 1397 reactions on the total community level, 5443 reactions on the phylum level, and 49,376 reactions on the genus level were different in abundance between the dysbiotic and non-dysbiotic IBD cluster (Supplementary Table 4b). The abundances of complete pathways were distinct between groups. For instance, amino acid biosynthesis and lipid metabolism pathways had higher abundances in the dysbiotic cluster (Supplementary Fig. 1). Taken together, the microbiomes of dysbiotic IBD patients were distinct in the qualitative and quantitative presence of key reactions and pathways, which explains their aforementioned altered potential to consume and secrete metabolites.

We hypothesised that the reduced species diversity in the IBD microbiomes with dysbiosis8 would also translate into reduced metabolic diversity and in a reduced number of secreted compounds. Thus, we further analysed the qualitative metabolic potential per microbiome discussed above. Indeed, the number of compounds that could be theoretically secreted by each microbiome was highly dependent on the number of strains found in the stool samples, showing a logarithmic dependency (Fig.
4a). Additionally, the metabolic diversity in dysbiotic IBD was more restricted as predicted from the loss in microbial diversity alone (b = −6.81, 95%CI:(−13.38;−0.25), t(105) = −2.06, p = 0.042) (Fig. 4a, b).

Concluding, community modelling delivers a methodology to investigate the metabolic diversity of microbial communities. We found that metabolic diversity is reduced in IBD, in particular in sulfur metabolism. We delivered evidence that the loss of chondroitin sulfate and heparan sulfate degrading species may be causal to the loss in metabolic diversity. These species should be therefore considered as corner-stone species within the human microbiome.

Faecal gut metabolite levels are altered in IBD patients, including many host-microbial co-metabolites, however, the contributions of specific microbes to these changes are often unknown9. To gain insight into which microbial taxa are responsible for the altered metabolic profiles in dysbiotic IBD patients, we modelled the strain-to-metabolite contributions directly by predicting the quantitative contribution of each strain to each secreted metabolite in each individual microbiome.

To summarise, we systematically interrogated the gut microbe-metabolite axis through constraint-based modelling. For each metabolite, the exact contributing strains were identified (Supplementary Figs. 3–7 and Supplementary Table 6). Overall, commensal and beneficial taxa contributed more to metabolites that are thought to be relevant for health (e.g., butyrate, B-vitamins), and taxa associated with dysbiosis (i.e., Proteobacteria, Bacilli) contributed more to potentially harmful metabolites, such as lactate, hydrogen sulfide, and TMAO.

It has been proposed that metabolic modelling could be used to link metagenomic and metabolomic findings38. Previously, faecal metabolomic profiles were for amino acids determined39 for the same cohort8 that we used in this study. The patients in the dysbiotic cluster had distinct faecal metabolomic profiles, which have been characterised by an increase in amino acids and amino acid derivatives39. Of the faecal amino acid metabolites measured metabolomically by Ni et al., 23 overlapped with metabolites secreted by the microbiome models (Supplementary Table 7). When comparing significant differences between the non-dysbiotic and the dysbiotic IBD cluster in the metabolomic data and in silico, findings agreed in 16 cases and disagreed in 7 cases (Supplementary Table 7), which refers to an agreement in 69.6%. However, this agreement failed narrowly to be significantly different from an agreement by chance (Fisher’s exact test: p = 0.086), and future studies with bigger sample size are needed to corroborate the effectiveness of COBRA modelling to predict metabolomic changes in IBD. In agreements with metabolomic findings, we predicted an increased potential to synthesise betaine, glutamate, glycine, leucine, phenylalanine, and tryptophan in the dysbiotic IBD cluster (Fig. 2a, b and Supplementary Table 4b). The model additionally predicted that aspartate, GABA, isoleucine, and tyrosine were higher in the dysbiotic cluster (Supplementary Table 7). While faecal metabolomic concentrations of these amino acids did not reach significance when comparing between the non-dysbiotic and dysbiotic cluster, they were significantly different between healthy controls and IBD cases39. Note that it was not possible to compare secretion fluxes with the raw metabolomic data as the latter was not available.

Ni et al.39 also reported that faecal amino acid concentrations correlated with the abundance of Proteobacteria species and with the severity of the disease. Based on these findings, they proposed that increased proteobacterial utilisation of nitrogen for amino acid biosynthesis plays a role in the development of dysbiosis and Crohn’s Disease39. We computed the quantitative microbial contributions to the 23 amino acid metabolites that overlapped between in silico computed metabolites in this study and experimentally measured metabolites39. The proteobacterial contributions to amino acid metabolites were indeed substantially increased in the dysbiotic cluster (Fig.
5b). In contrast, in the healthy controls and the non-dysbiotic IBD cluster, amino acids were mainly synthesised by Bacteroidetes and Firmicutes representatives (Fig.
5b). Next, the detailed contribution profiles on the strain level were extracted for the examples of glycine, phenylalanine, leucine, tyrosine, and tryptophan (Supplementary Figs. 8–12). In the healthy controls and in the non-dysbiotic cluster, these amino acids were mainly synthesised by commensal genera, such as Alistipes, Bacteroides, Faecalibacterium, and Roseburia spp. (Supplementary Figs. 8–12). In contrast, the dysbiotic cluster was enriched in contributions by opportunistic pathogens, such as Bacteroides fragilis, Escherichia, Haemophilus, Klebsiella and Streptococcus spp. (Supplementary Figs. 8–12). In summary, modelling revealed an increased biosynthesis potential for amino acids and increased proteobacterial contributions to amino acids in the microbiomes of patients with dysbiosis, in agreement with the findings of Ni et al.39.

We have systematically profiled the metabolic potential of 108 individual microbiomes in silico. The metabolic profiles varied greatly across individual microbiomes reflecting the variation in microbial composition. We determined the net production and uptake potential of each microbiome, the qualitative and quantitative presence of reactions and pathways in each microbiome, the correlations between net production potential and reaction abundance, and finally the quantitative contributions of all strains present in the microbiomes to all secreted metabolites.

While our results provide additional evidence that the gut microbiome influences the faecal metabolome, it is also influenced by host metabolism and diet. We have recently demonstrated that microbiome models as well as dietary information and physiological data can be integrated with a whole-body metabolic model of human, enabling personalised, organ-resolved predictions of host metabolic states46. The whole-body human model also allows the personalised prediction of the urinary, blood and serum metabolomes46, which have been reported to be altered in IBD patients47–50. Integrated host-microbiome metabolic modelling will allow the personalised prediction of these host blood, urine, and tissue metabolomes as a function of dietary input and microbial activity. Ultimately, an iterative pipeline of computational predictions and experimental validation may yield in the discovery of novel therapeutic and dietary interventions targeting the host-gut microbiome-diet axis.

Paired end Illumina raw reads of 83 IBD patients in the PLEASE cohort8 and of 25 healthy controls in the COMBO cohort51 had been previously retrieved from NCBI SRA under SRA: SRP05702720. The reads had been preprocessed and mapped onto the reference set of AGORA genomes20. Publicly available metadata for the samples was retrieved from https://github.com/chvlyl/PLEASE and the sample stratification into the groups control, cluster 1 (non-dysbiotic IBD), and cluster 2 (dysbiotic IBD) was adapted as defined by the original authors8.

Personalised models for the 108 samples were created using Version 1.03 (published on 25.02.2019, available at https://www.vmh.life) of the AGORA resource18. To build the personalised models, the COBRA Toolbox52 extension Microbiome Modelling Toolbox14 was used. Personalised microbiome models were created in MATLAB (Mathworks, Inc.) version R2018b using the mgPipe module, as described previously24. Each personalised model contained a community biomass reaction, which was parameterised by applying the strain-level abundances as stoichiometric values for each microbe biomass reaction in the community biomass reaction. These constraints enforced that all strains grew at the experimentally measured ratios. The models were further contextualised as follows: To simulate a realistic intake of dietary nutrients in mmol per g dry weight per hour in the 108 microbiome models, an Average European diet was retrieved from the Diet Designer resource on the Virtual Metabolic Human17 website (https://www.vmh.life). The diet was converted to uptake fluxes through a dedicated Microbiome Modelling Toolbox function (convertVMHDiet2AGORA.m). Moreover, to account for host metabolism, the uptake of metabolites of host origin known to be present in the intestine (e.g., primary bile acids, host glycans) were allowed using standard COBRA Toolbox functions52. Finally, to simulate a realistic turnover of microbial biomass, the allowed flux through the community biomass reaction was set to be between 0.4 and 1 (mmol/person/day), corresponding to a faecal emptying of once every three days to once a day.

Absolute reaction presence and reaction abundances on the total community, phylum, and genus level were calculated in MATLAB using dedicated Microbiome Modelling Toolbox functions (calculateReactionPresence.m, calculateReactionAbundance.m). The computation of the total community metabolite production potential, total community metabolite uptake potential, and the contribution of each strain to each metabolite was performed in Julia v0.6.4 (https://julialang.org) using the Julia implementation of flux balance analysis, COBRA.jl53. COBRA.jl was performed on a high-performance cluster using the IBM CPLEX solver (IBM, Inc.) through the CPLEX interface for Julia. A customised Julia script was used that retrieved all dietary exchange reactions, faecal secretion reactions, and strain-specific internal exchange reactions for each microbiome model. This resulted on average in 13,677 exchange reactions per microbiome model, which were then each minimised and maximised using distributed flux balance analysis53. The fluxes were exported from Julia using the customised Julia script and further analysed in MATLAB.

Wilcoxon rank sum test, and correction for false discovery rate (FDR) were performed in MATLAB using the ranksum and mafdr functions, respectively. Correlations between computed fluxes and species abundances were calculated using a dedicated Microbiome Modelling Toolbox function (correlateFluxWithTaxonAbundance.m).

In a third step, we counted the number of sulfur-containing metabolites independently secreted for each microbiome. We tested this number on association with the study group in linear regressions. Furthermore, we explored the classification of healthy microbiomes vs. dysbiotic IBD microbiomes in logistic regression by the number and calculated the area under the curve (AUC) as metric of classification accuracy. Then, we analysed the pattern of final breakdown products of sulfur metabolism (hydrogen, sulfide, sulfate, methanethiol, sulfite, and thiosulfate) across the three study groups via Fisher’s exact test. Finally, we checked whether the presence of any glycan-degrading species statistically mediated the effects of the study group variable via the Sobel Goodman test, deriving the confidence intervals by non-parametric bootstrapping with 1000 replications54. These analyses were performed in STATA 14\MP (Stata Inc., College Station, USA).

Random forests analysis was performed using the online implementation of MetaboAnalyst 5.031 (https://www.metaboanalyst.ca), which relies on the MetaboAnalystR55 package. Briefly, the random forests classifier is built using a customisable number of trees with one-third of the data left out of the bootstrap sampling process. The left-out data is then used to estimate the out-of-bag (OOB) error. Metabolite secretion fluxes were imported through the Statistical Analysis module in the MetaboAnalyst interface without performing normalisation, transformation, or scaling of the data. The classifier was built with 5000 trees and the resulting visualisation of features ranked by their contributions to classification accuracy was exported.

Phylum to amino acid and subsystem contributions were visualised using the online implementation of Circos56 (http://circos.ca). All other data was visualised in MATLAB version R2018b and in R version 3.5.357 (https://www.r-project.org).

Further information on research design is available in the Nature Research Reporting Summary linked to this article.

Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

The online version contains supplementary material available at 10.1038/s41540-021-00178-6.

