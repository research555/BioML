Delivery mode and perinatal antibiotics influence the predicted metabolic pathways of the gut microbiome

Delivery mode and perinatal antibiotics influence gut microbiome composition in children. Most microbiome studies have used the sequencing of the bacterial 16S marker gene but have not reported the metabolic function of the gut microbiome, which may mediate biological effects on the host. Here, we used the PICRUSt2 bioinformatics tool to predict the functional profiles of the gut microbiome based on 16S sequencing in two child cohorts. Both Caesarean section and perinatal antibiotics markedly influenced the functional profiles of the gut microbiome at the age of 1 year. In machine learning analysis, bacterial fatty acid, phospholipid, and biotin biosynthesis were the most important pathways that differed according to delivery mode. Proteinogenic amino acid biosynthesis, carbohydrate degradation, pyrimidine deoxyribonucleotide and biotin biosynthesis were the most important pathways differing according to antibiotic exposure. Our study shows that both Caesarean section and perinatal antibiotics markedly influence the predicted metabolic profiles of the gut microbiome at the age of 1 year.

The perinatal period plays a critical role in gut microbiome development. Several studies have shown that the gut microbiome composition of infants delivered by Caesarean section (C-section) shows a reduced diversity1,2, lower relative abundance of Bacteroides1–5 and a higher relative abundance of Enterococcus2,3,5, Klebsiella3,5 and Clostridium3,4 as compared to that of vaginally delivered infants1,3. Currently, perinatal antibiotics are frequently used during both vaginal deliveries and C-sections to prevent early-onset group B streptococcal (GBS) sepsis and after birth to treat suspected neonatal infections6. Intrapartum antibiotic prophylaxis (IAP), administered to mothers during delivery to prevent GBS transmission to newborn infants, has been associated with reduced gut microbiome richness7 and diversity8–10, lower relative abundance of Bacteroidetes7,8,11 and Bacteroides3,7,10,11 and a higher relative abundance of Proteobacteria8,9 and Firmicutes9,11 in term vaginally delivered infants.

Our hypothesis was that early perinatal events may markedly change the metabolic pathways of the gut microbiome and influence the later health of children. In the present study, we characterized and compared the effects of delivery mode and perinatal antimicrobial exposure on the predicted metabolic pathways of the gut microbiome in infants at 1 year of age.

We used predicted functional profiles of gut microbiomes based on 16S data from two prospective cohorts from our laboratory.

Because microbiome data are high-dimensional, complex, noisy and compositional in nature20,21, increasing the false discovery rate of conventional hypothesis testing methods22, we used a machine learning (ML) approach in this analysis21,23,24. Sequence pre-processing and strict quality filtering settings in this study were designed to decrease data dimensionality and sparsity. These upstream choices increase machine learning model performance and interpretability, and as such, differ from previously published work for perinatal antibiotics11,19. As a result, features that were rare and found in low prevalence were filtered out. We now present side-by-side results from ANCOM2, ALDEx2, and beta diversity for both cohorts to increase the interpretability of the machine learning models, and effectively showcase the differences in the PA and DM results.

Raw sequences from both datasets were imported into Qiime225 (version 2019.10), where they were processed independently from each other. Sequencing primers were trimmed before denoising with the q2-dada2 -plugin. Reads shorter than 270 bp were truncated in the PA cohort and reads shorter than 385 bp were truncated in the DM cohort with an additional 15 bp trimmed from the left side during DADA226. Any quality filtering was avoided before using DADA2.

Taxonomic classifiers were trained using the 132 SILVA27 database trimmed to the study primers and truncated using the DADA2 parameter values for truncation and filtering. DADA2 outputs an ASV-table (Amplicon Sequence Variant), which represents the abundances of biological features found from the raw sequences. Features from the ASV-tables were assigned taxonomies and those features were then classified into domains. Features classified as Bacteria and those found in more than one sample were kept. Chimeric features were removed with the q2-vsearch-plugin using the uchime-denovo tool. Samples with a combined feature frequency of less than 1000 were removed. The PA cohort had 1037 minimum depths, while the DM cohort had 1290. We chose 1000 as the depth because it was near to the minimum and fit our analysis methods. Unstratified MetaCyc28 pathway abundances were predicted using the q2-picrust2-plugin using the “mp” hidden-state prediction method with other parameters set to default values. Stratified results, which map each predicted pathway back to the input ASV’s, were produced using the original python implementation of PICRUSt215 with the same parameters. ASV and metabolic pathway feature tables from both cohorts were independently analysed.

ASV-tables and predicted pathway tables were used in both alpha and beta diversity analyses in both cohorts. Bray–Curtis dissimilarity was chosen for both types of feature tables for beta diversity, while Shannon index was chosen for alpha diversity. Feature tables were rarefied to depths of 1000 and 10,000 in ASV-tables and predicted pathway tables, respectively. Principal coordinates analysis (PCoA) was done for Bray–Curtis dissimilarity distance matrices. Alpha and beta diversity analyses were done using the q2-diversity-plugin and visualized with Matplotlib29.

The Kruskal–Wallis H test was performed to test within-sample group differences for alpha diversity. Adonis PERMANOVA analyses were done using the pairwise beta-diversity-significance command in q2-diversity to test group differences. Adonis PERMANOVA was used for multivariate analysis using both perinatal antibiotic exposure and delivery mode in DM cohort, while only perinatal antibiotics was used with the PA cohort. PCoA analysis was performed with the beta diversity distance matrix and visualized with ellipses drawn onto the two-dimensional space using the Pearson correlation coefficient of the two principal coordinates with the highest explained variance.

ALDEx230 and ANCOM22 were used for differential abundance analysis to examine group differences in both genus level and predicted pathway data. Features that were found in 10% or more samples were kept. ALDEx2 analyses were done using the q2-aldex2-plugin with a Q-score significance threshold of 0.05. ANCOM2 (further developed based on ANCOM22) analyses were done using the R-package31 with default parameters. For DM cohort the ANCOM2 analyses were adjusted according to perinatal antibiotic treatments. ANCOM2 calculates a threshold value for the proportion of feature ratios that show significant differences. Prior to testing, we chose the value of 0.7 or higher as the significant value, meaning that when output was 0.7 or higher, ANCOM2 found the feature to be significantly different between study groups. Values below 0.7 were considered non-significant. A significance threshold of 0.7 was recommended by the author of ANCOM231 as a common choice. ALDEx2 uses p-values from Benjamini–Hochberg adjusted (to control false discovery rate) Welch t-tests (p-value of < 0.05 was considered significant prior to testing). Additionally, ALDEx2 outputs the effect size, which indicates the direction and volume of change of the centred log-ratios. In our study, a positive sign indicated that the feature was more abundant in the C-section or perinatal antibiotics treatment group whereas a negative sign indicated greater abundance in their respective control groups (i.e., vaginal birth and no-perinatal antibiotics treatments).

Machine learning models were trained to predict the target variables of delivery mode and perinatal antibiotic treatments in DM and PA cohorts, respectively. Models were created using a nested cross-validation (CV) setting where parameters were only tuned using the inner cross-validation loop. Random Forest (RF)32, Extremely Randomized Trees (EXTRA)33 and Adaptive Boosting (Adaboost)34 models were tuned and trained independently of each other. Model performance was tested against the validation fold that was unseen to the models. Performance was evaluated using the Receiver Operating Characteristic (ROC) of the Area-Under-the-Curve (AUC). Model selection was only done in the inner CV folds using the ROC AUC metric. Machine learning analyses were implemented using the scikit-learn package35. Rank aggregation analysis was used to highlight the key shared features for Random Forest, ExtraTrees and Adaboost models during model training. The importance of each taxon or pathway feature was recorded and compiled in a rank aggregation analysis.

We aimed to find out whether similar machine learning models were able to differentiate the impact of both perinatal antibiotics and C-section on the predicted metabolic pathway composition of the gut microbiome using a cross-study prediction between two available cohorts. Machine learning models were trained using prevalence filtered feature tables from both taxon and pathway data. Models were given the task to differentiate positive (C-section and perinatal antibiotics treatment) and negative (vaginal delivery and no antibiotic treatments) classes from each other. In this analysis, we chose a prevalence level such that each feature needed to be found in a percentage of all samples in both cohorts to be included. Prior to model building, we tried prevalence cut-offs in the range of 10–50% in both taxa and pathway data. In previous studies, researchers have experimented with prevalence thresholds varying from 1 to 10% in one study36, while selecting as high as 45% in another37. We chose as high prevalence cut-offs as possible while leaving as many features as possible in both types of data. For metabolic pathway data, the percentage chosen for prevalence cut-off was 50% (240 features) and for taxa data, 30% (12 features). Prevalence thresholds and other data filtering choices were not readjusted after initial model building to prevent leaking information between training and testing folds. RF, EXTRA and Adaboost models were trained using only one cohort’s data using the same scheme described earlier. After each iteration of the nested cross-validation loop, the best RF, EXTRA and Adaboost models were combined into an ensemble classifier. This classifier was then used to predict a randomly sampled subset from the other cohort that was completely unseen by the models. Feature importances were estimated using the prefitted ensemble classifier with permutation_importance function from scikit-learn35. Next, we examined if models trained on the PA cohort were biased towards samples that had been exposed to perinatal antibiotics in the DM cohort. We pooled together all the test predictions from C-section and vaginal samples into two groups. Samples that had been exposed to perinatal antibiotic treatments and those that had not been exposed and produced the pooled AUC of both groups. There were no marked differences in the AUC when predicting DM cohort samples that had been exposed to perinatal antibiotics (0.71 AUC) to those that had not been (0.7 AUC).

First we analysed beta diversity, i.e., between-sample diversity, to examine differences in the taxonomic and metabolic pathway composition of the gut microbiome according to delivery mode (Fig. 1A,B, delivery mode cohort) and perinatal antibiotic exposure (Fig. 1C,D, perinatal antibiotics cohort) at the age of 1 year using principal coordinate analysis (PCoA).

Alpha diversity metrics, i.e., within-sample diversity, showed no significant differences for taxonomic or metabolic pathway data according to delivery mode or perinatal antibiotic exposure (Supplementary Fig. 1).

We then investigated which taxa and metabolic pathways of the gut microbiome were differentially abundant in the gut microbiomes of children depending on the delivery mode (C-section vs vaginal) or perinatal antibiotic exposure (any vs none) (Table
1, Supplementary Table 2). The full output of ANCOM2 and ALDEx2 can be found as “Supplementary Tables S1” (Supplementary Tables 3–10).

Bacteroides was significantly different depending on exposure to perinatal antibiotics (Table
1). When comparing metabolic pathways according to perinatal antibiotic exposure, we identified seven pathways as significantly different (Table
1), two of which were linked to vitamin B6 metabolism and two to carbohydrate degradation. Three pathways (biotin metabolism, biotin synthesis and glycosaminoglycan degradation) were significantly different according to both the delivery mode and perinatal exposure (Table
1). When we used ALDEx2 for comparisons, we found one genus and 25 differentially abundant metabolic pathways depending on the perinatal antibiotic exposure (Supplementary Table 2).

We used machine learning models on predicted metabolic pathways in gut microbiome to differentiate whether the child was born via C-section or vaginal route (Fig. 2A,B), or whether the child was exposed or unexposed to perinatal antibiotics (Fig. 2C,D).

Similarly, children exposed to perinatal antibiotics were well differentiated from those unexposed by using machine learning models on gut microbiome data at the age of 12 months. RF models trained using taxa to differentiate data by perinatal antibiotic exposure performed better (AUC of 0.69, SD = 0.04) than ExtraTrees or Adaboost (Fig. 2C). Additionally, RF was again the top performer with metabolic pathways in differentiating data by perinatal antibiotic exposure with an AUC of 0.74 (SD = 0.04) (Fig. 2D).

Machine learning models are often referred to black boxes, as the inner workings are often obscured or complicated to understand. Random forests and other decision tree-based algorithms have the benefit of providing continuous value for feature importance’s, effectively ranking how well each feature (genera or predicted pathway) affected the overall result. In rank aggregation analysis, the importance of each taxon or pathway feature in machine learning models was recorded and compiled (Fig. 3).

In both cohorts, there were multiple features with similar median ranks, indicating a high amount of collinearity in pathway data, where many features were correlated with each other. Rank aggregation values for each variable are reported in the “Supplementary File S1” (Supplementary Tables 11–14).

As the direct comparison of taxon or pathway data from the two datasets using conventional statistics is not optimal, even for datasets from the same laboratory, we then performed a cross-study comparison using machine learning to assess effects associated with delivery mode or perinatal antibiotic exposure (presented in Table
1 and Figs. 2,
3). We examined whether patterns found by machine learning models in one dataset for delivery mode could be generalized to the samples from the other cohort for perinatal antibiotic exposure and vice versa, possibly indicating analogous or similarly differentiating changes in gut microbiome after C-section or perinatal antibiotics as compared to those with undisturbed early gut colonization. We thus trained models on one cohort and tested them on the other cohort.

When using predicted metabolic pathway features, the cross-study models were able to predict cross-study sample classes as positive (C-section or any perinatal antibiotics treatment) or negative (vaginal delivery or no perinatal antibiotics treatments) (Fig. 4B). Models trained on differentiating perinatal antibiotic exposure (any vs none) were able to differentiate the delivery mode (C-section vs vaginal) with an AUC of 0.72, while models trained on delivery mode cohort achieved an AUC of 0.70 in differentiating perinatal antibiotic exposure (Fig. 5B).

We then analysed which features were most important for the performance of the models by using permutation importance analysis.

After shuffling, using metabolic pathway data, we found several features decreasing only slightly the performance of the model, with the largest average change of 0.03 to AUC for proteinogenic amino acid biosynthesis according to delivery mode (Fig. 5B) and 0.005 for biotin biosynthesis according to perinatal antibiotic exposure (Fig. 5D). In the DM cohort (C-section vs vaginal delivery), pathways related to proteinogenic amino acid biosynthesis, biotin biosynthesis and fermentation were the most important (Fig. 5B). In the PA cohort (any antibiotics vs none in vaginally delivered infants), pathways related to biotin biosynthesis, polysaccharide degradation, proteinogenic amino acid biosynthesis and pyrimidine nucleotide biosynthesis were the most important (Fig. 5D). Values for each tested variable are reported in the “Supplementary File S1” (Supplementary Tables 15–19).

Lastly, we present the relative abundances between study groups of genera and pathways that were found significantly different by ANCOM2 (Table
1) or important by machine learning models (Figs. 2 and
4). Additionally, the stratified relative abundance was gathered from PICRUSt2, which allows for a direct link from each predicted pathway back to the ASV’s. Bacteroides was differentially abundant in both DM and PA and was the most important feature of cross-study machine learning models. We additionally stratified the predicted pathway data according to Bacteroides to gain further insight.

Bacteroides was the only significantly different genera in PA cohort while also being important to machine learning models. Bacteroides had lower relative abundance (38% in perinatal antibiotics and 66% in no antibiotics) samples (Supplementary Table 19). Predicted pathways related to biotin metabolism, biotin biosynthesis, glycosaminoglycan degradation, vitamin B6 metabolism, and fatty acid biosynthesis pathways were decreased according to perinatal antibiotics usage. According to Bacteroides stratified data, a large portion of the above pathways relative abundances were derived from Bacteroides in both PA (37–97%) and non-PA groups (64–99%) (Supplementary Table 20). Pathways related to sugar degradation (GLUCOSE1PMETAB-PWY), pyrimidine deoxyribonucleotide biosynthesis (PWY-6545), and vitamin biosynthesis (PWY-6891) were enriched according to perinatal antibiotics usage.

Delivery mode and perinatal antibiotics have been shown to influence gut microbiome composition in children1–5,7–11. Most microbiome studies2,4,5,7–9,11 have used the sequencing of the bacterial 16S marker gene but have not reported the metabolic function of gut microbiome, which may mediate biological effects on the host. Whole genome sequencing of the gut microbiome would be an ideal solution but is still not feasible for every study or dataset14,38,39. Here, we used the PICRUSt215 bioinformatics tool to predict the functional profiles of the gut microbiome based on 16S sequencing in two prospective cohorts from our laboratory. Our study shows that both Caesarean section and perinatal antibiotics markedly influence the predicted metabolic profiles of the gut microbiome at the age of 1 year.

In conclusion, using two prospective paediatric cohorts, perinatal events, both Caesarean section and perinatal antibiotics, markedly influenced the functional profiles of the gut microbiome at the age of 1 year. The observed changes in metabolic pathways of gut microbiome may potentially influence the later health of children.



Publisher's note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.

The online version contains supplementary material available at 10.1038/s41598-021-97007-x.

