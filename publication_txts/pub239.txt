High throughput genome scale modeling predicts microbial vitamin requirements contribute to gut microbiome community structure



Human gut microbiome structure and emergent metabolic outputs impact health outcomes. However, what drives such community characteristics remains underexplored. Here, we rely on high throughput genomic reconstruction modeling, to infer the metabolic attributes and nutritional requirements of 816 gut strains, via a framework termed GEMNAST. This has been performed in terms of a group of human vitamins to examine the role vitamin exchanges have at different levels of community organization. We find that only 91 strains can satisfy their vitamin requirements (prototrophs) while the rest show various degrees of auxotrophy/specialization, highlighting their dependence on external sources, such as other members of the microbial community. Further, 79% of the strains in our sample were mapped to 11 distinct vitamin requirement profiles with low phylogenetic consistency. Yet, we find that human gut microbial community enterotype indicators display marked metabolic differences. Prevotella strains display a metabolic profile that can be complemented by strains from other genera often associated with the Prevotella enterotype and agrarian diets, while Bacteroides strains occupy a prototrophic profile. Finally, we identify pre-defined interaction modules (IMs) of gut species from human and mice predicted to be driven by, or highly independent of vitamin exchanges. Our analysis provides mechanistic grounding to gut microbiome stability and to co-abundance-based observations, a fundamental step toward understanding emergent processes that influence health outcomes. Further, our work opens a path to future explorations in the field through applications of GEMNAST to additional nutritional dimensions.

The collective of self-organized microbes living in the human gut give rise to biological processes that modulate non-communicable disease (NCD) etiology.1–5 Gut strains adapt to the gut environment based on the metabolic attributes encoded in their genome. Molecules central to cell metabolism are considered essential nutrients when they must be provided by the environment. However, specific metabolic attributes allow strains the option of synthesizing such molecules when unavailable (optional nutrients). Such characteristics lead to the establishment of nutritional and bioenergetic exchanges between sets of strains with complementary metabolic attributes, resulting in the emergence of higher scales of community organization (higher order units). It is now understood that the microbial processes that influence human biology cannot be effectively explained by individual strains, but rather the resulting higher order units.6–8 These may take the form of specific co-abundance or interaction modules (IMs),6–8 or reflect broader aspects of microbial community assembly observed across human populations (such as community types or enterotypes)9,10 which likely represent differential nutritional and bioenergetic signatures.11 Although the mechanisms through which resources are exchanged have been described,12,13 and these can be readily related to genome evolution,14 the higher-order processes constraining emergent structures are yet to be defined, partially due to the inherent complexity within the community.

To comprehensively infer the metabolic traits of 816 AGORA strains we relied on our recently developed high throughput GSM modeling pipeline, GEMNAST (Genome Scale Model based Metabolic and Nutritional Assessment), based on COBRApy,36 capable of assessing GSM metabolism in a comprehensive range of nutritional environments. Based on our initial results, we explore how vitamin metabolic attributes and nutritional requirements of individual gut strains influence higher order unit structure, including those linked to human gut community assembly (enterotypes). This analysis represents a novel approach through which our ecological understanding of gut microbial community structures is enhanced.

Higher order units in the gut emerge from individual strains interacting with each other and their environment. To determine what drives higher order units within the vitamin nutritional dimension comprehensive characterization of the metabolic attributes and nutritional requirements of a representative sample of gut strains was required. Hence, we aimed to identify which of the eight vitamin families (vitamins from here onwards) in Table 1 constitutes essential (required), optional (synthesizable under the right environment) and non-nutrient (neither) vitamins for 816 AGORA strains. To do this, we modeled strain growth under a range of standardized environmental conditions derived from nutritionally rich, anaerobic, universally defined growth media (UDM, Methods) which contained the elements required for de novo biosynthesis of the vitamins in question.

To better understand the mechanisms mediating vitamin interactions we explored vitamin active export capabilities with GEMNAST. We found that, besides niacin, which was actively exported by 430 strains, export of synthesized (optional) vitamins is a rare occurrence within strains in our dataset (Additional file 3). This may imply that these molecules are not actively made available to other gut microbes, and are mainly passively exchanged; for example, vitamin transfer after cell lysis.13,38 However, it is also plausible that specific mechanisms for vitamin cross-feeding are yet to be described and therefore not represented within the AGORA framework. Overall, our findings suggest that gut strains present broadly complementary vitamin metabolic attributes and that passive/active inter-strain vitamin exchanges can occur in the gut microbiome, which can enable the emergence of higher order units.

Interpreting microbiomes in functional terms can greatly aid in understanding the gut ecosystem. Across the surveyed strains, we identified 84 different essential vitamin profiles, plus a group of 91 strains with no essential vitamins in the tested nutritional conditions (prototrophs). Meanwhile, 138 optional vitamin profiles were identified among the 816 strains assessed. Such findings revealed significant overlap among strains’ vitamin metabolic attributes (functional redundancy). Hence, we sought to explore the distribution of strains in the auxotrophy spectrum aiming to identify broad vitamin capability groups that could improve our ability to parse vitamin-based functional complementarity and community structure. Accordingly, we performed hierarchical agglomerative clustering followed by non-linear two-dimensional clustering (Additional file 4), which revealed discrete groupings in our dataset.

Informed by the above mentioned clustering approaches and following careful manual inspection, final capability groups were devised. In total, 79% (644 out of 816) of the stains in our sample were mapped to one of eleven vitamin capability groups, which were distributed along the auxotrophy to prototrophy spectrum (Figure 2). The additional 21% of strains in our sample presented vitamin requirements that were incompatible with capability groups patterns. Notably, we find that strains from the Bacteroidetes phylum were largely mapped to more prototrophic capability groups while highly auxotrophic capability groups are characterized by strictly anaerobic members of the Firmicutes phylum (Figure 2, Additional file 2). Figure 2 shows that vitamin capability groups, based on essential vitamin profiles, also present similar optional vitamin profiles. This suggests that such strains likely occupy similar niches within gut communities where evolutionary pressures led to the loss, or conservation, of biosynthetic pathways to guarantee survival/improve fitness.39 Based on group-level vitamin metabolic attributes, the Prototrophs group is the only one where strains can self-satisfy all their vitamin requirements and can further serve as a B2, B3, B5, B6, and/or B9 source for more environmentally dependent clusters (Figure 2). Meanwhile, other groups require external vitamin sources. For example, strains in group B2+ require B2, and most require B1, to be sourced by the environment. However, such strains are well positioned to source those from other groups with B3, B6, and/or B9 (Figure 2). Thus, broad complementary profiles can be observed at the vitamin capability group-level.

To identify if previously observed patterns of community structure (such as enterotypes) are related to our functional categorization (vitamin capability groups), we aimed to assess the extent to which vitamin metabolic attributes are evolutionarily conserved. A phylogenetic tree, including 806 strains from our sample, was built using the National Center for Biotechnology Information’s (NCBI) Taxonomy Browser40 (Figure 3). Strains mapped to vitamin capability groups were identified within this tree revealing that while there is an observable consistency at the clade level, there is not a consistent evolutionary level of conservation of vitamin metabolic attributes. For example, the Prototrophs functional group was composed of strains from various genera, including Streptococcus, Bacillus, Bacteroides, Escherichia, and Pseudomonas. On the other hand, strains within the same genus were often split into different capability groups: for example, members of the Blautia genus were mapped to the Prototrophs (Blautia hansenii DSM 20583), B1 (Blautia obeum ATCC 29174), and B6+ (Blautia hydrogenotrophica DSM 10507) capability groups. Interestingly, strains from the Prevotella and Bacteroides genera, which are often identified as keystone taxa defining differential microbial community assemblages or “enterotypes” in the human gut,10 were largely mapped to different vitamin capability groups. Out of the 44 Bacteroides strains in our analysis, 36 were identified as prototrophs, while five were mapped to K+, a highly prototrophic group. Meanwhile, Prevotella strains were mostly mapped to the B5+ group (17 out of 29) while the rest were spread among five other vitamin capability groups (Figure 3), most of which displayed a high number of essential and a low number of optional vitamins.

Our mapping of vitamin capability groups onto enterotype indicators raises the possibility that these may reflect processes that drive community structure. The marked contrast between the vitamin capability groups to which enterotype dominant taxa were mapped led us to further explore the metabolic attributes of Prevotella strains, aiming to pinpoint how such attributes may impact community structure. Inspection of our vitamin metabolic attributes data (Additional file 2) showed that members of Streptococcus, Enterococcus, and Lachnospiraceae, which have been associated with the Prevotella enterotype in a prominent study,10 present metabolic profiles that complement those of the assessed Prevotella strains. Members of the Lactobacillaceae and Ruminoccoccaceae families were also found to be suitable complements to Prevotella vitamin metabolic attributes. For instance, Prevotella brevis ATCC 19188 can synthesize B2, B3, B5, B6, and B9 but requires a source of B1 and K, which can be provided by Lactobacillus pentosus KCA1 or Lactobacillus johnsonii DPC 6026, while both Lactobacillus strains require the vitamins Prevotella brevis ATCC 19188 can synthesize. Interestingly, there was no complementarity between Prevotella strains and members of the Bacteroides, Anerostipes, Parabacteroides, Alistipes genera or the Enterobacteriaceae family, all of which have been associated with the Bacteroides enterotype.10,41,42

Intermediate degrees of organization, what we refer to as IMs, can occur between the cellular and whole-community levels, and these have also been associated with health outcomes.6–8 Hence, relying on the vitamin attributes we inferred using GEMNAST we tested vitamin exchanges’ potential contribution to inferred local networks (IMs). First, we aimed to identify co-abundance/co-occurrence derived IMs43 that were composed of five or more members and where at least 50% of members could be matched to one of the strains in our analysis, as specified in Methods. Reliable reports of IMs at the strain level could not be identified, hence we relied on species-level IMs reported by Wang et al.44 and Zhang et al.45 which encompass prevalent mice and human gut bacteria, respectively. Strains in our sample were mapped to corresponding species within the reported IMs. Zhang et al. sampled the gut microbiome of 19 children with Prader-Willi Syndrome and 21 children with simple obesity at four and two timepoints, respectively, and assessed abundance changes longitudinally (co-abundance). Eighteen prevalent IMs (termed Genome Interaction Groups, GIGs) were identified, four of which met our analysis criteria. Wang et al. assessed 101 healthy mice stool samples and identified five IMs (labeled C1 to C5) based on co-occurrence, with three (C1-C3) meeting our analysis criteria (Methods).

To determine the likeliness of the observed complementarity networks being ecologically meaningful or products of randomness, we aimed to assess the random pattern of vitamin network configuration at the IM-level. To do so, we generated 1000 sets of nine randomly selected strains and analyzed the resulting group-level vitamin complementarity networks (Additional file 7). The number of strains in these groups was set to nine as this was the average size of the IMs reported in Zhang et al. and Wang et al. For our assessment, we focussed on two readily assessable characteristics of the resulting complementarity network: 1) functional redundancy score and 2) percentage of prototrophs. A total of 930 groups presented from zero to two prototrophs, while 958 presented a functional redundancy score between 0.3 and 0.7 (Figure 4). Most IMs that fit our assessment criteria were situated in close proximity to the region where random groups cluster (random pattern) suggesting that the vitamin complementarity networks derived from them are random and that these associations are mainly driven by factors outside of this nutritional dimension. In contrast, four outlier random groups presented a functional redundancy score of less than 0.3 with 0% of prototrophic members, closely resembling C2. However, only one of the four displayed a complete complementary profile (complementarity at every vitamin). Similarly, one outlier random group displayed characteristics similar to GIG7, with a high percentage of prototrophs (55.5%), and a high functional redundancy score (0.86). These results suggest that the probability of GIG7 and C2 vitamin patterns being a result of randomness is close to 0.001%, highlighting that the vitamin profiles we observe in these IMs are ecologically meaningful. Based on these results, we predict that naturally occurring IMs strongly driven by, and independent of vitamin interactions exist by design in the gut microbiome and likely occupy similar regions in the prototroph percentage to functional redundancy plane as C2 and GIG7, respectively (Figure 4). Vitamin exchanges probably still occur within every analyzed IM depending on the nutritional context; however, other aspects of biology are more likely to be driving such groupings. Our analysis strongly suggests that vitamin metabolic attributes influence IM structure in the gut microbiome and provides novel insights of gut ecology in this respect.

Mechanistic drivers of higher order units in the gut microbiome, which are responsible for the biological processes that impact health, can be identified by characterizing the metabolic attributes and nutritional requirements of gut strains. Vitamins participate in crucial intracellular metabolism but also constitute part of the extracellular machinery that contributes to community bioenergetic balance,11 positioning them as potential mechanistic drivers of gut higher order units. Relying on GEMNAST, we have performed a metabolic exploration of the vitamin nutritional dimension of gut strain metabolism as represented in AGORA GSMs to determine the role of this aspect of strain metabolism in community structure. By applying our framework, we identify essential (must be provided by the environment) and optional (can be synthesized when not available) vitamins, and non-nutrients for 816 gut microbiome strains. Eleven vitamin capability groups that spread along an auxotrophy to prototrophy spectrum and exceed phylogenetic relatedness are then derived from such vitamin metabolic attributes. Strains often present complementary vitamin attributes, which suggests that vitamins can be exchanged between human gut commensals.18,46,47 Based on this premise, we test vitamin exchange potential as one of the explanatory elements promoting the emergence and permanence of higher order units within the gut microbiome. Overall, our analysis suggests that vitamin metabolic attributes play a role shaping both modular and broad community structure.

The body of work we present here constitutes an important step toward understanding the emergent dynamics and structures within the gut microbiome. Analysis of the metabolic attributes of individual gut strains in an underexplored nutritional dimension allowed us to propose plausible mechanistic explanations that support enterotype identity and the observed co-abundance profiles within the gut, offering a novel perspective into the gut ecosystem. Further, the database we have generated can be used to inform future efforts including the design of minimal media for specific strains, which will in turn allow us to curate and assemble more accurate GSMs. Finally, GEMNAST can be employed to survey other relevant nutritional dimensions and provide a more comprehensive understanding about the survival strategies that explain the origin of the community-level outputs that modulate health.

Genome scale models used in this study are part of AGORA (Automatically generated genome-scale metabolic reconstructions)29 which in total is composed by 818 strains. Currently, two versions of AGORA are available for download from the Virtual Metabolic Human database;58 here we employ the without mucins version. We included 816 of the available AGORA strains in our analysis with two excluded due to inconsistencies as describe below. Metabolite flux for each GSM was modeled using the constraint-based reconstruction and analysis (COBRA) toolbox for the Python coding language (cobra.py).36 Metabolite flux analysis was performed using cobra.py and Flux Balance Analysis (FBA). FBA calculates growth in terms of biomass generation in grams of dry weight per hour (gDW/h) based on nutrient fluxes. Cobra.py further allows a) inspection of individual metabolic reactions and metabolite consumption and generation and b) seamless addition or removal of specific molecules to growth media.

Universally defined media (UDM) was designed by generating anaerobic minimal media for every strain in AGORA. The minimal_medium method in the cobra.py library was employed to generate media with the basic set of nutrients required for each strain to achieve a growth rate of 0.8 h¯1 (value suggested in the minimal_medium documentation), a proxy for optimal growth rate. A determined set of nutrients for strain Lactobacillus helveticus DPC 4571 could not be generated which led to the exclusion of this strain from further analyses. The resulting set of nutrients for each strain was broken into its constituents and these were compiled into anaerobic UDM (Figure 5). Nutrients were categorized into 11 groups: simple sugars, amino acids, dipeptides, fatty acids, bile acids, cations, anions, metals, main vitamins (those explored in this study), secondary vitamins and other. A detailed list of the components in our UDM can be found in Additional file 8. The resulting anaerobic UDM was used as a base for our growth experiments. An initial growth test using UDM was performed where we confirmed that every strain was capable of growing in it.

GSMs are mathematic reconstructions of the metabolic reactions encoded in an organism’s genome, including reversible and irreversible exchange/transport reactions. GSMs allow for the modeling of two virtual compartments: an extracellular one and an intracellular compartment. During metabolic modeling, strains can interact (uptake, secrete) with metabolites in the media if it presents the corresponding exchange/transport ‘reactions’. Similarly, if a GSM contains reactions that lead to the synthesis of a given metabolite, it will be capable of synthesizing it under the right media. Importantly, GSMs can be constrained to consume, synthesize, or export a specific metabolite if they have the appropriate reactions.

Exploration of reactions within AGORA strains identified vitamins from the vitamin B family and Quinones (Menaquinones and Ubiquinone) and their analogues (Table 1) taking part of such metabolic networks; other vitamins (A, C, D, and E) as well as other quinones were not identified and were not considered for our analysis. A preliminary analysis showed that biotin (B7) did not play a meaningful role among AGORA strains, which we considered to be a biological inconsistency, and consequently it was excluded from our current analysis.

To infer essential nutrients of strains, we developed a Python pipeline that models strain growth in defined media and compiles outcomes in a single Boolean table. The script requires three inputs: a) a directory where to read strain names and GSMs from; b) a list of media ingredients to serve as base media; and c) a set of nutrients on which to determine nutritional requirements which should not be part of the base media. A minimum growth rate threshold can also be determined within the script. Nutritional environments are designed based on the number of explored nutrients (input c) following a combinatorial design where nutrients are introduced individually or in combination to comprehensively explore every possible combinatorial scenario. Starting with base media, a first strain is cultured, its growth rate is assessed, and an outcome is recorded. The cycle continues by adding first individual nutrients (input b) and then increasingly complex combinations of them to base media, which are removed after growth rate assessment, before starting a new round (Figure 1a). Strains are explored one by one, one nutritional environment at a time and growth rate (gDW/h, biomass generation) is calculated in every culture. The main output from this analysis is a comma separated values (.csv) file that contains a Boolean table with strains as rows and nutritional environments as columns. If a strain’s growth rate is higher than the defined threshold a positive outcome is recorded in the Boolean table,1 otherwise a negative outcome (0) is recorded. Our incremental approach (from zero to all the explored nutrients) expedites the identification of the minimal requirements a strain has in terms of the explored set of nutrients; unless a strain is capable of growing under a variety of explored conditions the first instance where a strain presents meaningful growth is the one that introduced the set of required nutrients to the media. To explore extrinsic vitamin requirements we removed the vitamins of interest from our original UDM obtaining vitamin-free UDM (VFM, Figure 5) which was used as base media (input b). Since our UDM was purposefully designed to be a rich medium, removal of the explored vitamins ensured these were the only limiting nutrients. Clostridium sporogenes ATCC 15579 displayed an incompatibility with the employed solvers and irregular results, leading us to exclude it from our study. A total of 816 AGORA strains were assessed for their essential vitamins (input a). A threshold of 0.09 gDWh¯1 growth rate (six to eight hours doubling time) was established on the basis that any strain growing at a lower rate would present relatively low probabilities of surviving in the human gut, where transit time can be shorter than 14 hours in some individuals.59 Therefore, this threshold represents a theoretical minimum growth rate for gut survival as less than two replication cycles would not guarantee permanence in the colon. The vitamin families specified in Table 1 were selected for our combinatorial analysis (input c) in order to determine which combination of vitamins a particular strain needed for growth (Figure 1d, “Require”).

A second pipeline was developed to infer optional nutrients of strains, given that our essential nutrient analysis does not differentiate strains that biosynthesise nutrients for themselves from those that simply do not require the nutrient for growth. Similar to our essential nutrients analysis, this script requires three inputs: a) a directory where to read strain names and GSMs from; b) a list of media ingredients to serve as base media; and c) a set of nutrients of interest which should be part of the specified base media. This assessment also analyses one strain at a time but does not perform a combinatorial analysis. Instead every time synthesis of a metabolite is assessed, the nutrient and its analogues are removed from base media (UDM – 1). Following nutrient removal, a strain is cultured in the resulting media. The pipeline assesses two aspects of strain metabolism: its capability to synthesize the nutrient in question while growing above a previously specified threshold. To identify if a metabolite was synthesized, the metabolic network is assessed in search for reactions that led to synthesis and utilization of the nutrient of interest. Outcomes are registered in a Boolean table with strains as rows and resulting nutritional environments as columns where cultures in which strains grew above the determined threshold and synthesized the nutrient in question are assigned a value of one1 (Figure 1d, “Synthesises”). If the reported growth rate is below the given threshold and/or if the strain did not synthesize the assessed compound a zero (0) is assigned to that culture. To infer optional vitamins, we utilized our UDM as a base which included all the explored vitamins (input b) and the same growth threshold specified above (0.09 gDWh¯1). The vitamin families specified in Table 1 were selected for this analysis in order to determine which were synthesized by a particular strain (input c). Eight hundred and sixteen AGORA strains were assessed (input a). There was a small number of cases where a strain presented ‘non-nutrient’ vitamins, categorized as “None” in Figure 1, panel D. A modified version of our second pipeline was employed to assess vitamin export capabilities with the only differences that 1) growth and secretion would be assessed instead of growth and synthesis and 2) strains were constrained to export the vitamin assessed to cover for contexts where secretion was optional. Together, this method to explore GSM nutritional requirements, biosynthetic capabilities, and metabolite export is termed GEMNAST (Genome scale model Metabolic and Nutritional AssessmenT). Scripts can be accessed online: https://github.com/jmol0917/GEMNAST_pub.git. A flowchart summarizing the main aspects of GEMNAST, AGORA, cobra.py and the methods involving UDM, VFM, and UDM-1 is provided in Figure 6.

Soto-Martin et al. determined maximum optical density (maxOD) by culturing strains in the study in media with all the explored vitamins. Strains were later cultured in media with a single missing vitamin and OD was compared against maxOD. To validate our results, we considered that a strain that achieved over 80% maxOD (optimal growth) did not require the missing vitamin to be externally sourced, while anything below 20% was interpreted as it requiring the vitamin from an external source; values between 20% and 80% maxOD were considered as inconclusive (Additional file 1).

Strains were clustered based on individual growth profiles using the clustermap method from the Python data visualization library Seaborn60 which generates a matrix dataset and a hierarchically clustered heatmap. The two data visualization tools, t-distributed stochastic neighbor embedding from the TSNE scikit-learn Python module,61 and kernel density estimation, form the SciPy library for Python,62 were used for cluster and cluster density visualization on a two-dimensional plane (Additional file 4). Resulting matrixes contributed to the vitamin capability groups curation process.

Taxonomy IDs of 806 strains in our dataset were retrieved from the Virtual Metabolic Human database58 and were used to assemble a .phy file using NCBI’s online taxonomy browser.40 The interactive Tree Of Life online tool63 was accessed to create a graphic representation of the resulting phylogenetic tree and strain names were highlighted based on the vitamin capability group they were mapped. Strains that were not mapped to any group are not highlighted.

Interaction module tables were generated from IMs from Wang et al.44 and Zhang et al.45 that 1) were composed of five members or more and 2) at least 50% of members could be matched with one of the strains in our analysis. If multiple strains could be mapped to the same species multiple versions of the same IM were generated, one with each of the potential candidates and the network configuration of each version was assessed. The strain-level IMs presented in this study either showed minimal inter-version variation or only a single version could be generated from its original IM.

Where vs corresponds to total number of vitamins synthesized per group/IM; nv is the number of assessed vitamins, in this case seven; and nm corresponds to the number of members in a group/IM.

The authors declare that they have no competing interests

All data generated or analyzed during this study are included in this published article and its supplementary information files.

J.M., M.R., D.M. conceived of the presented idea. J.M. reviewed the literature, generated and analyzed GSM data and performed networks analyses. J.M., M.R., D.M., and E.S. were major contributors in writing the manuscript with input from all authors. All authors read and approved the final manuscript.

Supplemental data for this article can be accessed online at https://doi.org/10.1080/19490976.2022.2118831

